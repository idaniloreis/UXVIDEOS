/* Built on 2017-09-15 14:09:11 */
define("lib/helpers/dom",[],function(){return window.xv.dom.isElementInView=function(e,t){var i=$(window).scrollTop(),n=i+$(window).height(),s=$(e).offset().top,o=s+$(e).height();return t===!0?i<s&&n>o:s<=n&&o>=i},window.xv.dom}),function(){function e(t,n){function o(e){if(o[e]!==_)return o[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=o("json-stringify")&&o("json-parse");else{var i,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var l=n.stringify,c="function"==typeof l&&b;if(c){(i=function(){return 1}).toJSON=i;try{c="0"===l(0)&&"0"===l(new r)&&'""'==l(new a)&&l(m)===_&&l(_)===_&&l()===_&&"1"===l(i)&&"[1]"==l([i])&&"[null]"==l([_])&&"null"==l(null)&&"[null,null,null]"==l([_,m,null])&&l({a:[i,!0,!1,null,"\0\b\n\f\r\t"]})==s&&"1"===l(null,i)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new d(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new d(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new d(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new d(-1))}catch(h){c=!1}}t=c}if("json-parse"==e){var u=n.parse;if("function"==typeof u)try{if(0===u("0")&&!u(!1)){i=u(s);var f=5==i.a.length&&1===i.a[0];if(f){try{f=!u('"\t"')}catch(h){}if(f)try{f=1!==u("01")}catch(h){}if(f)try{f=1!==u("1.")}catch(h){}}}}catch(h){f=!1}t=f}}return o[e]=!!t}t||(t=s.Object()),n||(n=s.Object());var r=t.Number||s.Number,a=t.String||s.String,l=t.Object||s.Object,d=t.Date||s.Date,c=t.SyntaxError||s.SyntaxError,h=t.TypeError||s.TypeError,u=t.Math||s.Math,f=t.JSON||s.JSON;"object"==typeof f&&f&&(n.stringify=f.stringify,n.parse=f.parse);var p,g,_,v=l.prototype,m=v.toString,b=new d(-0xc782b5b800cec);try{b=b.getUTCFullYear()==-109252&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}catch(y){}if(!o("json")){var w="[object Function]",k="[object Date]",x="[object Number]",$="[object String]",T="[object Array]",C="[object Boolean]",E=o("bug-string-char-index");if(!b)var S=u.floor,N=[0,31,59,90,120,151,181,212,243,273,304,334],O=function(e,t){return N[t]+365*(e-1970)+S((e-1969+(t=+(t>1)))/4)-S((e-1901+t)/100)+S((e-1601+t)/400)};if((p=v.hasOwnProperty)||(p=function(e){var t,i={};return(i.__proto__=null,i.__proto__={toString:1},i).toString!=m?p=function(e){var t=this.__proto__,i=e in(this.__proto__=null,this);return this.__proto__=t,i}:(t=i.constructor,p=function(e){var i=(this.constructor||t).prototype;return e in this&&!(e in i&&this[e]===i[e])}),i=null,p.call(this,e)}),g=function(e,t){var n,s,o,r=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,s=new n;for(o in s)p.call(s,o)&&r++;return n=s=null,r?g=2==r?function(e,t){var i,n={},s=m.call(e)==w;for(i in e)s&&"prototype"==i||p.call(n,i)||!(n[i]=1)||!p.call(e,i)||t(i)}:function(e,t){var i,n,s=m.call(e)==w;for(i in e)s&&"prototype"==i||!p.call(e,i)||(n="constructor"===i)||t(i);(n||p.call(e,i="constructor"))&&t(i)}:(s=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],g=function(e,t){var n,o,r=m.call(e)==w,a=!r&&"function"!=typeof e.constructor&&i[typeof e.hasOwnProperty]&&e.hasOwnProperty||p;for(n in e)r&&"prototype"==n||!a.call(e,n)||t(n);for(o=s.length;n=s[--o];a.call(e,n)&&t(n));}),g(e,t)},!o("json-stringify")){var I={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},A="000000",M=function(e,t){return(A+(t||0)).slice(-e)},q="\\u00",D=function(e){for(var t='"',i=0,n=e.length,s=!E||n>10,o=s&&(E?e.split(""):e);i<n;i++){var r=e.charCodeAt(i);switch(r){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=I[r];break;default:if(r<32){t+=q+M(2,r.toString(16));break}t+=s?o[i]:e.charAt(i)}}return t+'"'},R=function(e,t,i,n,s,o,r){var a,l,d,c,u,f,v,b,y,w,E,N,I,A,q,P;try{a=t[e]}catch(j){}if("object"==typeof a&&a)if(l=m.call(a),l!=k||p.call(a,"toJSON"))"function"==typeof a.toJSON&&(l!=x&&l!=$&&l!=T||p.call(a,"toJSON"))&&(a=a.toJSON(e));else if(a>-1/0&&a<1/0){if(O){for(u=S(a/864e5),d=S(u/365.2425)+1970-1;O(d+1,0)<=u;d++);for(c=S((u-O(d,0))/30.42);O(d,c+1)<=u;c++);u=1+u-O(d,c),f=(a%864e5+864e5)%864e5,v=S(f/36e5)%24,b=S(f/6e4)%60,y=S(f/1e3)%60,w=f%1e3}else d=a.getUTCFullYear(),c=a.getUTCMonth(),u=a.getUTCDate(),v=a.getUTCHours(),b=a.getUTCMinutes(),y=a.getUTCSeconds(),w=a.getUTCMilliseconds();a=(d<=0||d>=1e4?(d<0?"-":"+")+M(6,d<0?-d:d):M(4,d))+"-"+M(2,c+1)+"-"+M(2,u)+"T"+M(2,v)+":"+M(2,b)+":"+M(2,y)+"."+M(3,w)+"Z"}else a=null;if(i&&(a=i.call(t,e,a)),null===a)return"null";if(l=m.call(a),l==C)return""+a;if(l==x)return a>-1/0&&a<1/0?""+a:"null";if(l==$)return D(""+a);if("object"==typeof a){for(A=r.length;A--;)if(r[A]===a)throw h();if(r.push(a),E=[],q=o,o+=s,l==T){for(I=0,A=a.length;I<A;I++)N=R(I,a,i,n,s,o,r),E.push(N===_?"null":N);P=E.length?s?"[\n"+o+E.join(",\n"+o)+"\n"+q+"]":"["+E.join(",")+"]":"[]"}else g(n||a,function(e){var t=R(e,a,i,n,s,o,r);t!==_&&E.push(D(e)+":"+(s?" ":"")+t)}),P=E.length?s?"{\n"+o+E.join(",\n"+o)+"\n"+q+"}":"{"+E.join(",")+"}":"{}";return r.pop(),P}};n.stringify=function(e,t,n){var s,o,r,a;if(i[typeof t]&&t)if((a=m.call(t))==w)o=t;else if(a==T){r={};for(var l,d=0,c=t.length;d<c;l=t[d++],a=m.call(l),(a==$||a==x)&&(r[l]=1));}if(n)if((a=m.call(n))==x){if((n-=n%1)>0)for(s="",n>10&&(n=10);s.length<n;s+=" ");}else a==$&&(s=n.length<=10?n:n.slice(0,10));return R("",(l={},l[""]=e,l),o,r,s,"",[])}}if(!o("json-parse")){var P,j,L=a.fromCharCode,H={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},W=function(){throw P=j=null,c()},z=function(){for(var e,t,i,n,s,o=j,r=o.length;P<r;)switch(s=o.charCodeAt(P)){case 9:case 10:case 13:case 32:P++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=E?o.charAt(P):o[P],P++,e;case 34:for(e="@",P++;P<r;)if(s=o.charCodeAt(P),s<32)W();else if(92==s)switch(s=o.charCodeAt(++P)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=H[s],P++;break;case 117:for(t=++P,i=P+4;P<i;P++)s=o.charCodeAt(P),s>=48&&s<=57||s>=97&&s<=102||s>=65&&s<=70||W();e+=L("0x"+o.slice(t,P));break;default:W()}else{if(34==s)break;for(s=o.charCodeAt(P),t=P;s>=32&&92!=s&&34!=s;)s=o.charCodeAt(++P);e+=o.slice(t,P)}if(34==o.charCodeAt(P))return P++,e;W();default:if(t=P,45==s&&(n=!0,s=o.charCodeAt(++P)),s>=48&&s<=57){for(48==s&&(s=o.charCodeAt(P+1),s>=48&&s<=57)&&W(),n=!1;P<r&&(s=o.charCodeAt(P),s>=48&&s<=57);P++);if(46==o.charCodeAt(P)){for(i=++P;i<r&&(s=o.charCodeAt(i),s>=48&&s<=57);i++);i==P&&W(),P=i}if(s=o.charCodeAt(P),101==s||69==s){for(s=o.charCodeAt(++P),43!=s&&45!=s||P++,i=P;i<r&&(s=o.charCodeAt(i),s>=48&&s<=57);i++);i==P&&W(),P=i}return+o.slice(t,P)}if(n&&W(),"true"==o.slice(P,P+4))return P+=4,!0;if("false"==o.slice(P,P+5))return P+=5,!1;if("null"==o.slice(P,P+4))return P+=4,null;W()}return"$"},Y=function(e){var t,i;if("$"==e&&W(),"string"==typeof e){if("@"==(E?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=z(),"]"!=e;i||(i=!0))i&&(","==e?(e=z(),"]"==e&&W()):W()),","==e&&W(),t.push(Y(e));return t}if("{"==e){for(t={};e=z(),"}"!=e;i||(i=!0))i&&(","==e?(e=z(),"}"==e&&W()):W()),","!=e&&"string"==typeof e&&"@"==(E?e.charAt(0):e[0])&&":"==z()||W(),t[e.slice(1)]=Y(z());return t}W()}return e},U=function(e,t,i){var n=X(e,t,i);n===_?delete e[t]:e[t]=n},X=function(e,t,i){var n,s=e[t];if("object"==typeof s&&s)if(m.call(s)==T)for(n=s.length;n--;)U(s,n,i);else g(s,function(e){U(s,e,i)});return i.call(e,t,s)};n.parse=function(e,t){var i,n;return P=0,j=""+e,i=Y(z()),"$"!=z()&&W(),P=j=null,t&&m.call(t)==w?X((n={},n[""]=i,n),"",t):i}}}return n.runInContext=e,n}var t="function"==typeof define&&define.amd,i={"function":!0,object:!0},n=i[typeof exports]&&exports&&!exports.nodeType&&exports,s=i[typeof window]&&window||this,o=n&&i[typeof module]&&module&&!module.nodeType&&"object"==typeof global&&global;if(!o||o.global!==o&&o.window!==o&&o.self!==o||(s=o),n&&!t)e(s,n);else{var r=s.JSON,a=s.JSON3,l=!1,d=e(s,s.JSON3={noConflict:function(){return l||(l=!0,s.JSON=r,s.JSON3=a,r=a=null),d}});s.JSON={parse:d.parse,stringify:d.stringify}}t&&define("json3",[],function(){return d})}.call(this),define("lib/json",[],function(){"undefined"!=typeof JSON&&"undefined"!=typeof JSON.parse||require(["json3"])}),define("lib/sda",["config/main","config/ads","static/cookies","static/utils","lib/helpers/dom","lib/json"],function(e,t,i,n,s){if("function"==typeof t&&(t=t()),"undefined"!=typeof t&&"undefined"!=typeof t.banners&&0!==t.banners.length){window.wpn_categories=t.categories;for(var o=function(e){if(!e.div_id)return console.error("error: invalid banner: ",e),!1;var t=document.getElementById(e.div_id);return t?(t.innerHTML="",t):(console.error("error: div "+e.div_id+" is missing"),!1)},r=[],a={},l=function(e,t){return"number"==typeof t.min_ratio&&t.min_ratio>0&&(e+="_minr_"+t.min_ratio.toFixed(2)),"number"==typeof t.max_ratio&&t.max_ratio>0&&(e+="_maxr_"+t.max_ratio.toFixed(2)),e},d=function(e,t){var i={};return i.device=e,"number"==typeof t.min_ratio&&t.min_ratio>0&&(i.minr=Math.round(100*t.min_ratio)/100),"number"==typeof t.max_ratio&&t.max_ratio>0&&(i.maxr=Math.round(100*t.max_ratio)/100),i},c=0;c<t.banners.length;c++){var h=t.banners[c],u=o(h);if(u!==!1&&!(h.nb_ban<=0)){if(h.div=u,!h.mobile&&!h.desktop&&!h.largescr){h.mobile=!0,h.desktop=!0;var f=document.getElementById(h.div_id+"2");f&&(h.mobile_div=f)}if(h.largescr){var p=document.getElementById(h.div_id+"1");p&&(h.largesrc_div=p)}h.is_loaded=!1,h.to_load={};var g=!1,_=["mobile","desktop"];for(var v in _)if(h[_[v]]){g=!0;var m=l(_[v],h);h.to_load[m]=!0,a[m]=d(_[v],h)}if(!g&&h.largescr){var m=l("largescr",h);h.to_load[m]=!0,a[m]=d("largescr",h)}r.push(h)}}if(0!==r.length){var b=i.get("wpn_ad_cookie"),y=t.site,w="",k="",x=!1;b||(b=""),"string"==typeof t.categories&&t.categories.length>0&&(w=t.categories),"string"==typeof t.tracker&&t.tracker.length>0&&(k=t.tracker);var $,T,C=function(e,t,i){var n=document.createElement("a");n.href=t,n.target="_blank",n.rel="noopener",n.onclick=function(e){e=e||window.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0};var s=document.createElement("img");return s.src=e,"headermobile"===i?[n,s]:(n.appendChild(s),[n])},E=function(t){var o=[];o.push(window.location.protocol+"//rpc-php.trafficfactory.biz/json");for(var r=[],a=0;a<t.length;a++){var l=t[a];"undefined"==typeof l.area_tag?r.push(l.type+"-"+l.nb_ban):r.push(l.type+"-"+l.area_tag+"-"+l.nb_ban),t[a].is_loaded=!0}o.push(r.join("x")),o.push(b),o.push(w),o.push(y),o.push(k),o.push(""),o.push("content.json?v="+Math.random());try{var d=n.createRequestObject();d.open("GET",o.join("/"),!0),d.onreadystatechange=function(n){if(4==d.readyState&&200==d.status){var o=d.responseText;if("string"==typeof o&&(o=JSON.parse(o)),!o||!o.tracker_id||!o.banners)return;i.setLocal("wpn_ad_cookie",o.tracker_id,864e5,"/");for(var r=0;r<o.banners.length;r++){var a=t[r],l=o.banners[r];if("inplayersquare"!==a.type){"square"===a.type&&0===l.length&&"object"==typeof html5player&&"function"==typeof html5player.setNoSquareAd&&html5player.setNoSquareAd();var c=[];if(c.push(a.div),a.mobile_div&&c.push(a.mobile_div),0===l.length){var h=!1,u=!0;"tower"===a.type&&("xnxx"!==e.sitename&&"pornorama"!==e.sitename||"/"!==window.location.pathname)?(h=!0,u=!1):"square"!==a.type&&"headermobile"!==a.type&&("footer"!==a.type&&"footermobile"!==a.type||"string"!=typeof a.area_tag||"hometopfooter"!==a.area_tag)||(u=!1);for(var f in c){var p=c[f].parentNode;if(u){var g=s.getNextSibling(c[f]);p.removeChild(g)}h?p.parentNode.removeChild(p):p.removeChild(c[f])}}for(var _=0;_<l.length;_++)for(var f in c){var v=C(l[_].banner,l[_].url,a.type);for(var m in v)c[f].appendChild(v[m])}}else{if(0===l.length){html5player.setPlayerAd("NOAD");continue}var b={url:l[0].url,img:l[0].banner};l[0].banner_jpg&&(b.jpg=l[0].banner_jpg),html5player.setPlayerAd(b)}}}4==d.readyState&&0==d.status&&(x||(x=!0,"object"==typeof xv.thumbs&&"object"==typeof xv.thumbs.mgr&&(xv.thumbs.mgr.checkOrSend(!0),"object"==typeof html5player&&"function"==typeof html5player.loadingAdError&&html5player.loadingAdError())))},d.send(null)}catch(c){if(/MSIE\s/i.test(navigator.userAgent)&&parseFloat(navigator.appVersion.split(/MSIE/i)[1])<10){window.wpn_ad_configuration=t;var h=[];h.push(window.location.protocol+"//rpc-php.trafficfactory.biz"),h.push(r.join("x")),h.push(b),h.push("0"),h.push(w),h.push(y),h.push(k),h.push("display.js?v="+Math.random());var u=document.createElement("script");u.src=h.join("/"),u.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(u)}else x||(x=!0,"object"==typeof xv.thumbs&&"object"==typeof xv.thumbs.mgr&&(xv.thumbs.mgr.checkOrSend(!0),"object"==typeof html5player&&"function"==typeof html5player.loadingAdError&&html5player.loadingAdError()))}},S=function(){var e=0;if("undefined"!=typeof window.innerWidth)e=window.innerWidth;else if("undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&document.documentElement.clientWidth>0)e=document.documentElement.clientWidth;else if("undefined"!=typeof document.getElementsByTagName){var t=document.getElementsByTagName("body");t.length>0&&"undefined"!=typeof t[0].clientWidth&&t[0].clientWidth>0&&(e=t[0].clientWidth)}return e>0?e:1024},N=function(){var e=0;if("undefined"!=typeof window.innerHeight)e=window.innerHeight;else if("undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientHeight&&document.documentElement.clientHeight>0)e=document.documentElement.clientHeight;else if("undefined"!=typeof document.getElementsByTagName){var t=document.getElementsByTagName("body");t.length>0&&"undefined"!=typeof t[0].clientHeight&&t[0].clientHeight>0&&(e=t[0].clientHeight)}return e>0?e:768},O=768,I=(i.get("hexavid_no_responsive")>0?930:1280)+184;"xnxx"===e.sitename&&(O=992);var A=function(e){if(null===$&&($=S()),(e.minr||e.maxr)&&null===T&&(T=$/N()),e.minr&&T<e.minr)return!1;if(e.maxr&&T>e.maxr)return!1;switch(e.device){case"mobile":return $<=O;case"desktop":return $>O;case"largescr":return $>=I}return console.error("Unknown device: "+e.device),!1},M=function(){$=null,T=null;var e=[];for(var t in a)A(a[t])&&e.push(t);if(0!==e.length){for(var i=[],n=0;n<r.length;n++){var s=r[n];if(!s.is_loaded)for(var o in e)s.to_load[e[o]]&&i.push(s)}for(var o in e)delete a[e[o]];0!==i.length&&E(i,y,w,k)}};if("undefined"!=typeof window.addEventListener)window.addEventListener("resize",M);else if("function"==typeof window.onresize){var q=window.onresize;window.onresize=function(){q(),M()}}else window.onresize=M;M();var D=!0;window.toggle_wpn_ads=function(e){if(e=!!e,e!==D&&"OK"!==i.get("disclaimer_display")){for(var t in r){var n=r[t].div;n&&(n.style.display=e?"":"none")}D=e}},e.data.show_disclaimer===!0&&window.toggle_wpn_ads(!1)}}}),function(e){"use strict";function t(){w(!0)}var i={};e.respond=i,i.update=function(){};var n=[],s=function(){var t=!1;try{t=new e.XMLHttpRequest}catch(i){t=new e.ActiveXObject("Microsoft.XMLHTTP")}return function(){return t}}(),o=function(e,t){var i=s();i&&(i.open("GET",e,!0),i.onreadystatechange=function(){4!==i.readyState||200!==i.status&&304!==i.status||t(i.responseText)},4!==i.readyState&&i.send(null))},r=function(e){return e.replace(i.regex.minmaxwh,"").match(i.regex.other)};if(i.ajax=o,i.queue=n,i.unsupportedmq=r,i.regex={media:/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi,keyframes:/@(?:\-(?:o|moz|webkit)\-)?keyframes[^\{]+\{(?:[^\{\}]*\{[^\}\{]*\})+[^\}]*\}/gi,comments:/\/\*[^*]*\*+([^\/][^*]*\*+)*\//gi,urls:/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,findStyles:/@media *([^\{]+)\{([\S\s]+?)$/,only:/(only\s+)?([a-zA-Z]+)\s?/,minw:/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,maxw:/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,minmaxwh:/\(\s*m(in|ax)\-(height|width)\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/gi,other:/\([^\)]*\)/g},i.mediaQueriesSupported=e.matchMedia&&null!==e.matchMedia("only all")&&e.matchMedia("only all").matches,!i.mediaQueriesSupported){var a,l,d,c=e.document,h=c.documentElement,u=[],f=[],p=[],g={},_=30,v=c.getElementsByTagName("head")[0]||h,m=c.getElementsByTagName("base")[0],b=v.getElementsByTagName("link"),y=function(){var e,t=c.createElement("div"),i=c.body,n=h.style.fontSize,s=i&&i.style.fontSize,o=!1;return t.style.cssText="position:absolute;font-size:1em;width:1em",i||(i=o=c.createElement("body"),i.style.background="none"),h.style.fontSize="100%",i.style.fontSize="100%",i.appendChild(t),o&&h.insertBefore(i,h.firstChild),e=t.offsetWidth,o?h.removeChild(i):i.removeChild(t),h.style.fontSize=n,s&&(i.style.fontSize=s),e=d=parseFloat(e)},w=function(t){var i="clientWidth",n=h[i],s="CSS1Compat"===c.compatMode&&n||c.body[i]||n,o={},r=b[b.length-1],g=(new Date).getTime();if(t&&a&&g-a<_)return e.clearTimeout(l),void(l=e.setTimeout(w,_));a=g;for(var m in u)if(u.hasOwnProperty(m)){var k=u[m],x=k.minw,$=k.maxw,T=null===x,C=null===$,E="em";x&&(x=parseFloat(x)*(x.indexOf(E)>-1?d||y():1)),$&&($=parseFloat($)*($.indexOf(E)>-1?d||y():1)),k.hasquery&&(T&&C||!(T||s>=x)||!(C||s<=$))||(o[k.media]||(o[k.media]=[]),o[k.media].push(f[k.rules]))}for(var S in p)p.hasOwnProperty(S)&&p[S]&&p[S].parentNode===v&&v.removeChild(p[S]);p.length=0;for(var N in o)if(o.hasOwnProperty(N)){var O=c.createElement("style"),I=o[N].join("\n");O.type="text/css",O.media=N,v.insertBefore(O,r.nextSibling),O.styleSheet?O.styleSheet.cssText=I:O.appendChild(c.createTextNode(I)),p.push(O)}},k=function(e,t,n){var s=e.replace(i.regex.comments,"").replace(i.regex.keyframes,"").match(i.regex.media),o=s&&s.length||0;t=t.substring(0,t.lastIndexOf("/"));var a=function(e){return e.replace(i.regex.urls,"$1"+t+"$2$3")},l=!o&&n;t.length&&(t+="/"),l&&(o=1);for(var d=0;d<o;d++){var c,h,p,g;l?(c=n,f.push(a(e))):(c=s[d].match(i.regex.findStyles)&&RegExp.$1,f.push(RegExp.$2&&a(RegExp.$2))),p=c.split(","),g=p.length;for(var _=0;_<g;_++)h=p[_],r(h)||u.push({media:h.split("(")[0].match(i.regex.only)&&RegExp.$2||"all",rules:f.length-1,hasquery:h.indexOf("(")>-1,minw:h.match(i.regex.minw)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:h.match(i.regex.maxw)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}w()},x=function(){if(n.length){var t=n.shift();o(t.href,function(i){k(i,t.href,t.media),g[t.href]=!0,e.setTimeout(function(){x()},0)})}},$=function(){for(var t=0;t<b.length;t++){var i=b[t],s=i.href,o=i.media,r=i.rel&&"stylesheet"===i.rel.toLowerCase();s&&r&&!g[s]&&(i.styleSheet&&i.styleSheet.rawCssText?(k(i.styleSheet.rawCssText,s,o),g[s]=!0):(/^([a-zA-Z:]*\/\/)/.test(s)||m)&&s.replace(RegExp.$1,"").split("/")[0]!==e.location.host||("//"===s.substring(0,2)&&(s=e.location.protocol+s),n.push({href:s,media:o})))}x()};$(),i.update=$,i.getEmValue=y,e.addEventListener?e.addEventListener("resize",t,!1):e.attachEvent&&e.attachEvent("onresize",t)}}(this),define("respond",function(){}),define("lib/tools",["static/utils"],function(e){var t={};t.encloseTextWithTag=function(e,t){return"string"!=typeof e||0!==e.length&&"<"===e[0]?e:"<"+t+">"+e+"</"+t+">"},t.parseUrl=function(e,t,i){var n={body:null,query:null,hash:null},s=e.split("#");if(2===s.length){if("hash"===t)return s[1];n.hash=s[1]}if("hash"===t)return null;if(e=s[0],s=e.split("?"),2===s.length&&(n.query=s[1]),n.body=s[0],"undefined"!=typeof i&&i){var o=n.query;if(n.query={},o)for(var r=o.split("&"),a=0;a<r.length;a++){var l=r[a];if(l.length){var d=l.split("=");n.query[d.shift()]=d.join("=")}}}return"undefined"!=typeof t&&t&&"undefined"!=typeof n[t]?n[t]:n},t.getUrlHash=function(){return window.location.hash.substr(1)},t.setUrlHash=function(e){"#"!==e.substr(0,1)&&(e="#"+e),e!==window.location.hash&&(window.location.hash=e)},t.pad=function(e,t,i,n){"undefined"!=typeof n&&"left"===n||(n="right");for(var s=""+e;s.length<t;)"left"===n?s=i+s:s+=i;return s},t.ucfirst=function(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()},t.cleanStr=function(e,i){return e=e.replace(new RegExp("[[\\]{}()*+?.,\\^$|#\\s]"),"\\$&"),i?t.translit(e):e},t.translit=function(e){return e.toLowerCase().replace(/[àáâãäå]/g,"a").replace(/æ/g,"ae").replace(/ç/g,"c").replace(/[èéêë]/g,"e").replace(/[ìíîï]/g,"i").replace(/ñ/g,"n").replace(/[òóôõö]/g,"o").replace(/œ/g,"oe").replace(/[ùúûü]/g,"u").replace(/[ýÿ]/g,"y")};var i={};t.preloadPicture=function(e,t){var n=e;if(t&&(n+=t+".jpg"),"undefined"==typeof i[n]){var s=new Image;s.src=n,i[n]=!0}},t.replaceThumbcast=function(e){for(var t=e.split(/(<script>|<\/script>)/g),i=0;i<t.length;i++)"<script>"===t[i]||"</script>"===t[i]?t[i]="":"document.write(xv.thumbs.replaceThumbUrl("===t[i].substr(0,41)?t[i]=window.xv.thumbs.replaceThumbUrl(t[i].substring(42,t[i].lastIndexOf("))")-1)):"xv.thumbs.casting.displayRandomThumb("===t[i].substr(0,37)?t[i]=window.xv.thumbs.casting.displayRandomThumb(t[i].substring(38,t[i].lastIndexOf(")")-1),!0):"document.write(xv.thumbs.replaceActGalThumbUrl("===t[i].substr(0,47)?t[i]=window.xv.thumbs.replaceActGalThumbUrl(t[i].substring(48,t[i].lastIndexOf("))")-1)):"document.write(xv.thumbs.replacePicThumbUrl("===t[i].substr(0,44)&&(t[i]=window.xv.thumbs.replacePicThumbUrl(t[i].substring(45,t[i].lastIndexOf("))")-1)));return t.join("")},t.scrollTo=function(e,t){"undefined"==typeof t&&(t=0),$("html,body").animate({scrollTop:$(e).offset().top-10-t})};var n=[];return t.loadRecaptcha=function(t,i){if("object"==typeof grecaptcha)return void t();if(n.push(t),!(n.length>1)){window.onToolsRecaptchaLoaded=function(){for(var e in n)n[e]()};var s="https://www.google.com/recaptcha/api.js?onload=onToolsRecaptchaLoaded&render=explicit";"string"==typeof i&&(s+="&hl="+i),e.loadScript(s)}},t}),function(e,t){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?t(exports):"function"==typeof define&&define.amd?define("mustache",["exports"],t):(e.Mustache={},t(e.Mustache))}(this,function(e){function t(e){return"function"==typeof e}function i(e){return g(e)?"array":typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function s(e,t){return null!=e&&"object"==typeof e&&t in e}function o(e,t){return _.call(e,t)}function r(e){return!o(v,e)}function a(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return m[e]})}function l(t,i){function s(){if(v&&!m)for(;_.length;)delete p[_.pop()];else _=[];v=!1,m=!1}function o(e){if("string"==typeof e&&(e=e.split(y,2)),!g(e)||2!==e.length)throw new Error("Invalid tags: "+e);a=new RegExp(n(e[0])+"\\s*"),l=new RegExp("\\s*"+n(e[1])),u=new RegExp("\\s*"+n("}"+e[1]))}if(!t)return[];var a,l,u,f=[],p=[],_=[],v=!1,m=!1;o(i||e.tags);for(var $,T,C,E,S,N,O=new h(t);!O.eos();){if($=O.pos,C=O.scanUntil(a))for(var I=0,A=C.length;I<A;++I)E=C.charAt(I),r(E)?_.push(p.length):m=!0,p.push(["text",E,$,$+1]),$+=1,"\n"===E&&s();if(!O.scan(a))break;if(v=!0,T=O.scan(x)||"name",O.scan(b),"="===T?(C=O.scanUntil(w),O.scan(w),O.scanUntil(l)):"{"===T?(C=O.scanUntil(u),O.scan(k),O.scanUntil(l),T="&"):C=O.scanUntil(l),!O.scan(l))throw new Error("Unclosed tag at "+O.pos);if(S=[T,C,$,O.pos],p.push(S),"#"===T||"^"===T)f.push(S);else if("/"===T){if(N=f.pop(),!N)throw new Error('Unopened section "'+C+'" at '+$);if(N[1]!==C)throw new Error('Unclosed section "'+N[1]+'" at '+$)}else"name"===T||"{"===T||"&"===T?m=!0:"="===T&&o(C)}if(N=f.pop())throw new Error('Unclosed section "'+N[1]+'" at '+O.pos);return c(d(p))}function d(e){for(var t,i,n=[],s=0,o=e.length;s<o;++s)t=e[s],t&&("text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(n.push(t),i=t));return n}function c(e){for(var t,i,n=[],s=n,o=[],r=0,a=e.length;r<a;++r)switch(t=e[r],t[0]){case"#":case"^":s.push(t),o.push(t),s=t[4]=[];break;case"/":i=o.pop(),i[5]=t[2],s=o.length>0?o[o.length-1][4]:n;break;default:s.push(t)}return n}function h(e){this.string=e,this.tail=e,this.pos=0}function u(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function f(){this.cache={}}var p=Object.prototype.toString,g=Array.isArray||function(e){return"[object Array]"===p.call(e)},_=RegExp.prototype.test,v=/\S/,m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},b=/\s*/,y=/\s+/,w=/\s*=/,k=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/;h.prototype.eos=function(){return""===this.tail},h.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},h.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=t.length,t},u.prototype.push=function(e){return new u(e,this)},u.prototype.lookup=function(e){var i,n=this.cache;if(n.hasOwnProperty(e))i=n[e];else{for(var o,r,a=this,l=!1;a;){if(e.indexOf(".")>0)for(i=a.view,o=e.split("."),r=0;null!=i&&r<o.length;)r===o.length-1&&(l=s(i,o[r])),i=i[o[r++]];else i=a.view[e],l=s(a.view,e);if(l)break;a=a.parent}n[e]=i}return t(i)&&(i=i.call(this.view)),i},f.prototype.clearCache=function(){this.cache={}},f.prototype.parse=function(e,t){var i=this.cache,n=i[e];return null==n&&(n=i[e]=l(e,t)),n},f.prototype.render=function(e,t,i){var n=this.parse(e),s=t instanceof u?t:new u(t);return this.renderTokens(n,s,i,e)},f.prototype.renderTokens=function(e,t,i,n){for(var s,o,r,a="",l=0,d=e.length;l<d;++l)r=void 0,s=e[l],o=s[0],"#"===o?r=this.renderSection(s,t,i,n):"^"===o?r=this.renderInverted(s,t,i,n):">"===o?r=this.renderPartial(s,t,i,n):"&"===o?r=this.unescapedValue(s,t):"name"===o?r=this.escapedValue(s,t):"text"===o&&(r=this.rawValue(s)),void 0!==r&&(a+=r);return a},f.prototype.renderSection=function(e,i,n,s){function o(e){return r.render(e,i,n)}var r=this,a="",l=i.lookup(e[1]);if(l){if(g(l))for(var d=0,c=l.length;d<c;++d)a+=this.renderTokens(e[4],i.push(l[d]),n,s);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)a+=this.renderTokens(e[4],i.push(l),n,s);else if(t(l)){if("string"!=typeof s)throw new Error("Cannot use higher-order sections without the original template");l=l.call(i.view,s.slice(e[3],e[5]),o),null!=l&&(a+=l)}else a+=this.renderTokens(e[4],i,n,s);return a}},f.prototype.renderInverted=function(e,t,i,n){var s=t.lookup(e[1]);if(!s||g(s)&&0===s.length)return this.renderTokens(e[4],t,i,n)},f.prototype.renderPartial=function(e,i,n){if(n){var s=t(n)?n(e[1]):n[e[1]];return null!=s?this.renderTokens(this.parse(s),i,n,s):void 0}},f.prototype.unescapedValue=function(e,t){var i=t.lookup(e[1]);if(null!=i)return i},f.prototype.escapedValue=function(t,i){var n=i.lookup(t[1]);if(null!=n)return e.escape(n)},f.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.0",e.tags=["{{","}}"];var $=new f;return e.clearCache=function(){return $.clearCache()},e.parse=function(e,t){return $.parse(e,t)},e.render=function(e,t,n){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+i(e)+'" was given as the first argument for mustache#render(template, view, partials)');return $.render(e,t,n)},e.to_html=function(i,n,s,o){var r=e.render(i,n,s);return t(o)?void o(r):r},e.escape=a,e.Scanner=h,e.Context=u,e.Writer=f,e}),define("text",["module"],function(e){"use strict";function t(e,t){return void 0===e||""===e?t:e}function i(e,i,n,s){if(i===s)return!0;if(e===n){if("http"===e)return t(i,"80")===t(s,"80");if("https"===e)return t(i,"443")===t(s,"443")}return!1}var n,s,o,r,a,l=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],d=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,h="undefined"!=typeof location&&location.href,u=h&&location.protocol&&location.protocol.replace(/\:/,""),f=h&&location.hostname,p=h&&(location.port||void 0),g={},_=e.config&&e.config()||{};return n={version:"2.0.15",strip:function(e){if(e){e=e.replace(d,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:_.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){i=l[t];try{e=new ActiveXObject(i)}catch(n){}if(e){l=[i];break}}return e},parseName:function(e){var t,i,n,s=!1,o=e.lastIndexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return o!==-1&&(!r||o>1)?(t=e.substring(0,o),i=e.substring(o+1)):t=e,n=i||t,o=n.indexOf("!"),o!==-1&&(s="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:t=n),{moduleName:t,ext:i,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,s,o){var r,a,l,d=n.xdRegExp.exec(e);return!d||(r=d[2],a=d[3],a=a.split(":"),l=a[1],a=a[0],(!r||r===t)&&(!a||a.toLowerCase()===s.toLowerCase())&&(!l&&!a||i(r,l,t,o)))},finishLoad:function(e,t,i,s){i=t?n.strip(i):i,_.isBuild&&(g[e]=i),s(i)},load:function(e,t,i,s){if(s&&s.isBuild&&!s.inlineText)return void i();_.isBuild=s&&s.isBuild;var o=n.parseName(e),r=o.moduleName+(o.ext?"."+o.ext:""),a=t.toUrl(r),l=_.useXhr||n.useXhr;return 0===a.indexOf("empty:")?void i():void(!h||l(a,u,f,p)?n.get(a,function(t){n.finishLoad(e,o.strip,t,i)},function(e){i.error&&i.error(e)}):t([r],function(e){n.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)}))},write:function(e,t,i,s){if(g.hasOwnProperty(t)){var o=n.jsEscape(g[t]);i.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,t,i,s,o){var r=n.parseName(t),a=r.ext?"."+r.ext:"",l=r.moduleName+a,d=i.toUrl(r.moduleName+a)+".js";n.load(l,i,function(t){var i=function(e){return s(d,e)};i.asModule=function(e,t){return s.asModule(e,d,t)},n.write(e,l,i,o)},o)}},"node"===_.env||!_.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(s=require.nodeRequire("fs"),n.get=function(e,t,i){try{var n=s.readFileSync(e,"utf8");"\ufeff"===n[0]&&(n=n.substring(1)),t(n)}catch(o){i&&i(o)}}):"xhr"===_.env||!_.env&&n.createXhr()?n.get=function(e,t,i,s){var o,r=n.createXhr();if(r.open("GET",e,!0),s)for(o in s)s.hasOwnProperty(o)&&r.setRequestHeader(o.toLowerCase(),s[o]);_.onXhr&&_.onXhr(r,e),r.onreadystatechange=function(n){var s,o;4===r.readyState&&(s=r.status||0,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,i&&i(o)):t(r.responseText),_.onXhrComplete&&_.onXhrComplete(r,e))},r.send(null)}:"rhino"===_.env||!_.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?n.get=function(e,t){var i,n,s="utf-8",o=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),s)),l="";try{for(i=new java.lang.StringBuffer,n=a.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=a.readLine());)i.append(r),i.append(n);l=String(i.toString())}finally{a.close()}t(l)}:("xpconnect"===_.env||!_.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(o=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in o,n.get=function(e,t){var i,n,s,l={};a&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{i=o["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),i.init(s,1,0,!1),n=o["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),n.init(i,"utf-8",i.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),n.readString(i.available(),l),n.close(),i.close(),t(l.value)}catch(d){throw new Error((s&&s.path||"")+": "+d)}}),n}),define("text!lib/helpers/loader/before.html",[],function(){return'<span class="x-loader-inline before{{#is_button}} btn btn-default{{/is_button}}"{{#id}} id="{{id}}"{{/id}}>{{{ loader }}}{{#text}}{{#safe}}{{{ text }}}{{/safe}}{{^safe}}{{ text }}{{/safe}} {{/text}}</span>'}),define("text!lib/helpers/loader/after.html",[],function(){return'<span class="x-loader-inline after{{#is_button}} btn btn-default{{/is_button}}"{{#id}} id="{{id}}"{{/id}}>{{#text}}{{#safe}}{{{ text }}}{{/safe}}{{^safe}}{{ text }}{{/safe}} {{/text}}{{{ loader }}}</span>'}),define("lib/helpers/inline_loader",["lib/tools","mustache","text!./loader/before.html","text!./loader/after.html"],function(e,t,i,n){
var s="",o=-1,r=function(e){return"before"===e||"button_before"===e?i:n},a=function(e){return"undefined"!=typeof e?e:(o++,"_x_loader_"+o)},l=function(e,i,n,s){"string"!=typeof e&&(e="after"),this.html=t.render(r(e),{id:a(n),text:i,is_button:0===e.indexOf("button_"),loader:l.getImg(),safe:!!s}),this.node=!1};return l.setup=function(t){e.preloadPicture(t),s='<img class="x-loader-inline-img" src="'+t+'" />'},l.get=function(e,t,i){return new l(e,t,i)},l.getSafe=function(e,t,i){return new l(e,t,i,!0)},l.getImg=function(){return 0===s.length&&console.error("Loader image not setup"),s},l.prototype={getHtml:function(){return this.html},getNode:function(){return this.node||(this.node=$(this.html)),this.node},appendTo:function(e){return this.getNode().appendTo(e),this},prependTo:function(e){return this.getNode().prependTo(e),this},insertAfter:function(e){return this.getNode().insertAfter(e),this},insertBefore:function(e){return this.getNode().insertBefore(e),this},detach:function(){return this.getNode().detach(),this},remove:function(){this.node&&this.node.remove()}},l}),define("text!lib/helpers/popup/template.html",[],function(){return'<div class="x-popup {{ position }} {{ cls }}">\n\t<div class="x-popup-arrow"></div>\n\t<div class="x-popup-content"></div>\n\t{{#closebtn}}<div class="x-popup-close">x</div>{{/closebtn}}\n</div>\n'}),define("lib/helpers/popup",["mustache","text!./popup/template.html"],function(e,t){var i=[],n={relative_to:$(document.body),position:{v:"below",h:"right"},offset:{below:0,above:0,left:0,right:0},max_height:0,trigger:"click",autoclose:!0,closebtn:!1,template:t,popup_class:null,pos_on_scroll:!1},s=function(e,t,s){if(this.options=$.extend({},n,s||{}),this.setPosition(this.options.position,!0),this.button=e,this.content=t,this.opened=!1,this.options.trigger){var o=this;this.button.on(this.options.trigger,function(){o.toggle()})}i.push(this)};s.prototype={onOpen:null,onClose:null,setButton:function(e){return this.button.is(e)?this:(this.button=e,this.position(),this)},setContent:function(e){return this.popup.find(".x-popup-content").empty().append($(e)),this.position(),this},setPosition:function(e,t){return"object"==typeof e?!e.v||!e.h||"below"!==e.v&&"above"!==e.v||"right"!==e.h&&"left"!==e.h?(t&&(this.options.position=n.position),!1):(this.options.position=e,!0):(e=e.split(" "),2!==e.length||"below"!==e[0]&&"above"!==e[0]||"right"!==e[1]&&"left"!==e[1]?(t&&(this.options.position=n.position),!1):(this.options.position={v:e[0],h:e[1]},!0))},position:function(){if(!this.popup)return!1;var e=this.options.relative_to.offset(),t=this.button.offset(),i=t.top-e.top,n=t.left-e.left,s=!1,o=!1,r=this.popup.children(".x-popup-arrow");switch(this.options.position.v){case"below":i+=this.button.outerHeight(),r.length>0&&(i+=parseInt(r.css("border-bottom-width").replace("px",""))),"number"==typeof this.options.offset.below&&(i+=this.options.offset.below);break;case"above":s=this.options.relative_to.innerHeight()-i,r.length>0&&(s+=parseInt(r.css("border-bottom-width").replace("px",""))),"number"==typeof this.options.offset.above&&(s+=this.options.offset.above)}switch(this.options.position.h){case"right":o=this.options.relative_to.innerWidth()-n-this.button.outerWidth(),"number"==typeof this.options.offset.right&&(o+=this.options.offset.right);break;case"left":"number"==typeof this.options.offset.left&&(n+=this.options.offset.left)}this.popup.css("max-width","none"),o!==!1?(this.popup.css("right",o+"px"),r.css("right","")):(this.popup.css("left",n+"px"),r.css("left","")),s!==!1?this.popup.css("bottom",s+"px"):this.popup.css("top",i+"px");var a=this.popup.position();if(o!==!1){if(a.left>=2)return!0;var l=this.popup.outerWidth(),d=$("body").outerWidth(!0)-4;if(l>d&&(l=d,this.popup.css("max-width",l+"px")),a=this.popup.position(),a.left>=2)return!0;var c=parseInt(r.css("right").replace("px",""));return this.popup.css("right",o+a.left-2+"px"),r.css("right",c-a.left+2+"px"),!0}var l=this.popup.outerWidth(),d=$("body").outerWidth(!0)-2;if(a.left+l<=d)return!0;l>d-2&&(l=d-2,this.popup.css("max-width",l+"px"));var c=parseInt(r.css("left").replace("px","")),h=a.left+l-d;return this.popup.css("left",n-h+"px"),r.css("left",c+h+"px"),!0},_getPopup:function(){if(this.popup)return this.popup;this.opened=!0,this.popup=$(e.render(this.options.template,{position:this.options.position.v+" "+this.options.position.h,cls:this.options.popup_class,closebtn:this.options.closebtn}));var t;t="function"==typeof this.content?$(this.content()):$(this.content);var i=this.popup.find(".x-popup-content").append(t);if(this.options.max_height>0&&i.css("max-height",this.options.max_height+"px"),this.options.relative_to.css("position","relative").append(this.popup),this.position(),this.popup.on("click",function(e){e.stopPropagation()}),this.options.autoclose){var n=this;$("body").on("click",function(e){n.opened&&0===$(e.target).closest(n.button).length&&n.close()})}if(this.options.closebtn){var n=this;this.popup.children(".x-popup-close").on("click",function(){n.close()})}return this.onOpen&&this.onOpen(),this.popup},open:function(e){e&&(e.preventDefault(),e.stopPropagation()),this._getPopup(),this.opened||(this.opened=!0,this.popup.fadeIn(),this.position(),this.onOpen&&this.onOpen())},close:function(){this.opened&&(this.opened=!1,this.popup.fadeOut(),this.onClose&&this.onClose())},toggle:function(){return this.opened?void this.close():void this.open()},isOpened:function(){return this.opened}},$(window).resize(function(){for(var e in i)i[e].isOpened()&&i[e].position()});var o,r=function(){for(var e in i)i[e].isOpened()&&i[e].options.pos_on_scroll&&i[e].position()};return $(window).scroll(function(){o&&window.clearTimeout(o),o=window.setTimeout(r,500)}),s}),function(e){function t(){var e=r();e!==a&&(a=e,c.trigger("orientationchange"))}function i(t,i,n,s){var o=n.type;n.type=i,e.event.dispatch.call(t,n,s),n.type=o}e.attrFn=e.attrFn||{};var n="ontouchstart"in window,s={tap_pixel_range:5,swipe_h_threshold:50,swipe_v_threshold:50,taphold_threshold:750,doubletap_int:500,touch_capable:n,orientation_support:"orientation"in window&&"onorientationchange"in window,startevent:n?"touchstart":"mousedown",endevent:n?"touchend":"mouseup",moveevent:n?"touchmove":"mousemove",tapevent:n?"tap":"click",scrollevent:n?"touchmove":"scroll",hold_timer:null,tap_timer:null};e.isTouchCapable=function(){return s.touch_capable},e.getStartEvent=function(){return s.startevent},e.getEndEvent=function(){return s.endevent},e.getMoveEvent=function(){return s.moveevent},e.getTapEvent=function(){return s.tapevent},e.getScrollEvent=function(){return s.scrollevent},e.each(["tapstart","tapend","tapmove","tap","tap2","tap3","tap4","singletap","doubletap","taphold","swipe","swipeup","swiperight","swipedown","swipeleft","swipeend","scrollstart","scrollend","orientationchange"],function(t,i){e.fn[i]=function(e){return e?this.on(i,e):this.trigger(i)},e.attrFn[i]=!0}),e.event.special.tapstart={setup:function(){var t=this,n=e(t);n.on(s.startevent,function o(e){if(n.data("callee",o),e.which&&1!==e.which)return!1;var r=e.originalEvent,a={position:{x:s.touch_capable?r.touches[0].screenX:e.screenX,y:s.touch_capable?r.touches[0].screenY:e.screenY},offset:{x:s.touch_capable?Math.round(r.changedTouches[0].pageX-(n.offset()?n.offset().left:0)):Math.round(e.pageX-(n.offset()?n.offset().left:0)),y:s.touch_capable?Math.round(r.changedTouches[0].pageY-(n.offset()?n.offset().top:0)):Math.round(e.pageY-(n.offset()?n.offset().top:0))},time:Date.now(),target:e.target};return i(t,"tapstart",e,a),!0})},remove:function(){e(this).off(s.startevent,e(this).data.callee)}},e.event.special.tapmove={setup:function(){var t=this,n=e(t);n.on(s.moveevent,function o(e){n.data("callee",o);var r=e.originalEvent,a={position:{x:s.touch_capable?r.touches[0].screenX:e.screenX,y:s.touch_capable?r.touches[0].screenY:e.screenY},offset:{x:s.touch_capable?Math.round(r.changedTouches[0].pageX-(n.offset()?n.offset().left:0)):Math.round(e.pageX-(n.offset()?n.offset().left:0)),y:s.touch_capable?Math.round(r.changedTouches[0].pageY-(n.offset()?n.offset().top:0)):Math.round(e.pageY-(n.offset()?n.offset().top:0))},time:Date.now(),target:e.target};return i(t,"tapmove",e,a),!0})},remove:function(){e(this).off(s.moveevent,e(this).data.callee)}},e.event.special.tapend={setup:function(){var t=this,n=e(t);n.on(s.endevent,function o(e){n.data("callee",o);var r=e.originalEvent,a={position:{x:s.touch_capable?r.changedTouches[0].screenX:e.screenX,y:s.touch_capable?r.changedTouches[0].screenY:e.screenY},offset:{x:s.touch_capable?Math.round(r.changedTouches[0].pageX-(n.offset()?n.offset().left:0)):Math.round(e.pageX-(n.offset()?n.offset().left:0)),y:s.touch_capable?Math.round(r.changedTouches[0].pageY-(n.offset()?n.offset().top:0)):Math.round(e.pageY-(n.offset()?n.offset().top:0))},time:Date.now(),target:e.target};return i(t,"tapend",e,a),!0})},remove:function(){e(this).off(s.endevent,e(this).data.callee)}},e.event.special.taphold={setup:function(){var t,n=this,o=e(n),r={x:0,y:0},a=0,l=0;o.on(s.startevent,function d(e){if(e.which&&1!==e.which)return!1;o.data("tapheld",!1),t=e.target;var c=e.originalEvent,h=Date.now(),u={x:s.touch_capable?c.touches[0].screenX:e.screenX,y:s.touch_capable?c.touches[0].screenY:e.screenY},f={x:s.touch_capable?c.touches[0].pageX-c.touches[0].target.offsetLeft:e.offsetX,y:s.touch_capable?c.touches[0].pageY-c.touches[0].target.offsetTop:e.offsetY};r.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX,r.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY,a=r.x,l=r.y;var p=o.parent().data("threshold")?o.parent().data("threshold"):o.data("threshold"),g="undefined"!=typeof p&&p!==!1&&parseInt(p)?parseInt(p):s.taphold_threshold;return s.hold_timer=window.setTimeout(function(){var p=r.x-a,g=r.y-l;if(e.target==t&&(r.x==a&&r.y==l||p>=-s.tap_pixel_range&&p<=s.tap_pixel_range&&g>=-s.tap_pixel_range&&g<=s.tap_pixel_range)){o.data("tapheld",!0);var _=Date.now(),v={x:s.touch_capable?c.touches[0].screenX:e.screenX,y:s.touch_capable?c.touches[0].screenY:e.screenY},m={x:s.touch_capable?Math.round(c.changedTouches[0].pageX-(o.offset()?o.offset().left:0)):Math.round(e.pageX-(o.offset()?o.offset().left:0)),y:s.touch_capable?Math.round(c.changedTouches[0].pageY-(o.offset()?o.offset().top:0)):Math.round(e.pageY-(o.offset()?o.offset().top:0))},b=_-h,y={startTime:h,endTime:_,startPosition:u,startOffset:f,endPosition:v,endOffset:m,duration:b,target:e.target};o.data("callee1",d),i(n,"taphold",e,y)}},g),!0}).on(s.endevent,function c(){o.data("callee2",c),o.data("tapheld",!1),window.clearTimeout(s.hold_timer)}).on(s.moveevent,function h(e){o.data("callee3",h),a=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX,l=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY})},remove:function(){e(this).off(s.startevent,e(this).data.callee1).off(s.endevent,e(this).data.callee2).off(s.moveevent,e(this).data.callee3)}},e.event.special.doubletap={setup:function(){var t,n,o,r,a=this,l=e(a),d=null,c=!1;l.on(s.startevent,function h(e){return(!e.which||1===e.which)&&(l.data("doubletapped",!1),t=e.target,l.data("callee1",h),o=e.originalEvent,d||(d={position:{x:s.touch_capable?o.touches[0].screenX:e.screenX,y:s.touch_capable?o.touches[0].screenY:e.screenY},offset:{x:s.touch_capable?Math.round(o.changedTouches[0].pageX-(l.offset()?l.offset().left:0)):Math.round(e.pageX-(l.offset()?l.offset().left:0)),y:s.touch_capable?Math.round(o.changedTouches[0].pageY-(l.offset()?l.offset().top:0)):Math.round(e.pageY-(l.offset()?l.offset().top:0))},time:Date.now(),target:e.target}),!0)}).on(s.endevent,function u(e){var h=Date.now(),f=l.data("lastTouch")||h+1,p=h-f;if(window.clearTimeout(n),l.data("callee2",u),p<s.doubletap_int&&e.target==t&&p>100){l.data("doubletapped",!0),window.clearTimeout(s.tap_timer);var g={position:{x:s.touch_capable?e.originalEvent.changedTouches[0].screenX:e.screenX,y:s.touch_capable?e.originalEvent.changedTouches[0].screenY:e.screenY},offset:{x:s.touch_capable?Math.round(o.changedTouches[0].pageX-(l.offset()?l.offset().left:0)):Math.round(e.pageX-(l.offset()?l.offset().left:0)),y:s.touch_capable?Math.round(o.changedTouches[0].pageY-(l.offset()?l.offset().top:0)):Math.round(e.pageY-(l.offset()?l.offset().top:0))},time:Date.now(),target:e.target},_={firstTap:d,secondTap:g,interval:g.time-d.time};c||(i(a,"doubletap",e,_),d=null),c=!0,r=window.setTimeout(function(){c=!1},s.doubletap_int)}else l.data("lastTouch",h),n=window.setTimeout(function(){d=null,window.clearTimeout(n)},s.doubletap_int,[e]);l.data("lastTouch",h)})},remove:function(){e(this).off(s.startevent,e(this).data.callee1).off(s.endevent,e(this).data.callee2)}},e.event.special.singletap={setup:function(){var t=this,n=e(t),o=null,r=null,a={x:0,y:0};n.on(s.startevent,function l(e){return(!e.which||1===e.which)&&(r=Date.now(),o=e.target,n.data("callee1",l),a.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX,a.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY,!0)}).on(s.endevent,function d(e){if(n.data("callee2",d),e.target==o){var l=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].pageX:e.pageX,c=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].pageY:e.pageY;s.tap_timer=window.setTimeout(function(){var o=a.x-l,d=a.y-c;if(!n.data("doubletapped")&&!n.data("tapheld")&&(a.x==l&&a.y==c||o>=-s.tap_pixel_range&&o<=s.tap_pixel_range&&d>=-s.tap_pixel_range&&d<=s.tap_pixel_range)){var h=e.originalEvent,u={position:{x:s.touch_capable?h.changedTouches[0].screenX:e.screenX,y:s.touch_capable?h.changedTouches[0].screenY:e.screenY},offset:{x:s.touch_capable?Math.round(h.changedTouches[0].pageX-(n.offset()?n.offset().left:0)):Math.round(e.pageX-(n.offset()?n.offset().left:0)),y:s.touch_capable?Math.round(h.changedTouches[0].pageY-(n.offset()?n.offset().top:0)):Math.round(e.pageY-(n.offset()?n.offset().top:0))},time:Date.now(),target:e.target};u.time-r<s.taphold_threshold&&i(t,"singletap",e,u)}},s.doubletap_int)}})},remove:function(){e(this).off(s.startevent,e(this).data.callee1).off(s.endevent,e(this).data.callee2)}},e.event.special.tap={setup:function(){var t,n,o=this,r=e(o),a=!1,l=null,d={x:0,y:0};r.on(s.startevent,function c(e){return r.data("callee1",c),(!e.which||1===e.which)&&(a=!0,d.x=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageX:e.pageX,d.y=e.originalEvent.targetTouches?e.originalEvent.targetTouches[0].pageY:e.pageY,t=Date.now(),l=e.target,n=e.originalEvent.targetTouches?e.originalEvent.targetTouches:[e],!0)}).on(s.endevent,function h(e){r.data("callee2",h);var c=e.originalEvent.targetTouches?e.originalEvent.changedTouches[0].pageX:e.pageX,u=e.originalEvent.targetTouches?e.originalEvent.changedTouches[0].pageY:e.pageY,f=d.x-c,p=d.y-u;if(l==e.target&&a&&Date.now()-t<s.taphold_threshold&&(d.x==c&&d.y==u||f>=-s.tap_pixel_range&&f<=s.tap_pixel_range&&p>=-s.tap_pixel_range&&p<=s.tap_pixel_range)){for(var g=e.originalEvent,_=[],v=0;v<n.length;v++){var m={position:{x:s.touch_capable?g.changedTouches[v].screenX:e.screenX,y:s.touch_capable?g.changedTouches[v].screenY:e.screenY},offset:{x:s.touch_capable?Math.round(g.changedTouches[v].pageX-(r.offset()?r.offset().left:0)):Math.round(e.pageX-(r.offset()?r.offset().left:0)),y:s.touch_capable?Math.round(g.changedTouches[v].pageY-(r.offset()?r.offset().top:0)):Math.round(e.pageY-(r.offset()?r.offset().top:0))},time:Date.now(),target:e.target};_.push(m)}i(o,"tap",e,_)}})},remove:function(){e(this).off(s.startevent,e(this).data.callee1).off(s.endevent,e(this).data.callee2)}},e.event.special.swipe={setup:function(){function t(i){a=e(i.currentTarget),a.data("callee1",t),c.x=i.originalEvent.targetTouches?i.originalEvent.targetTouches[0].pageX:i.pageX,c.y=i.originalEvent.targetTouches?i.originalEvent.targetTouches[0].pageY:i.pageY,h.x=c.x,h.y=c.y,l=!0;var n=i.originalEvent;o={position:{x:s.touch_capable?n.touches[0].screenX:i.screenX,y:s.touch_capable?n.touches[0].screenY:i.screenY},offset:{x:s.touch_capable?Math.round(n.changedTouches[0].pageX-(a.offset()?a.offset().left:0)):Math.round(i.pageX-(a.offset()?a.offset().left:0)),y:s.touch_capable?Math.round(n.changedTouches[0].pageY-(a.offset()?a.offset().top:0)):Math.round(i.pageY-(a.offset()?a.offset().top:0))},time:Date.now(),target:i.target}}function i(t){a=e(t.currentTarget),a.data("callee2",i),h.x=t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageX:t.pageX,h.y=t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageY:t.pageY;var n,r=a.parent().data("xthreshold")?a.parent().data("xthreshold"):a.data("xthreshold"),u=a.parent().data("ythreshold")?a.parent().data("ythreshold"):a.data("ythreshold"),f="undefined"!=typeof r&&r!==!1&&parseInt(r)?parseInt(r):s.swipe_h_threshold,p="undefined"!=typeof u&&u!==!1&&parseInt(u)?parseInt(u):s.swipe_v_threshold;if(c.y>h.y&&c.y-h.y>p&&(n="swipeup"),c.x<h.x&&h.x-c.x>f&&(n="swiperight"),c.y<h.y&&h.y-c.y>p&&(n="swipedown"),c.x>h.x&&c.x-h.x>f&&(n="swipeleft"),void 0!=n&&l){c.x=0,c.y=0,h.x=0,h.y=0,l=!1;var g=t.originalEvent,_={position:{x:s.touch_capable?g.touches[0].screenX:t.screenX,y:s.touch_capable?g.touches[0].screenY:t.screenY},offset:{x:s.touch_capable?Math.round(g.changedTouches[0].pageX-(a.offset()?a.offset().left:0)):Math.round(t.pageX-(a.offset()?a.offset().left:0)),y:s.touch_capable?Math.round(g.changedTouches[0].pageY-(a.offset()?a.offset().top:0)):Math.round(t.pageY-(a.offset()?a.offset().top:0))},time:Date.now(),target:t.target},v=Math.abs(o.position.x-_.position.x),m=Math.abs(o.position.y-_.position.y),b={startEvnt:o,endEvnt:_,direction:n.replace("swipe",""),xAmount:v,yAmount:m,duration:_.time-o.time};d=!0,a.trigger("swipe",b).trigger(n,b)}}function n(t){a=e(t.currentTarget);var i="";if(a.data("callee3",n),d){var r=a.data("xthreshold"),c=a.data("ythreshold"),h="undefined"!=typeof r&&r!==!1&&parseInt(r)?parseInt(r):s.swipe_h_threshold,u="undefined"!=typeof c&&c!==!1&&parseInt(c)?parseInt(c):s.swipe_v_threshold,f=t.originalEvent,p={position:{x:s.touch_capable?f.changedTouches[0].screenX:t.screenX,y:s.touch_capable?f.changedTouches[0].screenY:t.screenY},offset:{x:s.touch_capable?Math.round(f.changedTouches[0].pageX-(a.offset()?a.offset().left:0)):Math.round(t.pageX-(a.offset()?a.offset().left:0)),y:s.touch_capable?Math.round(f.changedTouches[0].pageY-(a.offset()?a.offset().top:0)):Math.round(t.pageY-(a.offset()?a.offset().top:0))},time:Date.now(),target:t.target};o.position.y>p.position.y&&o.position.y-p.position.y>u&&(i="swipeup"),o.position.x<p.position.x&&p.position.x-o.position.x>h&&(i="swiperight"),o.position.y<p.position.y&&p.position.y-o.position.y>u&&(i="swipedown"),o.position.x>p.position.x&&o.position.x-p.position.x>h&&(i="swipeleft");var g=Math.abs(o.position.x-p.position.x),_=Math.abs(o.position.y-p.position.y),v={startEvnt:o,endEvnt:p,direction:i.replace("swipe",""),xAmount:g,yAmount:_,duration:p.time-o.time};a.trigger("swipeend",v)}l=!1,d=!1}var o,r=this,a=e(r),l=!1,d=!1,c={x:0,y:0},h={x:0,y:0};a.on(s.startevent,t),a.on(s.moveevent,i),a.on(s.endevent,n)},remove:function(){e(this).off(s.startevent,e(this).data.callee1).off(s.moveevent,e(this).data.callee2).off(s.endevent,e(this).data.callee3)}},e.event.special.scrollstart={setup:function(){function t(e,t){n=t,i(r,n?"scrollstart":"scrollend",e)}var n,o,r=this,a=e(r);a.on(s.scrollevent,function l(e){a.data("callee",l),n||t(e,!0),clearTimeout(o),o=setTimeout(function(){t(e,!1)},50)})},remove:function(){e(this).off(s.scrollevent,e(this).data.callee)}};var o,r,a,l,d,c=e(window),h={0:!0,180:!0};if(s.orientation_support){var u=window.innerWidth||c.width(),f=window.innerHeight||c.height(),p=50;l=u>f&&u-f>p,d=h[window.orientation],(l&&d||!l&&!d)&&(h={"-90":!0,90:!0})}e.event.special.orientationchange=o={setup:function(){return!s.orientation_support&&(a=r(),c.on("throttledresize",t),!0)},teardown:function(){return!s.orientation_support&&(c.off("throttledresize",t),!0)},add:function(e){var t=e.handler;e.handler=function(e){return e.orientation=r(),t.apply(this,arguments)}}},e.event.special.orientationchange.orientation=r=function(){var e=!0,t=document.documentElement;return e=s.orientation_support?h[window.orientation]:t&&t.clientWidth/t.clientHeight<1.1,e?"portrait":"landscape"},e.event.special.throttledresize={setup:function(){e(this).on("resize",b)},teardown:function(){e(this).off("resize",b)}};var g,_,v,m=250,b=function(){_=Date.now(),v=_-y,v>=m?(y=_,e(this).trigger("throttledresize")):(g&&window.clearTimeout(g),g=window.setTimeout(t,m-v))},y=0;e.each({scrollend:"scrollstart",swipeup:"swipe",swiperight:"swipe",swipedown:"swipe",swipeleft:"swipe",swipeend:"swipe",tap2:"tap"},function(t,i){e.event.special[t]={setup:function(){e(this).on(i,e.noop)}}})}(jQuery),define("jquery-mobile-events",function(){}),define("lib/helpers/thumbs/mozaique",["lib/tools"],function(e){var t,i=function(e){return e++,e>9?0:e},n=function(e,t,i){return e++,e>=t?i?-1:0:e},s=function(e,i){var n=Math.floor((e-1)/3);return 0===n?"0%":n*-1*(t?100:i?56.25:75)+"%"},o=function(e){this.rotator=e,this.name=e.ENGINE_MOZAIQUE,this.is_video_engine=!1,this.thumb,this.ori_src,this.is_profile_pic,this.is_video_pic,this.is_16_9,this.idx,this.mozaique,this.videos,this.timer};return o.prototype={startVideoPic:function(e){var t=this;this.thumb=e;var i=this.thumb.attr("src");this.is_16_9=i.indexOf("/thumbs169")!==-1,this.idx=0,this.mozaique=this.thumb.next(".hovered"),0===this.mozaique.length&&(i=i.substring(0,i.lastIndexOf("/")),this.mozaique=$('<img class="hovered" src="'+i+'/mozaiquehome.jpg" />').hide().insertAfter(this.thumb).on("mouseout",function(e){t.rotator.stop(e)})),this.timer=window.setTimeout(function(){t.nextVideo()},30)},startProfilePic:function(t,i){this.thumb=t,this.ori_src=this.thumb.attr("src"),this.is_profile_pic=this.thumb.hasClass("profile-pic"),this.is_video_pic=this.thumb.hasClass("video-pic"),this.idx=-1,this.videos=i,e.preloadPicture(i[0].img);var n=this;this.timer=window.setTimeout(function(){n.nextProfPic()},30)},nextVideo:function(){if(this.thumb){var e=this;this.idx=i(this.idx),0===this.idx?this.mozaique.hide():1===this.idx?this.mozaique.show().css({marginTop:"0%",marginLeft:"0%"}):(this.mozaique.css({marginTop:s(this.idx,this.is_16_9),marginLeft:Math.floor((this.idx-1)%3)*-100+"%"}),"undefined"==typeof t&&4===this.idx&&(t=Math.abs(this.thumb.height()-Math.abs(parseInt(this.mozaique.css("marginTop").replace("px",""))))>5,t&&this.mozaique.css({marginTop:s(this.idx,this.is_16_9)}))),this.timer=window.setTimeout(function(){e.nextVideo()},1e3)}},nextProfPic:function(){if(this.thumb){var t=this;this.idx=n(this.idx,this.videos.length,this.is_video_pic),this.is_video_pic&&(this.idx===-1?this.thumb.addClass("video-pic"):this.thumb.removeClass("video-pic")),this.thumb.attr("src",this.idx===-1?this.ori_src:this.videos[this.idx].img),this.is_profile_pic&&(this.idx===-1?this.thumb.addClass("profile-pic"):this.thumb.removeClass("profile-pic"));var i=n(this.idx,this.videos.length,this.is_video_pic);i!==-1&&e.preloadPicture(this.videos[i].img),this.timer=window.setTimeout(function(){t.nextProfPic()},1e3)}},stop:function(){this.timer&&(window.clearTimeout(this.timer),this.timer=null),this.thumb&&(this.mozaique&&this.mozaique.hide(),this.thumb=null,this.ori_src="",this.mozaique=null,this.videos=null)},isStillOnThumb:function(e){return this.thumb&&this.thumb.is(e)&&1===this.idx||this.mozaique&&this.mozaique.is(e)&&0===this.idx}},o}),define("lib/helpers/thumbs/mp4vp",["static/utils"],function(e){var t=function(e){return e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("."))},i=function(e,t){return e.substring(0,e.lastIndexOf("/")).replace(/\/thumbs(169)?(xnxx)?l*\//,"/videopreview/")+(t?"_169.mp4":"_43.mp4")},n=function(e){var t=0;for(var i in e)t+=e[i];return t/e.length},s=function(e,t){return e++,e>=t?0:e},o=function(e){this.rotator=e,this.name=e.ENGINE_MP4,this.is_video_engine=!0,this.thumb,this.is_16_9,this.idx,this.is_looping,this.node,this.pgsnode,this.pgsbar,this.pgs_req,this.req_loaded={},this.req_start=0,this.req_total=0,this.req_dur=[],this.req_duration=[]};return o.prototype={startVideoPic:function(e){this.is_looping=!0,this.startPreview(e)},startProfilePic:function(e,t){this.is_looping=t.length+(e.hasClass("video-pic")?1:0)<2,this.videos=t,this.thumb=e,this.startPreview(e)},startPreview:function(e){var t,n=this;if(this.thumb=e,e.hasClass("profile-pic")?(t=this.videos[0].img,this.thumb.prop("src",t).removeClass("profile-pic")):t=this.thumb.attr("src"),this.is_16_9=t.indexOf("/thumbs169")!==-1,this.idx=1,this.node=this.thumb.next(".videopv"),0===this.node.length){var s=this.thumb.parent().prop("href");this.node=$('<div class="videopv"><a href="'+s+'"></a><div class="progress"><div class="bar"></div></div></div>').insertAfter(this.thumb).on("mouseout",function(e){n.rotator.stop(e)})}else this.node.show();this.pgsnode=this.node.children(".progress").show(),this.pgsbar=this.pgsnode.children(".bar"),t=i(t,this.is_16_9),this.startPgsCheck(t);var o=this.createVideo(t);this.node.prepend(o)},nextPreview:function(){this.idx=s(this.idx,this.videos.length);var e=i(this.videos[this.idx].img,this.is_16_9);this.pgsnode.show(),this.startPgsCheck(e);var t=this.node.css("backgroundColor","").children("video"),n=this.createVideo(e,function(){t.remove(),t[0].src="",t[0].load()});t.after(n)},stop:function(){if(this.thumb){this.stopPgsCheck(),this.node.css("backgroundColor","").hide();var e=this.node.children("video");e.remove(),e[0].src="",e[0].load(),this.thumb=null,this.node=null,this.pgsnode=null,this.pgsbar=null,this.videos=null}},isStillOnThumb:function(e){return this.thumb&&this.thumb.is(e)&&1===this.idx},stopPgsCheck:function(){this.pgs_req&&(this.pgs_req.abort(),this.pgs_req=null,this.req_start=0,this.req_total=0)},startPgsCheck:function(i){var s=t(i);if("object"!=typeof this.req_loaded[s]&&(this.stopPgsCheck(),this.pgsbar.stop(!0).css("width","0%"),"boolean"!=typeof this.req_loaded[s])){var o=this;this.pgsbar.animate({width:"100%"},1e4,"linear"),this.req_start=(new Date).getTime(),this.req_total=0,this.pgs_req=e.createRequestObject(),this.pgs_req.open("GET",i),this.pgs_req.addEventListener("loadstart",function(e){o.req_start=(new Date).getTime()}),this.pgs_req.addEventListener("progress",function(e){if(e.lengthComputable&&(0===o.req_total&&o.req_dur.length>2&&o.pgsbar.stop(!0).animate({width:"100%"},Math.round(n(o.req_dur)*e.total),"linear"),o.req_total=e.total),!(o.req_dur.length>2)){if(e.lengthComputable){var t=Math.min(1,e.loaded/e.total*5/1),i=(new Date).getTime()-o.req_start;return t<1?void o.pgsbar.stop(!0).animate({width:"100%"},Math.round(i/t-i),"linear"):void o.pgsbar.stop(!0).animate({width:"100%"},1e3,"linear")}o.pgsbar.stop(!0).animate({width:"100%"},1e4,"linear")}}),this.pgs_req.addEventListener("load",function(){o.req_loaded[s]=!0}),this.pgs_req.addEventListener("abort",function(){o.req_loaded[s]!==!0&&delete o.req_loaded[s]}),this.pgs_req.send(),this.req_loaded[s]=this.pgs_req}},createVideo:function(e,o){var r=this,a=t(e),l=!1,d=document.createElement("video");d.src=e,d.muted=!0,d.autoplay="autoplay",d.addEventListener("progress",function(){4===d.readyState&&d.seekable.end(0)==d.buffered.end(0)&&(r.req_loaded[a]=!0)}),d.addEventListener("timeupdate",function(){if(!l){var e=2;if(r.req_duration.length>1&&(e=n(r.req_duration)/1e3-.5),!r.is_looping&&d.duration-d.currentTime<=e){l=!0;var o=s(r.idx,r.videos.length),a=r.videos[o].img,c=t(a);"undefined"==typeof r.req_loaded[c]&&r.startPgsCheck(i(a,r.is_16_9))}}}),this.is_looping?d.loop="loop":d.addEventListener("ended",function(){r.req_loaded[a]=!0,r.nextPreview()});var c=!1,h=function(){if(!c){if(c=!0,d.removeEventListener("playing",h),r.req_total>0){var e=(new Date).getTime()-r.req_start;r.req_dur.push(e/r.req_total),r.req_duration.push(e),r.req_dur.length>4&&(r.req_dur.shift(),r.req_duration.shift())}r.stopPgsCheck(),r.node.css("backgroundColor","#000"),r.pgsnode.hide(),"function"==typeof o&&o()}};return d.addEventListener("playing",h),d}},o}),define("lib/helpers/thumbs/tsvp",[],function(){var e=function(e){var t=0;for(var i in e)t+=e[i];return t/e.length},t=function(e,t){return e.substring(0,e.lastIndexOf("/")).replace(/\/thumbs(169)?(xnxx)?l*\//,"/videopreview/")+(t?"_169.ts":"_43.ts")},i=function(e,t){return e++,e>=t?0:e},n=function(e,t,i){i.stop(!0).css("width","0%").animate({width:"100%"},1e4,"linear"),JSMpeg.Player.call(this,e,t);var n=(new Date).getTime(),s=!1,o=this,r=!1;this.renderer.canvas.style.visibility="hidden",this.renderer.renderProgress=function(e){if(0!==e){o.is_cached=!1,i.stop(!0),s&&(s=!1,i.css("width",(100*e).toFixed(2)+"%"));var t=(new Date).getTime()-n;i.animate({width:"100%"},Math.max(200,Math.round(t/e-t)),"linear")}},this.renderer.render=function(e,t,n){this.enabled&&(r?"function"==typeof o.nextframe&&o.nextframe(o.video.getCurrentTime(),o.video.timestamps[o.video.timestamps.length-1].time):(r=!0,this.canvas.style.visibility="",i.stop(!0),"function"==typeof o.started&&o.started()),Object.getPrototypeOf(this).render.call(this,e,t,n),o.video.timestampIndex>0&&o.video.timestampIndex===o.video.timestamps.length-1&&"function"==typeof o.ended&&o.ended())},this.resetProgress=function(){s=!0}};n.prototype=Object.create(JSMpeg.Player.prototype,{}),n.prototype.is_cached=!0,n.prototype.started=null,n.prototype.nextframe=null,n.prototype.ended=null,n.prototype.constructor=n;var s=function(e){this.rotator=e,this.name=e.ENGINE_TS,this.is_video_engine=!0,this.thumb,this.is_16_9,this.idx,this.is_looping,this.node,this.pgsnode,this.pgsbar,this.player,this.nextplayer,this.req_duration=[]};return s.prototype={startVideoPic:function(e){this.is_looping=!0,this.startPreview(e)},startProfilePic:function(e,t){this.is_looping=t.length+(e.hasClass("video-pic")?1:0)<2,this.videos=t,this.thumb=e,this.startPreview(e)},startPreview:function(e){var t,i=this;if(this.thumb=e,e.hasClass("profile-pic")?(t=this.videos[0].img,this.thumb.removeClass("profile-pic")):t=this.thumb.attr("src"),this.is_16_9=t.indexOf("/thumbs169")!==-1,this.idx=1,this.node=this.thumb.next(".videopv"),0===this.node.length){var n=this.thumb.parent().prop("href");this.node=$('<div class="videopv"><a href="'+n+'"></a><div class="progress"><div class="bar"></div></div></div>').insertAfter(this.thumb).on("mouseout",function(e){i.rotator.stop(e)})}else this.node.show();this.pgsnode=this.node.children(".progress").show(),this.pgsbar=this.pgsnode.children(".bar"),this.player=this.createPlayer(t),this.node.prepend(this.player.options.canvas)},nextPreview:function(){this.idx=i(this.idx,this.videos.length);var e=this.videos[this.idx].img;this.pgsnode.show();var t=this.player;this.player=this.createPlayer(e),$(t.options.canvas).after(this.player.options.canvas)},stop:function(){this.thumb&&(this.node.css("backgroundColor","").hide(),this.player&&(this.player.destroy(),this.player.options.canvas.parentNode&&this.player.options.canvas.parentNode.removeChild(this.player.options.canvas),this.player=null),this.nextplayer&&(this.nextplayer.destroy(),this.nextplayer.options.canvas.parentNode&&this.nextplayer.options.canvas.parentNode.removeChild(this.nextplayer.options.canvas),this.nextplayer=null),this.thumb=null,this.node=null,this.pgsnode=null,this.pgsbar=null,this.videos=null)},isStillOnThumb:function(e){return this.thumb&&this.thumb.is(e)&&1===this.idx},createPlayer:function(s,o){if(s=t(s,this.is_16_9),!o&&this.nextplayer){if(this.nextplayer.source.url===s){this.nextplayer.resetProgress(),this.nextplayer.play();var r=this.nextplayer;return this.nextplayer=null,r}this.nextplayer.destroy(),this.nextplayer.options.canvas.parentNode&&this.nextplayer.options.canvas.parentNode.removeChild(this.nextplayer.options.canvas),this.nextplayer=null}var a=this,r=new n(s,{canvas:document.createElement("canvas"),progressive:!1,loop:this.is_looping,autoplay:"undefined"==typeof o||!o,decodeFirstFrame:!1},this.pgsbar);if(this.is_looping)r.started=function(){a.node.css("backgroundColor","#000"),a.pgsnode.hide()};else{
var l=this.player,d=(new Date).getTime();r.started=function(){if(a.node.css("backgroundColor","#000"),a.pgsnode.hide(),l&&(l.destroy(),l.options.canvas.parentNode.removeChild(l.options.canvas)),!r.is_cached){var e=(new Date).getTime()-d;a.req_duration.push(e),a.req_duration.length>4&&a.req_duration.shift()}},r.nextframe=function(t,n){if(!a.nextplayer){var s=2;if(a.req_duration.length>1&&(s=e(a.req_duration)/1e3-.5),n-t<=s){var o=i(a.idx,a.videos.length),r=a.videos[o].img;a.nextplayer=a.createPlayer(r,!0)}}},r.ended=function(){a.nextPreview()}}return r}},s}),define("lib/helpers/thumbs/rotator",["config/main","static/utils","jquery-mobile-events"],function(e,t){var i=function(){if(this.videopv_allowed=!1,this.videopv_enabled=!1,this.videopv_codec,"object"==typeof e.dyn&&"object"==typeof e.dyn.vp&&e.dyn.vp.allowed&&"string"==typeof e.dyn.vp.codec&&("mp4"===e.dyn.vp.codec||"ts"===e.dyn.vp.codec)&&(this.videopv_allowed=!0,this.videopv_codec=e.dyn.vp.codec,this.videopv_enabled=!e.dyn.vp.disabled,"mp4"===this.videopv_codec)){var t=document.createElement("video"),i="undefined"!=typeof t.canPlayType&&t.canPlayType('video/mp4; codecs="avc1.4D401E, mp4a.40.2"').length>0;i||(this.videopv_codec="ts")}this.thumbs=$(),this.thumb,this.ori_src,this.is_video_thumb,this.is_profile_pic,this.is_video_pic,this.trigger_event,this.start_timer,this.last_start,this.libtimer,this.initEngine()};return i.prototype={ENGINE_MOZAIQUE:"mozaique",ENGINE_MP4:"mp4vp",ENGINE_TS:"tsvp",addThumb:function(e){if(this.thumbs.index(e)===-1){var t=this;this.thumbs=this.thumbs.add($(e).on("swipe touchstart mouseenter",function(e){t.start(this,e.type)}).on("mouseleave",function(e){t.stop(e)}).on("mousedown",function(e){t.lock(e)}))}},initEngine:function(){var i=this.ENGINE_MOZAIQUE;if(this.videopv_enabled)if("mp4"===this.videopv_codec)i=this.ENGINE_MP4;else if("ts"===this.videopv_codec)if("object"==typeof JSMpeg)i=this.ENGINE_TS,this.libtimer&&(window.clearInterval(this.libtimer),this.libtimer=null);else if(!this.libtimer){t.loadScript(e.domains["static"]+"/v3/js/libs/jsmpeg.min.js");var n=this;this.libtimer=window.setInterval(function(){n.initEngine()},500)}if(!this.engine||this.engine.name!==i){var n=this,s=function(e){var t=!1,i=n.thumb;n.engine&&n.thumb&&(n.stop(!0),t=!0),n.engine=new e(n),t&&n.start(i,n.trigger_event)};i===this.ENGINE_MOZAIQUE?require(["lib/helpers/thumbs/mozaique"],s):i===this.ENGINE_MP4?require(["lib/helpers/thumbs/mp4vp"],s):i===this.ENGINE_TS&&require(["lib/helpers/thumbs/tsvp"],s)}},toggleVP:function(){this.videopv_allowed&&(this.videopv_enabled=!this.videopv_enabled,this.initEngine())},start:function(e,t){if(this.start_timer&&(window.clearTimeout(this.start_timer),this.start_timer=null),!this.thumb||!this.thumb.is(e)){var i=(new Date).getTime();if(this.last_start>0&&i-this.last_start<300||!this.engine){this.last_start=i;var n=this;return void(this.start_timer=window.setTimeout(function(){n.start(e,t)},300))}this.last_start=i,this.trigger_event=t,this.stop(!0),this.thumb=$(e);var s=this.thumb.data("videos");if(this.is_video_thumb="object"!=typeof s,this.is_profile_pic=!1,this.is_video_pic=!1,this.is_video_thumb)this.engine.startVideoPic(this.thumb);else{if(this.ori_src=this.thumb.attr("src"),this.ori_src.indexOf("/profthumb/")>0&&(!s||0===s.length))return this.thumb.off("swipe touchstart mouseenter mouseleave mousedown"),void(this.thumb=null);if(this.is_profile_pic=this.thumb.hasClass("profile-pic"),this.is_video_pic=this.thumb.hasClass("video-pic"),(!s||0===s.length)&&(!this.engine.is_video_engine||this.is_profile_pic))return;this.engine.startProfilePic(this.thumb,s)}}},stop:function(e){if(this.engine){if(e!==!0){if("swipe"===this.trigger_event)return;if(this.engine.isStillOnThumb(e.target))return}this.engine.stop(),this.thumb&&(this.is_video_pic&&this.thumb.addClass("video-pic"),this.is_video_thumb||this.thumb.attr("src",this.ori_src),this.is_profile_pic&&this.thumb.addClass("profile-pic"),this.thumb=null)}},lock:function(e){1!==e.which||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||(this.thumbs.off("swipe touchstart mouseenter mouseleave"),this.stop(!0))}},i}),define("lib/helpers/events/tab",[],function(){function e(e){e=e||window.event;var o;if(o=e.type in a?a[e.type]:this[s]?"hidden":"visible",t!==o)if(t=o,"hidden"===o)for(var r in n)n[r]();else for(var r in i)i[r]()}var t,i=[],n=[],s="hidden",o="visible",r="hidden",a={focus:o,focusin:o,pageshow:o,blur:r,focusout:r,pagehide:r};s in document?document.addEventListener("visibilitychange",e):(s="mozHidden")in document?document.addEventListener("mozvisibilitychange",e):(s="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",e):(s="msHidden")in document?document.addEventListener("msvisibilitychange",e):"onfocusin"in document?document.onfocusin=document.onfocusout=e:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=e,$(window).on("blur",e),$(window).on("focus",e);var l={addHiddenListener:function(e){n.push(e)},addVisibleListener:function(e){i.push(e)}};return l}),define("lib/helpers/events",[],function(){var e=0,t=function(){this.thlistener,this.thlisteners=[],this.tvlistener,this.tvlisteners=[]};return t.prototype={TAB_HIDDEN:"tab.hidden",TAB_VISIBLE:"tab.visible",addListener:function(t,i){switch(t){case this.TAB_HIDDEN:if(this.thlisteners[e]=i,!this.thlistener){this.thlistener=!0;var n=this;require(["lib/helpers/events/tab"],function(e){e.addHiddenListener(function(){for(var e in n.thlisteners)n.thlisteners[e]()})})}return e++,e-1;case this.TAB_VISIBLE:if(this.tvlisteners[e]=i,!this.tvlistener){this.tvlistener=!0;var n=this;require(["lib/helpers/events/tab"],function(e){e.addVisibleListener(function(){for(var e in n.tvlisteners)n.tvlisteners[e]()})})}return e++,e-1}return!1}},new t}),define("lib/helpers/thumbs_rotator",["./thumbs/rotator","./events"],function(e,t){var i,n,s,o=new e,r=0,a=1e3,l=function(){o.addThumb(this)},d=function(e,t){t?$(".thumb img",e).not(".no-rotate").each(l):$(".thumb-block",e).not(".no-rotate").find(".thumb img").each(l)};d.video_preview=o.videopv_enabled,d.toggle_vp=function(){o.toggleVP(),d.video_preview=o.videopv_enabled},d(),t.addListener(t.TAB_HIDDEN,function(){o.stop(!0)});var c=function(){if(i=null,r=(new Date).getTime(),o.thumb){var e=o.thumb.offset();if(n<e.left||s<e.top)return void o.stop(!0);var t=o.thumb.outerWidth(!0),a=o.thumb.outerHeight(!0);return n>e.left+t||s>e.top+a?void o.stop(!0):void 0}};return $(window).on("mousemove",function(e){if(n=e.pageX,s=e.pageY,!i){var t=(new Date).getTime()-r;return t<a-50?void(i=window.setTimeout(c,a-t)):void c()}}),d}),define("text!lib/helpers/overlay/template.html",[],function(){return'<div class="x-overlay">\n\t<div class="x-body">\n\t\t<div class="x-content"></div>\n\t\t<div class="x-close{{^closable}} hidden{{/closable}}" title="Click to close this message">&times;</div>\n\t</div>\n</div>'}),define("lib/helpers/overlay",["mustache","text!./overlay/template.html"],function(e,t){var i=function(i,n,s){this.open=!1,this.closable=!!n,this.esc_close=!1,this.esc_close_handler=null,this.click_close_handler=null,this.setCloseAction(s),this.parent=$(i).css("position","relative"),this.node=$(e.render(t,{closable:n})),this.body=this.node.children(".x-body");var o=this;this.close_node=this.body.children(".x-close").on("click",function(){"close"===o.close_action?o.close():o.hide()}),this.container=this.body.children(".x-content")};return i.get=function(e,t,n){return new i(e,t,n)},i.prototype={onShow:null,onHide:null,onClose:null,getNode:function(){return this.node},addClass:function(e){return this.node.addClass(e),this},setClosable:function(e,t){if(this.closable=!!e,this.esc_close=e&&t,this.closable?this.close_node.removeClass("hidden"):this.close_node.addClass("hidden"),this.esc_close){if(!this.esc_close_handler){var i=this;this.esc_close_handler=$("body").on("keyup",function(e){i.open&&27===e.which&&("close"===i.close_action?i.close():i.hide())}),this.click_close_handler=$("body").on("click",function(e){i.open&&0===$(e.target).closest(i.container).length&&("close"===i.close_action?i.close():i.hide())})}}else this.esc_close_handler&&($("body").off("keyup",this.esc_close_handler),this.esc_close_handler=null,$("body").off("click",this.click_close_handler),this.click_close_handler=null);return this},setCloseAction:function(e){this.close_action="hide"===e?"hide":"close"},setText:function(e){return this.container.text(e),this},setContent:function(e){return this.container.html(e),this},empty:function(){return this.container.empty(),this},append:function(e){return this.container.append(e),this},prepend:function(e){return this.container.prepend(e),this},show:function(){if(!this.open)return this.node.appendTo(this.parent),this.open=!0,this.onShow&&this.onShow(),this},hide:function(){if(this.open)return this.node.detach(),this.open=!1,this.onHide&&this.onHide(),this},close:function(){this.open&&(this.node.remove(),this.open=!1,this.onClose&&this.onClose())},autoclose:function(e){if(this.open){var t=this;window.setTimeout(function(){t.close()},e)}}},i}),define("lib/helpers/overlay/box",["lib/tools","../overlay"],function(e,t){var i=function(e,i,n){t.apply(this,arguments),this.ori_padding=!1,this.node.addClass("x-overlay-box")};return i.prototype=new t,i.get=function(e,t,n){return new i(e,t,n)},i.prototype.show=function(t){if(!this.open){if(this.node.appendTo(this.parent),t===!1)return this.body.css("margin-top","10px"),this.open=!0,this;t="undefined"!=typeof t&&$(t);var i=this.node.height(),n=this.body.outerHeight();if(i<n+10&&(this.ori_padding=this.parent.css("padding-bottom"),this.parent.css("padding-bottom",n+10-i+"px")),t&&t.length>0){var s=t.position().top,o=Math.max(10,Math.min(s,i-n-10));this.body.css("margin-top",o+"px")}else this.body.css("margin-top",Math.max(10,Math.round(Math.min(Math.min(.1*$(window).height(),150),(i-n)/2)))+"px"),this.closable&&e.scrollTo(this.node,10);return this.open=!0,this}},i.prototype.hide=function(){return this.ori_padding!==!1&&this.parent.css("padding-bottom",this.ori_padding),t.prototype.hide.apply(this)},i.prototype.close=function(){return this.ori_padding!==!1&&this.parent.css("padding-bottom",this.ori_padding),t.prototype.close.apply(this)},i}),define("lib/i18n",[],function(){return{version:"1.0.0",load:function(e,t,i,n){n.isBuild?i():xv.i18n.getCatalog(e,function(e){i(e)})}}}),define("skins/common/listing/settings",["config/main","static/cookies","lib/helpers/popup","lib/helpers/thumbs_rotator","lib/helpers/overlay/box","lib/i18n!front"],function(e,t,i,n,s,o){var r=$("#listing-settings");if(0!==r.length){var a,l=[];for(var d in e.dyn.ls.buttons){var c=e.dyn.ls.buttons[d];l.push(c)}var h=function(){var e=$("<ul>");for(var t in l)switch(l[t].name){case"nb_vids_per_row":e.append(u("xs","mobile","mobile-only-show-list-item")),e.append(u("sm","tablet","mobile-show-list-item mobile-only-hide")),e.append(u("lg","desktop","mobile-hide"));break;case"video_preview":e.append(f())}return e},u=function(e,i,n){var s=function(e,t){return'<span class="icon listing-nb-thumbs '+e+(t?" more":"")+'"></span> '+(t?o.__("listing.disp_less_thumbs"):o.__("listing.disp_more_thumbs")).replace("%strong%","<strong>").replace("%end_strong%","</strong>")},r=$("html").hasClass("more-thumbs-"+e),l=$('<a href="#">'+s(i,r)+"</a>");return l.on("click",function(n){n.preventDefault(),r=!r,$("html").toggleClass("more-thumbs-"+e,r),l.html(s(i,r)),t.setLocal("hexavid_more_thumbs_"+e,r?"1":"0",7776e7,"/"),a.position()}),$('<li class="round-icons '+n+'"></li>').append(l)},f=function(){var e=function(e){return'<span class="icon video-preview-'+(e?"on":"off")+'"></span> '+(e?o.__("listing.disable_pv"):o.__("listing.enable_pv")).replace("%strong%","<strong>").replace("%end_strong%","</strong>")},i=$("<li></li>"),s=$('<a href="#">'+e(n.video_preview)+"</a>").appendTo(i);return s.on("click",function(i){i.preventDefault(),n.toggle_vp(),s.html(e(n.video_preview)),t.setLocal("hexavid_no_videopv",n.video_preview?"0":"1",7776e7,"/"),a.position()}),i};a=new i(r.children("button,a,.btn"),h,{trigger:"click mouseclick",popup_class:"listing-settings-popup"})}}),define("text!lib/helpers/popup/language_switcher.html",[],function(){return'<ul>\n\t{{#languages}}\n\t<li><a href="{{{ url }}}"><span class="flag-small flag-{{{ country }}}"></span> {{ name }}</a></li>\n\t{{/languages}}\n</ul>'}),define("lib/helpers/popup/language_switcher",["mustache","../popup","text!./language_switcher.html"],function(e,t,i){var n=function(n,s,o){var r=function(){var t=[];for(var n in o)t.push({url:s+n,country:o[n].country.toLowerCase(),name:o[n].translated});return e.render(i,{languages:t})};new t(n,r,{trigger:"click mouseclick",popup_class:"language-switcher-popup",offset:{below:-7,above:0,left:0,right:0}})};return n}),define("lib/helpers/storage/cookie",["static/cookies"],function(e){var t="_globalns_",i=function(){this.data={}};return i.prototype={_loadNs:function(i){if("string"==typeof i&&0!==i.length||(i=t),"object"!=typeof this.data[i]){this.data[i]={};var n=e.get("hexavid_storage_"+i);if("string"==typeof n&&n.length>0)try{n=JSON.parse(n),"object"==typeof n&&(this.data[i]=n)}catch(s){console.error(s)}}},_write:function(i){"string"==typeof i&&0!==i.length||(i=t);try{var n=JSON.stringify(this.data[i]);e.setLocal("hexavid_storage_"+i,n,31536e6,"/")}catch(s){console.error(s)}},get:function(e,i){return this._loadNs(i),"undefined"==typeof this.data[i||t][e]?null:this.data[i||t][e]},set:function(e,i,n){this._loadNs(n),this.data[n||t][e]=i,this._write(n)},remove:function(e,i){this._loadNs(i),"undefined"!=typeof this.data[i||t][e]&&(delete this.data[i||t][e],this._write(i))},clear:function(){this._loadNs(ns),this.data[ns||t]={},this._write(ns)}},new i}),define("lib/helpers/storage/local",[],function(){var e=function(){this.s=window.localStorage};return e.prototype={get:function(e,t){return"string"==typeof t&&t.length>0&&(e=t+"."+e),JSON.parse(this.s.getItem(e))},set:function(e,t,i){"string"==typeof i&&i.length>0&&(e=i+"."+e),this.s.setItem(e,JSON.stringify(t))},remove:function(e,t){"string"==typeof t&&t.length>0&&(e=t+"."+e),this.s.removeItem(e)},clear:function(){this.s.clear()}},new e}),define("lib/helpers/storage",["./storage/cookie","./storage/local"],function(e,t){var i="cookie";if("object"==typeof window.localStorage)try{var n=window.localStorage,s="__storage_test__";n.setItem(s,s),n.removeItem(s),i="local"}catch(o){}return"cookie"===i?e:t}),define("text!skins/common/debug/console.html",[],function(){return'<div class="debug-js-console" style="margin:10px 0;border:2px solid #000;background:#ddd;padding:5px 10px;font-family:monospace;font-size:12px;line-height:1.3;color:#000">\n\t<h4 style="font-weight:bold;font-size:15px;font-family:sans-serif;padding:0;text-decoration:underline;margin:0 0 10px">{{{ labels.console }}}</h4>\n\t<div class="debug-content"></div>\n\t<div style="font-size:12px;font-weight:bold;font-family:sans-serif;padding:0;margin:10px 0 0;text-align:right;text-decoration:underline"><a href="#">{{{ labels.close_console }}}</a></div>\n</div>'}),define("skins/common/debug/console",["mustache","lib/helpers/storage","lib/i18n!front","text!./console.html"],function(e,t,i,n){var s=function(){if(window.location.href.indexOf("debugjs=1")!==-1?(this.is_debug=!0,t.set("enabled",!0,"debugconsole")):t.get("enabled","debugconsole")&&(this.is_debug=!0),this.node,this.logs,this.is_debug&&"object"==typeof window.onerror){var e=this;window.onerror=function(t,i,n,s,o){return e.print(t+" / "+i+" / "+n,"globalerr"),o?(console.error(o),"string"==typeof o.stack&&e.print(o.stack,"stack")):console.error("ERROR: "+t+" / "+i+" / "+n),!0}}};return s.prototype={_read:function(){if("object"!=typeof this.logs){this.logsize=0,this.logs=t.get("logs","debugconsole"),this.logs&&"object"==typeof this.logs||(this.logs=[]);for(var e in this.logs)this.logsize+=this.logs[e].s}},_cleanLogs:function(){for(;this.logsize>1e5;){var e=this.logs.pop();this.logsize-=e.s}},log:function(e,i,n){this._read();var s={};s.t=(new Date).getTime(),s.x=e,s.a=i,n&&(s.js=n.status,s.jr=n.readyState,s.jh=n.getAllResponseHeaders(),s.jt=n.responseText.substr(0,1e3)),s.s=1e4;try{s.s=JSON.stringify(s).length}catch(o){}this.logs.unshift(s),this._cleanLogs(),t.set("logs",this.logs,"debugconsole")},print:function(e,t,i){if(this.is_debug){this.log(e,t,i),this._getNode();var n="<i>"+(new Date).toUTCString()+":</i> <strong>"+t+"</strong> - "+e.replace(/\n/gi,"<br>");this.node.append($('<p style="padding:0;margin:2px 0">'+n+"</p>")),i&&(this.node.append($('<p style="padding:0;margin:2px 0"><strong>Status: '+i.status+"</strong> / State: "+i.readyState+"</p>")),this.node.append($('<p style="padding:0;margin:2px 0"><strong>Response headers:</strong><br><small style="font-size:10px">'+i.getAllResponseHeaders().replace("\n","<br>")+"</small></p>")),this.node.append($('<p style="padding:0;margin:2px 0"><strong>Response text:</strong></p>')),this.node.append($('<pre style="font-size:10px;margin:2px 0;padding:0;border:none;max-height:100px;overflow-x:hidden;overflow-y:auto"></pre>').text(i.responseText)))}},_getNode:function(){if(this.node)return this.node;var s,o=["#main","#content","#page","body"],r=0;do s=$(o[r]),r++;while(0===s.length&&r<o.length);var a=$(e.render(n,{labels:i.__("debug.*")})).prependTo(s);return this.node=a.children(".debug-content"),a.find("a").on("click",function(e){e.preventDefault(),a.remove(),t.set("enabled",!1,"debugconsole")}),this.node}},new s}),define("lib/converter",[],function(){var e={},t={in2cm:2.54,lbs2kg:.45359237},i={"in":"cm",cm:"in",lbs:"kg",kg:"lbs"};return e.map=function(e){return i[e]},e.convert=function(e,n,s,o){"undefined"!=typeof s&&s||(s=i[n]);var r,a=n+"2"+s;if("undefined"==typeof t[a]){if(a=s+"2"+n,"undefined"==typeof t[a])return!1;r=1/t[a]}else r=t[a];var l=e*r;if("undefined"!=typeof o){if(0===o)return Math.round(l);var d=Math.pow(10,o);l=Math.round(l*d)/d}return l},e.trimPx=function(e){return Math.round(parseFloat(e.replace(/[^\d\.]/g,"")))},e}),define("skins/form/validator/schema",[],function(){var e=function(e,t,i){"undefined"!=typeof t&&(this.parent=e,this.halt_on_error=t.options.halt_on_error,this.validators=[],"undefined"!=typeof i&&this.init(t.rules,i))};return e.prototype={errorChanged:null,refresh:function(){for(var e in this.validators)this.validators[e].refresh&&this.validators[e].refresh()},isValid:function(){for(var e in this.validators)if(!this.validators[e].isValid())return!1;return!0},getFirstError:function(){for(var e in this.validators){if("function"==typeof this.validators[e].getFirstError){var t=this.validators[e].getFirstError();if(t)return t}if(!this.validators[e].isValid())return this.validators[e]}return null},init:function(e,t){var i=this,n=function(e,t){i.errorChanged&&i.errorChanged(e,t)};for(var s in e){var o,r=t[e[s].rule_name];o="schema"===e[s].rule_name?new r(i,e[s],t):new r(i,e[s]),o.errorChanged=n,this.validators.push(o)}},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e}},e}),define("skins/form/validator",["./validator/schema","lib/helpers/inline_loader"],function(e,t){var i=function(e){var t=[];for(var n in e){var s=e[n].rule_name,o=[s];"schema"===s&&(o=i(e[n].rules),o.push("schema"));for(var r in o)$.inArray(o[r],t)===-1&&t.push(o[r])}return t},n=function(n,s,o){this.options=o||{},e.apply(this,[null,{options:{halt_on_error:!1}}]),this.form=n,this.submit=n.find("button[type=submit],button.g-recaptcha"),this.target=!1;var r=$.trim(n.prop("target"));r.length>0&&(r=$("#"+r),r.length>0&&(this.target=r)),this.is_valid=!0,this.submitted=!1,this.captcha_submitted=!1;var a=this;this.submit.length>0&&this.form.on("submit",function(e){if(!a.captcha_submitted&&a.submit.hasClass("g-recaptcha")&&(a.captcha_submitted=!0,a.submit.on("click",function(){a.form.submit()})),!a.is_valid){var i=a.getFirstError();return i&&i.focus&&i.focus(),e.preventDefault(),!1}return a.submitted?(e.preventDefault(),!1):(a.submitted=!0,void a.submit.prop("disabled",!0).addClass("disabled").append($('<span class="vloader"> '+t.getImg()+"</span>")))});var l=i(s),d=[];for(var c in l)d.push("skins/form/validator/"+l[c]);require(d,function(){var e={};for(var t in arguments)e[l[t]]=arguments[t];a.init(s,e)})};return n.prototype=new e,n.prototype.init=function(t,i){if(e.prototype.init.apply(this,[t,i]),this.errorChanged(!1,this),!this.is_valid){var n=this.getFirstError();n&&n.focus&&"undefined"==typeof this.options.no_init_focus&&n.focus()}},n.prototype.errorChanged=function(e,t){this.is_valid=!e&&this.isValid(),this.submit.toggleClass("has-verror",!this.is_valid)},n.prototype.resetSubmit=function(){this.submitted&&(this.submitted=!1,this.submit.prop("disabled",!1).removeClass("disabled").find(".vloader").remove())},n}),define("skins/default/form/login_create",["config/main","skins/common/debug/console","lib/tools","lib/converter","lib/helpers/inline_loader","lib/helpers/overlay/box","skins/form/validator","lib/i18n!front"],function(e,t,i,n,s,o,r,a){var l,d,c,h,u,f,p,g,_,v,m,b,y,w,k,x,T,C,E,S=!0,N=!1,O={},I=function(e){if(!N){var t=p.parent().css("position","relative"),n=p,s=p;if(g.is(":visible")?n=g:m.is(":visible")&&(n=m),"signup"===e.form_disp?s=g:"lostpassword"===e.form_disp&&(s=m),!n.is(s)){N=!0;var o=Math.floor(n.innerWidth()/t.width()*100),a=n.height();o=o>=99?"100%":o>=58?"58.33333333%":o>=50?"50%":"41.66666667%",s.css({overflow:"hidden",display:"block",opacity:.01}).removeClass("hidden");var l=s.height();s.css("width",o).height(a).animate({opacity:1,height:l+"px"},"slow",function(){s.width("").height("")}),n.height(a).css({position:"absolute",top:0,left:0}).animate({opacity:0,height:l+"px"},"slow",function(){n.css({position:"static",top:"auto",left:"auto",height:"",display:"none"}),x.css("float","left"),N=!1})}if(b.toggleClass("hidden","signup"===e.form_disp),y.toggleClass("hidden","signup"!==e.form_disp),T.toggleClass("hidden","signup"===e.form_disp),!N){var d=_,C=_;v.is(":visible")&&(d=v),"step2"===f&&(C=v),d.is(C)||(d.toggleClass("hidden"),C.toggleClass("hidden"),g.toggleClass("col-xs-12 col-xs-7 col-md-6"),x.toggleClass("hidden","step2"===f),i.scrollTo(C))}var E={};if(S&&(S=!1,E.no_init_focus=!0),"signin"===e.form_disp)return c?c.refresh():c=new r($("#signin-form"),e.signin_validation_rules,E),!0;if("lostpassword"===e.form_disp){if(u)u.refresh();else{var O=$("#lost-password-form");O.length>0&&(u=new r(O,e.lostpwd_validation_rules,E))}return!0}return"signup"!==e.form_disp||(h?h.refresh():(k=!1,h=new r($("#signup-form"),e.signup_validation_rules,E),h.errorChanged=function(e,t){r.prototype.errorChanged.apply(this,[e,t]),k=!1;for(var i in this.validators){var n=this.validators[i];if(!n.isValid()&&n.id&&"signup-form_details_"===n.id.substr(0,20)){k=n;break}}w.toggleClass("has-verror",k!==!1)},h.errorChanged(!1,null)),k===!1)}},A=function(){},M=function(t,n){C=n,c&&(delete c,c=null),h&&(delete h,h=null),u&&(delete u,u=null),null!==t&&l.setContent(t),p=$("#signin-form-block"),b=$("#btn-login2signup"),g=$("#signup-form-block"),y=$("#btn-signup2login"),_=$("#signup-form_details"),v=$("#signup-form_step2"),m=$("#lostpassword-form-block"),x=$("#create-account-frame"),T=x.find(".no-create-account"),$("#signup-form_step2_profilepic .step2-profile-pic img").on("click",function(){$("#signup-form_step2_profilepic_file").click()}),f="details";var o=g.find(".has-error");o.length>0&&(f=o.first().parents("fieldset").last().prop("id").substr(12)),$("#btn-login2create,#btn-login2signup,#btn-signup2login").on("click",function(e){e.preventDefault(),n.form_disp="signup"!==n.form_disp?"signup":"signin",I(n)}),$("#btn-lostpassword2login").on("click",function(e){e.preventDefault(),n.form_disp="signin",I(n)}),$("#btn-login2lostpassword").on("click",function(e){e.preventDefault(),n.form_disp="lostpassword",I(n)}),w=$("#btn-signup2next,#btn-signup2prev").on("click",function(e){return e.preventDefault(),"details"===f&&k?void(k.focus&&k.focus()):(f="details"===f?"step2":"details",void I(n))});var r=g.find("input,select").on("keydown",function(e){if(13===e.which){var t=r.index(this);if(t===r.length-1)return;return r.eq(t+1).focus(),e.preventDefault(),!1}});return I(n),null===t?void($(".g-recaptcha").length>0&&A()):void l.getNode().find("form").each(function(){var t=$(this),n=t.find(".g-recaptcha"),o=n.is("button");if("signup-form"===t.prop("id")){if(0===n.length)return;if(o){var r=!0;t.on("submit",function(e){r&&e.preventDefault()})}return void i.loadRecaptcha(function(){grecaptcha.render(n.get(0),{callback:function(){o&&(r=!1,t.submit())}},!0)},e.dyn.locale)}var d,c,h,u=function(i){"object"==typeof i&&i.preventDefault(),c||(!h&&n.length>0&&o&&(n.on("click",u),n.prop("disabled",!0).addClass("disabled").append($('<span class="vloader"> '+s.getImg()+"</span>"))),h=!0,c=!0,d&&(d.remove(),d=null),$.ajax({type:"POST",url:e.domains.master+"/account/loginform",data:t.serializeArray(),dataType:"json",xhrFields:{withCredentials:!0},success:function(e){if(e.form_valid){if(l.close(),l=null,E&&"function"==typeof O[E])return void O[E]();window.location.reload()}M(e.form,e.reqjs)}}).fail(function(){d=$('<div class="alert alert-danger"><ul class="form-error-list"<li><strong><i class="fa fa-times-circle"></i> '+a.__("misc.error_please_retry")+"</strong></li></ul></div>").prependTo(t),n.length>0&&o&&n.prop("disabled",!1).removeClass("disabled").find(".vloader").remove()}).always(function(){c=!1}))};if(n.length>0){if(o)return t.on("submit",function(e){h||e.preventDefault()}),i.loadRecaptcha(function(){grecaptcha.render(n.get(0),{callback:u},!0)},e.dyn.locale),void A();i.loadRecaptcha(function(){grecaptcha.render(n.get(0),{},!0)},e.dyn.locale)}t.on("submit",function(e){e.preventDefault(),u()})})};$(document).on("signupform.submit.completed",function(){var e=C;e.form_disp="signup",M(h.target.contents().find("#iframe-content").html(),e)}),$(document).on("signupform.submit.validated",function(e){return E&&"function"==typeof O[E]?void O[E](e.referer):void(window.location.href=e.referer)});var q=function(){if(d){var e=l.body.innerHeight(),t=$(window).height(),n=Math.floor(x.innerWidth()/x.parent().width()*100);n>=99&&(e-=x.height()),i.scrollTo(l.body,-1*Math.round((e-t)/2))}},D=function(i){i&&(i.preventDefault(),i.stopPropagation()),l.setContent('<p class="text-center">'+s.getSafe("after",a.__("loading.loading")).getHtml()+"</p>").show();var n=e.domains.master+"/account/loginform";$.get(n,function(e){M(e.form,e.reqjs),q()},"json").fail(function(e,i,s){t.print("FAILED LOADING URL "+n+" => ERROR: "+i+' - "'+s+'"',"Login form",e);var o=$('<p class="text-center"><a><strong class="text-danger">'+a.__("loading.failed_retry")+"</strong></a></p>");o.find("a").on("click",D),l.setContent(o)})},R=function(e){return e&&(e.preventDefault(),e.stopPropagation()),l?(l.show(),void q()):(l=o.get("body",!0,"hide").setClosable(!0,!0).addClass("signin-popup-form"),l.onHide=function(){S=!0},void D())},P={};return P.setup_login_page=function(){d=!1;var t=function(e){this.node=e};t.prototype={setContent:function(e){this.node.html(e)},getNode:function(){return this.node}},l=new t($("#page")),M(null,e.data)},P.setup_links=function(e,t){var i=(new Date).getTime();t&&(O[i]=t),d=!0,e.on("click",function(e){E=i,$(this).trigger("menu.forceclose"),R(e)})},P.open=function(e){var t=(new Date).getTime();e&&(O[t]=e),d=!0,R()},P}),define("text!skins/default/profile/multi_accounts.html",[],function(){return'<ul>\n\t{{#accounts}}\n\t<li><a href="{{{ url }}}">{{ email }} - {{ name }}</a></li>\n\t{{/accounts}}\n</ul>'}),define("skins/default/profile/multi_accounts",["mustache","lib/helpers/popup","text!./multi_accounts.html"],function(e,t,i){var n=function(n,s,o){var r=function(){for(var t in o)o[t].url=s+o[t].id;return e.render(i,{accounts:o})};new t(n,r,{trigger:"mouseenter",popup_class:"multi-accounts-popup"})};return n}),require(["config/main"],function(e){"object"==typeof e.dyn.ls&&"object"==typeof e.dyn.ls.buttons&&e.dyn.ls.buttons.length>0&&require(["skins/common/listing/settings"]);var t=$("#language-switcher");t.length>0&&require(["lib/helpers/popup/language_switcher"],function(i){i(t,"/change-language/",e.data.other_locales)});var i=$(".menu-login-acct");i.length>0&&require(["skins/default/form/login_create"],function(e){e.setup_links(i)});var n=$("#multi-accounts-toggle");n.length>0&&"object"==typeof e.data.login_info.multi_accounts&&require(["skins/default/profile/multi_accounts"],function(t){t(n,e.domains.master+"/account/login_as/",e.data.login_info.multi_accounts)})}),define("skins/default/common",function(){}),define("text!skins/default/chat/friend.html",[],function(){return'<a id="select_friend_li_{{#search}}search_{{/search}}{{ id_user }}" class="user{{ id_user }} list-group-item {{#selected}}friend_selected{{/selected}}{{^is_online}} chat_friend_offline{{/is_online}}" href="#">\n\t<div class="chat_picture_status" style="background-image:url(\'{{{ profile_picture }}}\');">\n\t\t<div class="chat_status_favorite">{{#nb_unread}}<span class="badge">{{nb_unread}}</span>{{/nb_unread}}&nbsp;</div>\n\t\t<div class="chat_picture_filter">&nbsp;</div>\n\t</div>\n\t<div class="chat_profile_name" title="{{ profile_name }}">{{ profile_name }}</div>\n\t<div class="chat_profile_date"><span class="profile_link">Profile</span></div>\n</a>'}),define("text!skins/default/chat/message.html",[],function(){return'<li class="clearfix">\n\t<div class="chat-body clearfix">\n\t\t<div class="header">\n\t\t\t<strong class="primary-font {{ class_name }}" title="{{ user_name }}">{{ user_name }}</strong> <small class="{{ class_date }} text-muted">\n\t\t\t<span></span> {{ time }}</small>\n\t\t</div>\n\t\t<div class="chat_message_display">\n\t\t\t<div id="chat_message_{{ message_id }}">\n\t\t\t\t<div class="chat-actions {{ class_actions }}">\n\t\t\t\t\t{{#not_read}}<div class="chat_message_status_not_read"></div>{{/not_read}}\n\t\t\t\t\t{{#has_delete}}<div class="remove-message"><a href="#">x</a></div>{{/has_delete}}\n\t\t\t\t</div>\n\t\t\t\t<p class="{{ class_li }}">{{{ message }}}</p>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</li>'}),define("text!skins/default/chat/message_inside.html",[],function(){return'<div id="chat_message_{{ message_id }}" class="message_multi">\n    <div class="chat-actions {{ class_actions }}">\n        {{#not_read}}<div class="chat_message_status_not_read"></div>{{/not_read}}\n        {{#has_delete}}<div class="remove-message"><a href="#">x</a></div>{{/has_delete}}\n    </div>\n    <p class="{{ class_li }}">{{{ message }}}</p>\n</div>'}),define("text!skins/default/chat/window.html",[],function(){return'<div id="chat-window" class="chat-hidden">\n\t<div class="overlay-container">\n\t\t<h3 class="chat-title">\n\t\t\t<div class="close"><div>_</div></div>\n\t\t\t<div class="icon chat-icon">&nbsp;</div>\n\t\t\t<span class="chat-title-text">XVIDEOS Chat</span>\n\t\t</h3>\n\t\t<div class="row">\n\t\t\t<div class="col-xs-8 chat-messenger">\n\t\t\t\t<div class="chat-messages"></div>\n\t\t\t\t<div class="chat-message-form">\n\t\t\t\t\t<div class="input-group">\n\t\t\t\t\t\t<textarea class="form-control" style="resize:none" placeholder="Message..." disabled></textarea>\n\t\t\t\t\t\t<span class="input-group-addon btn btn-primary" id="chat-send-btn">Send</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="col-xs-4" id="chat-side-column">\n\t\t\t\t<div id="chat-users-lists">\n\t\t\t\t\t<div id="chat-users" class="chat-users">\n\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="chat-users-offline" class="chat-users">\n\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="chat-users-search" class="chat-users">\n\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="chat-users-search-close" class="chat-users">\n\t\t\t\t\t\t<a class="chat_back_to_friends">Back to friends</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id="chat-users-search-input" class="input-group">\n\t\t\t\t\t<input type="text" name="friend_name" disabled class="search-input form-control" maxlength="40" placeholder="Search friends">\n\t\t\t\t\t<span class="input-group-btn">\n\t\t\t\t\t\t<button type="button" id="chat-search-button" title="Search" class="search-submit btn btn-default"><span class="icon search-small gray"></span></button>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>';
}),function(e){"function"==typeof define&&define.amd?define("jquery-scrollLock",["jquery"],e):e(jQuery)}(function(e){"use strict";var t,i={space:32,pageup:33,pagedown:34,end:35,home:36,up:38,down:40},n=function(t,i){var n,s,o,r=i.scrollTop(),a=i.prop("scrollHeight"),l=i.prop("clientHeight"),d=t.originalEvent.wheelDelta||-1*t.originalEvent.detail||-1*t.originalEvent.deltaY,c=0;return"wheel"===t.type?(n=i.height()/e(window).height(),c=t.originalEvent.deltaY*n):this.options.touch&&"touchmove"===t.type&&(d=t.originalEvent.changedTouches[0].clientY-this.startClientY),o=(s=d>0&&r+c<=0)||d<0&&r+c>=a-l,{prevent:o,top:s,scrollTop:r,deltaY:c}},s=function(e,t){var n,s,o=t.scrollTop(),r={top:!1,bottom:!1};return r.top=0===o&&(e.keyCode===i.pageup||e.keyCode===i.home||e.keyCode===i.up),r.top||(n=t.prop("scrollHeight"),s=t.prop("clientHeight"),r.bottom=n===o+s&&(e.keyCode===i.space||e.keyCode===i.pagedown||e.keyCode===i.end||e.keyCode===i.down)),r},o=function(t,i){this.$element=t,this.options=e.extend({},o.DEFAULTS,this.$element.data(),i),this.enabled=!0,this.startClientY=0,this.options.unblock&&this.$element.on(o.CORE.wheelEventName+o.NAMESPACE,this.options.unblock,e.proxy(o.CORE.unblockHandler,this)),this.$element.on(o.CORE.wheelEventName+o.NAMESPACE,this.options.selector,e.proxy(o.CORE.handler,this)),this.options.touch&&(this.$element.on("touchstart"+o.NAMESPACE,this.options.selector,e.proxy(o.CORE.touchHandler,this)),this.$element.on("touchmove"+o.NAMESPACE,this.options.selector,e.proxy(o.CORE.handler,this)),this.options.unblock&&this.$element.on("touchmove"+o.NAMESPACE,this.options.unblock,e.proxy(o.CORE.unblockHandler,this))),this.options.keyboard&&(this.$element.attr("tabindex",this.options.keyboard.tabindex||0),this.$element.on("keydown"+o.NAMESPACE,this.options.selector,e.proxy(o.CORE.keyboardHandler,this)),this.options.unblock&&this.$element.on("keydown"+o.NAMESPACE,this.options.unblock,e.proxy(o.CORE.unblockHandler,this)))};o.NAME="ScrollLock",o.VERSION="3.1.2",o.NAMESPACE=".scrollLock",o.ANIMATION_NAMESPACE=o.NAMESPACE+".effect",o.DEFAULTS={strict:!1,strictFn:function(e){return e.prop("scrollHeight")>e.prop("clientHeight")},selector:!1,animation:!1,touch:"ontouchstart"in window,keyboard:!1,unblock:!1},o.CORE={wheelEventName:"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",animationEventName:["webkitAnimationEnd","mozAnimationEnd","MSAnimationEnd","oanimationend","animationend"].join(o.ANIMATION_NAMESPACE+" ")+o.ANIMATION_NAMESPACE,unblockHandler:function(e){e.__currentTarget=e.currentTarget},handler:function(t){var i,s,r;this.enabled&&!t.ctrlKey&&(i=e(t.currentTarget),(this.options.strict!==!0||this.options.strictFn(i))&&(t.stopPropagation(),s=e.proxy(n,this)(t,i),t.__currentTarget&&(s.prevent&=e.proxy(n,this)(t,e(t.__currentTarget)).prevent),s.prevent&&(t.preventDefault(),s.deltaY&&i.scrollTop(s.scrollTop+s.deltaY),r=s.top?"top":"bottom",this.options.animation&&setTimeout(o.CORE.animationHandler.bind(this,i,r),0),i.trigger(e.Event(r+o.NAMESPACE)))))},touchHandler:function(e){this.startClientY=e.originalEvent.touches[0].clientY},animationHandler:function(e,t){var i=this.options.animation[t],n=this.options.animation.top+" "+this.options.animation.bottom;e.off(o.ANIMATION_NAMESPACE).removeClass(n).addClass(i).one(o.CORE.animationEventName,function(){e.removeClass(i)})},keyboardHandler:function(t){var i,n=e(t.currentTarget),r=(n.scrollTop(),s(t,n));return t.__currentTarget&&(i=s(t,e(t.__currentTarget)),r.top&=i.top,r.bottom&=i.bottom),r.top?(n.trigger(e.Event("top"+o.NAMESPACE)),this.options.animation&&setTimeout(o.CORE.animationHandler.bind(this,n,"top"),0),!1):r.bottom?(n.trigger(e.Event("bottom"+o.NAMESPACE)),this.options.animation&&setTimeout(o.CORE.animationHandler.bind(this,n,"bottom"),0),!1):void 0}},o.prototype.toggleStrict=function(){this.options.strict=!this.options.strict},o.prototype.enable=function(){this.enabled=!0},o.prototype.disable=function(){this.enabled=!1},o.prototype.destroy=function(){this.disable(),this.$element.off(o.NAMESPACE),this.$element=null,this.options=null},t=e.fn.scrollLock,e.fn.scrollLock=function(t){return this.each(function(){var i=e(this),n="object"==typeof t&&t,s=i.data(o.NAME);(s||"destroy"!==t)&&(s||i.data(o.NAME,s=new o(i,n)),"string"==typeof t&&s[t]())})},e.fn.scrollLock.defaults=o.DEFAULTS,e.fn.scrollLock.noConflict=function(){return e.fn.scrollLock=t,this}}),define("skins/default/chat/manager",["config/main"],function(e){e.dyn.chat.enabled&&require(["mustache","static/cookies","lib/helpers/overlay","libs/socket.io","text!skins/default/chat/friend.html","text!skins/default/chat/message.html","text!skins/default/chat/message_inside.html","text!skins/default/chat/window.html","firebase","jquery-scrollLock"],function(t,i,n,s,o,r,a,l){firebase.initializeApp(e.dyn.chat.firebase);var d=function(t){return this.url_account_chat=e.domains.master+"/account/chat",this.nb_unread_interval_ajax=3e3,!1 in navigator||"undefined"==typeof navigator.serviceWorker?void this.initNode(!1):(this.debug=t,this.connection_master=window.location.protocol+"//chat-private-master.xvideos.com",this.url_base_profile=e.domains.slave+"/profiles/",this.friends_ids=[],this.friends={},this.favorite_img=e.domains["static"]+"/v2/img/chat_star.png",this.no_favorite_img=e.domains["static"]+"/v2/img/chat_star_empty.png",this.service_worker_file="/js/chat-prive-sw.js",this.sound_file=e.domains["static"]+"/v2/sound/notif1.mp3",this.selected_friend=0,this.nb_friends_get_with_more_link=40,this.sound=!1,this.notif=!1,this.notif_allowed=!0,this.service_worker_register=!1,this.useServiceWorkerDone=!1,this.serviceWorkerRegistration=null,this.serviceWorkerRegistrationBase=null,this.friends_infos_from_SW=null,this.connect_done=!1,this.force_friend=null,this.time_for_message_group=60,this.initNode(!0),this.initNotif(),void this.initServiceWorker())};return d.prototype={initNode:function(e){this.node=$(t.render(l,{sound_file:this.sound_file})).appendTo("body");var i=this;if(this.title=this.node.find(".chat-title"),!e)return this.title.on("click",function(){window.open(i.url_account_chat,"_blank")}),void(this.loop_ajax_nb_unread=setInterval(this.get_nb_unread_ajax.bind(this),this.nb_unread_interval_ajax));this.userlist=this.node.find("#chat-users"),this.userlistoffline=this.node.find("#chat-users-offline"),this.userlistsearch=this.node.find("#chat-users-search"),this.userlistsearchclose=this.node.find("#chat-users-search-close"),this.msglist=this.node.find(".chat-messages"),this.input=this.node.find("textarea"),this.inputnotif=this.node.find("#chat_checkbox_notif"),this.inputsound=this.node.find("#chat_checkbox_sound"),this.search_input=this.node.find("#chat-users-search-input input"),this.search_button=this.node.find("#chat-users-search-input button#chat-search-button"),this.search_back_button=this.node.find("#chat-users-search-close a.chat_back_to_friends"),this.opened=!1,this.title.on("click",function(){i.chat_toggle_display()}),this.overlay;var n=/^#chat_friend_([0-9]+)$/;if("undefined"!=typeof window.location.hash&&""!==window.location.hash){var s=n.exec(window.location.hash);if(s&&2===s.length){var o=parseInt(s[1]);0!==o&&(this.force_friend=o)}}this.log("force_friend",this.force_friend)},initNotif:function(){if(!("Notification"in window))return this.log("This browser does not support desktop notification"),this.notif_allowed=!1,!1;if(this.notif_allowed=!0,$("span#chat_check_notif").show(),this.notif_allowed){if("denied"===Notification.permission)return this.log("desktop notification permission denied"),this.notif=!1,!1;if("default"===Notification.permission){var e=this;this.log("asking for desktop notification permission"),Notification.requestPermission(function(t){"granted"===t&&(e.notif=!0,e.inputnotif.prop("checked",e.notif))})}else this.notif=!0,this.inputnotif.prop("checked",this.notif)}this.log("notif",this.notif)},initServiceWorker:function(){if(this.log("initServiceWorker"),!1 in navigator||"undefined"==typeof navigator.serviceWorker)return void this.serviceWorkerError({error:"serviceWorker not avialable"});var e=this,t=firebase.messaging();this.log("serviceWorker in navigator"),navigator.serviceWorker.register(this.service_worker_file).then(function(i){e.service_worker_register=!0,e.serviceWorkerRegistrationBase=i,e.useServiceWorkerDone||(t.useServiceWorker(i),e.useServiceWorkerDone=!0),t.requestPermission().then(function(){return e.log("Have permission"),t.getToken()}).then(function(t){e.log("get token",t),e.sw_token=t})["catch"](function(t){e.log("Firebase error Occured.",t)}),i.active?(e.serviceWorkerRegistration=i.active,navigator.serviceWorker.onmessage=e.serviceWorkerOnMessage.bind(e),e.connect_SW()):null!==e.force_friend&&e.chat_toggle_display()})["catch"](function(t){e.log("Firebase registration error Occured.",t)}),t.onTokenRefresh(function(){e.log("onTokenRefresh"),t.getToken().then(function(t){e.log("Token refreshed"),e.setSwToken(t)})["catch"](function(e){debug("Unable to retrieve refreshed token ",e)})}),t.onMessage(function(t){e.log("messaging.onMessage: ",t)})},serviceWorkerOnMessage:function(e){if(this.log("service worker onmessage",e.data.action),"undefined"!=typeof e.data.action&&"selectFriend"===e.data.action&&"undefined"!=typeof e.data.userId){if("undefined"==typeof this.friends[e.data.userId])return this.log("click on notif from an unknown friend. Ask for informations for user "+e.data.userId),void this.socket_connection.emit("getuserinfos",{friend_id:e.data.userId,callback_obj:{open_tab:!0}});this.select_friend(e.data.userId)}},serviceWorkerError:function(e){this.write_error({message:e.error})},connect_SW:function(){if(this.serviceWorkerRegistration){var e=this;new Promise(function(t,i){var n=new MessageChannel;n.port1.onmessage=function(n){if(e.log("connect_SW callback",n.data),n.data.error)return void i(n.data.error);if("undefined"==typeof n.data.connected||"ok"!==n.data.connected)return void i("sw connect failed");if("undefined"==typeof n.data.friends_ids)return void i("no friends ids return");if("undefined"==typeof n.data.friends_infos)return void i("no first friends infos");var s=!1;"boolean"==typeof n.data.chat_display&&(s=n.data.chat_display),t({friends_ids:n.data.friends_ids,friends_infos:n.data.friends_infos,chat_display:s})},e.serviceWorkerRegistration.postMessage({action:"connect_sw",id_user:e.user_id},[n.port2]);var s=4e3;setTimeout(function(){i("connect_sw timed out after "+s+" ms")},s)}).then(function(t){e.friends_ids=t.friends_ids,e.friends_infos_from_SW=t.friends_infos,t.chat_display||null!==e.force_friend?e.chat_toggle_display():e.after_connect_SW_no_display()})["catch"](function(t){e.log("connect_sw failed : ",t),null!==this.force_friend?e.chat_toggle_display():e.after_connect_SW_no_display()})}},after_connect_SW_no_display:function(){if(this.loop_ajax_nb_unread=setInterval(this.get_nb_unread_ajax.bind(this),this.nb_unread_interval_ajax),e.hasOwnProperty("data")&&e.data.hasOwnProperty("user")&&e.data.user.hasOwnProperty("id_user")&&this.friends_ids.indexOf(e.data.user.id_user)>-1){var t=$("#profile-tabs #tab-chat");t.removeAttr("href"),t.removeAttr("target");var i=this;t.on("click",function(){i.chat_toggle_display(!0)})}},get_nb_unread_ajax:function(){if(this.connect_done)return void clearInterval(this.loop_ajax_nb_unread);var e=this;$.ajax({url:"/chat_ajax/getnbunreadfriendsmessages"}).done(function(t){if(t.hasOwnProperty("nb_unread_messages")){var i=parseInt(t.nb_unread_messages);i==t.nb_unread_messages&&e.updateTotalNbUnread(i)}})},chat_toggle_display:function(e){"undefined"!=typeof e&&e==this.opened||(this.log("toggle display"),this.opened=!this.opened,this.node.toggleClass("chat-hidden"),!this.connect_done&&this.opened&&this.connect(),null===this.serviceWorkerRegistration&&null!==this.serviceWorkerRegistrationBase&&this.serviceWorkerRegistrationBase.active&&(this.serviceWorkerRegistration=this.serviceWorkerRegistrationBase.active,navigator.serviceWorker.onmessage=this.serviceWorkerOnMessage.bind(this)),this.serviceWorkerRegistration&&this.serviceWorkerRegistration.postMessage({action:"set_chat_display",display:this.opened}))},connect:function(){this.connect_done=!0,this.socketMaster=s(this.connection_master,{reconnection:!1}),setTimeout(this.verifMasterConnect,5e3);var e=this;this.socketMaster.on("nochatserver",function(){e.write_error({message:"No chat server avialable. Please retry."})}),this.socketMaster.on("chatserver",function(t){e.log("connected to master and got host : "+t),e.socketMaster.emit("end"),e.socket_connection=s(window.location.protocol+"//"+t,{query:$.param({hexavid_login:i.get("HEXAVID_LOGIN")})}),e.socket_connection.on("user_connected",e.user_connected.bind(e)),e.socket_connection.on("send_users_allids_and_first_infos",e.get_users_allids_and_first_infos.bind(e)),e.socket_connection.on("get_online_friends",e.get_online_friends.bind(e)),e.socket_connection.on("send_conversation",e.put_history.bind(e)),e.socket_connection.on("message_received",e.receive_message.bind(e)),e.socket_connection.on("message_deleted",e.delete_message.bind(e)),e.socket_connection.on("setuserinfos",e.setuserinfos.bind(e)),e.socket_connection.on("send_users_infos",e.send_users_infos.bind(e)),e.socket_connection.on("found_friends",e.found_friends.bind(e)),e.socket_connection.on("user_log_on",e.user_online.bind(e)),e.socket_connection.on("user_log_off",e.user_offline.bind(e)),e.socket_connection.on("change_prefs",e.set_change_prefs.bind(e)),e.socket_connection.on("chat_error",e.write_error.bind(e)),e.socket_connection.on("disconnect",function(){e.log("disconnect event"),$("div.chat-loader").show()}),e.socket_connection.on("reconnect",function(){e.log("reconnect event"),$("div.chat-loader").hide()}),e.socket_connection.on("connect_error",function(t){e.log("SOCKET CONNECTION ERROR",t),e.write_error({message:"An internal error occured. Please reload the page."}),e.socket_error=!0}),e.input.val(""),e.input.on("keyup",function(t){e.key_pressed(t)}),e.input.on("click",function(){e.set_read_date(e.selected_friend)}),e.search_input.on("keyup",function(t){e.search_key_pressed(t)}),e.input.prop("disabled",!1),e.node.find("#chat-send-btn").on("click",e.send_message.bind(e)),e.search_input.prop("disabled",!1),e.search_button.on("click",e.search_friend.bind(e)),e.search_back_button.on("click",e.hide_search_list.bind(e))}),this.socketMaster.on("connect_error",function(t){e.log("SOCKET MASTER ERROR",t),e.write_error({message:"An internal error occured. Please reload the page."}),e.socket_error=!0})},verifMasterConnect:function(){"undefined"!=typeof this.socketMaster&&"undefined"!=typeof this.socketMaster.connected&&this.socketMaster.connected===!1&&"undefined"==typeof this.socket_connection&&this.socket_error!==!0&&(this.log("conection timeout"),this.write_error({message:'Issue with chat "Connecting ..." ? Please desactivate ADBlock in chrome://extensions/ (Chrome) or about:addons (Firefox) (Only white-listing Xvideos.com is not working).'}))},user_connected:function(e){return this.log("socket user_connected",e),"undefined"==typeof e.infos_user?(this.log("infos_user is undefined"),void this.write_error("Unable to get informations. Please reload the page.")):(this.user_id=e.infos_user.id_user,this.profile_name=e.infos_user.profile_name,this.profile_picture=e.infos_user.profile_picture,this.nb_unread_messages=e.nb_unread_messages,this.nb_unread_messages_sum=e.nb_unread_messages_sum,this.updateTotalNbUnread(e.nb_unread_messages_sum),null===this.friends_infos_from_SW&&0!=Object.keys(this.friends).length&&0!=this.friends_ids.length&&(this.friends_infos_from_SW=this.friends),"undefined"!=typeof this.sw_token&&""!=this.sw_token&&this.setSwToken(this.sw_token),$("div.chat-loader").hide(),this.serviceWorkerRegistration&&this.serviceWorkerRegistration.postMessage({action:"set_id_user",id_user:e.infos_user.id_user}),void(null!==this.friends_infos_from_SW?this.socket_connection.emit("send_online_and_get_friends_online",{friends_ids:this.friends_ids}):this.socket_connection.emit("get_allusersids_and_firstusersinfos")))},get_online_friends:function(e){if(this.log("get_online_friends"),!e.hasOwnProperty("friends_online"))return this.log("get_online_friends","parameter friends_online missing"),void this.connect_and_friends_done(this.friends_infos_from_SW);var t=[];for(var i in e.friends_online)"undefined"!=typeof this.friends_infos_from_SW[e.friends_online[i]]?this.friends_infos_from_SW[e.friends_online[i]].is_online=!0:t.push(e.friends_online[i]);for(var n in this.friends_infos_from_SW)e.friends_online.indexOf(parseInt(n))===-1&&(this.friends_infos_from_SW[n].is_online=!1),this.friends_infos_from_SW[n].nb_unread=0,this.nb_unread_messages.hasOwnProperty(n)&&(this.friends_infos_from_SW[n].nb_unread=this.nb_unread_messages[n]);t.length>0&&this.socket_connection.emit("get_users_infos",{friends_ids:t}),this.connect_and_friends_done(this.friends_infos_from_SW)},get_users_allids_and_first_infos:function(e){return this.log("get_users_allids_and_first_infos"),"undefined"==typeof e.friends_ids||"undefined"==typeof e.first_friends_infos?(this.write_error("Unable to get friends. Please reload the page."),!1):(this.friends_ids=e.friends_ids,this.connect_and_friends_done(e.first_friends_infos),void(this.serviceWorkerRegistration&&this.serviceWorkerRegistration.postMessage({action:"set_friends",friends_ids:e.friends_ids,first_friends_infos:e.first_friends_infos})))},connect_and_friends_done:function(t){if(this.log("connect_and_friends_done"),Object.keys(this.friends).length>0&&0!=this.selected_friend&&($(".chat-messages .chat_group_tab_container").remove(),this.select_friend(this.selected_friend)),0===t.length)return void this.userlist.append('<a class="chat_no_friends">No friends</a>');var i=Object.values(t);i.sort(function(e,t){return e.is_online&&!t.is_online?-1:!e.is_online&&t.is_online?1:"undefined"==typeof e.interaction&&"undefined"==typeof t.interaction?0:"undefined"==typeof e.interaction?1:"undefined"==typeof t.interaction?-1:e.interaction>t.interaction?-1:t.interaction>e.interaction?1:0});var n=i[0].id_user;this.force_friend?n=this.force_friend:e.hasOwnProperty("data")&&e.data.hasOwnProperty("user")&&e.data.user.hasOwnProperty("id_user")&&this.friends_ids.indexOf(e.data.user.id_user)>-1&&(n=e.data.user.id_user);for(var s in i)i[s].id_user==n?this.add_friend(i[s],!0):this.add_friend(i[s]);Object.keys(this.friends).length<this.friends_ids.length&&this.addlink_more_friends(),this.select_friend(n)},add_friend:function(e,t){this.log("add_friend");var i=e.id_user;if(this.friends[i]=e,0!==$("#select_friend_li_"+i).length)return void this.log("friend already added");var n=this.userlist;e.is_online||(n=this.userlistoffline),"undefined"!=typeof t||t===!0?n.prepend(this.add_friend_html(e,!1)):n.append(this.add_friend_html(e,!1))},add_friend_html:function(e,i){var n=Object.assign({},e);n.favorite_img=this.favorite_img,n.selected=this.selected_friend==e.id_user,n.profile_url=this.url_base_profile+e.profile_name,n.search=i,"undefined"!=typeof e.interaction&&(n.not_read="",n.not_read_text="Date of last message",n.time=this.format_timestamp(e.interaction),e.id_user!==this.selected_friend&&("undefined"==typeof e.last_read||e.last_read<e.interaction)&&(n.not_read="not_read",n.not_read_text="Date of last message (not read)"));var s=this,r=$(t.render(o,n));return i?r.on("click",function(t){t.preventDefault(),$("#select_friend_li_"+e.id_user).remove(),s.add_friend(e,!0),s.select_friend(e.id_user),s.hide_search_list()}):r.on("click",function(t){t.preventDefault(),s.select_friend(e.id_user)}),r.find(".profile_link").on("click",function(){window.open(s.url_base_profile+e.profile_name,"_blank")}),r},select_friend:function(e){var t="chat_group_messages_tab_"+e;$(".chat_group_tab_container").hide();var i=$("#"+t);0===i.length?(this.msglist.append('<ul id="'+t+'" class="chat_group_tab_container"></ul>'),$("#"+t).scrollLock(),this.get_conversation(e)):(i.show(),this.scroll_down_conversation(e),this.set_read_date(e)),this.selected_friend=e,$("#chat-side-column div.chat-users a").removeClass("friend_selected"),$("#select_friend_li_"+e).addClass("friend_selected")},get_conversation:function(e,t,i){this.log("get_conversation",e+" "+t),"undefined"!=typeof i&&$(i).remove(),"undefined"==typeof t&&(t=0),$("#chat_group_messages_tab_"+e).prepend('<img class="load_history" src="'+window.location.protocol+'//static-hw.xvideos.com/v2/img/xv-inline-ajax-loader.gif">'),this.socket_connection.emit("get_conversation_friend",{sender_id:this.user_id,recipient_id:e,offset:t})},put_history:function(t){if(this.log("put history"),0!=$("img.load_history").length&&$("img.load_history").remove(),0!=Object.keys(t.conversations).length){if("undefined"==typeof this.friends[t.recipient_id])return void this.write_error({message:"Internal error. Load conversation for wrong friend."});var i=!0,n="chat_group_messages_tab_"+t.recipient_id;if($("#"+n+" > li").length>0){i=!1;var s=$("#"+n)[0].scrollHeight}var o=this.friends[t.recipient_id];$("#history_"+t.recipient_id).remove();var r={};r[t.recipient_id]=o,r[this.user_id]={},r[this.user_id].profile_name=this.profile_name,r[this.user_id].profile_picture=this.profile_picture;var a=0,l=0,d=0;if(i)for(var c in t.conversations)t.conversations[c].t-l<this.time_for_message_group&&d===t.conversations[c].s&&0!=l?$("#chat_message_"+a).parent().append(this.message_inside_html(t.conversations[c].id,t.conversations[c].m,t.conversations[c].s,t.conversations[c].t,o)):$("#"+n).append(this.message_html(t.conversations[c].id,t.conversations[c].m,t.conversations[c].s,r[t.conversations[c].s].profile_name,r[t.conversations[c].s].profile_picture,t.conversations[c].t,o)),a=t.conversations[c].id,l=t.conversations[c].t,d=t.conversations[c].s,this.friends[t.recipient_id].last_timestamp=t.conversations[c].t,this.friends[t.recipient_id].last_id_message=t.conversations[c].id,this.friends[t.recipient_id].last_id_sender=t.conversations[c].s;else{first_li=$("#"+n+" > li").first();for(var c in t.conversations)t.conversations[c].t-l<this.time_for_message_group&&d===t.conversations[c].s&&0!=l?$("#chat_message_"+a).parent().append(this.message_inside_html(t.conversations[c].id,t.conversations[c].m,t.conversations[c].s,t.conversations[c].t,o)):$(this.message_html(t.conversations[c].id,t.conversations[c].m,t.conversations[c].s,r[t.conversations[c].s].profile_name,r[t.conversations[c].s].profile_picture,t.conversations[c].t,o)).insertBefore(first_li),a=t.conversations[c].id,l=t.conversations[c].t,d=t.conversations[c].s}var h=this;$("#"+n).prepend('<div id="history_'+t.recipient_id+'"><a class="get_history" href="#">More Conversations<img src="'+e.domains["static"]+'/img/history.png" /></a></div>').find("a.get_history").on("click",function(){h.get_conversation(t.recipient_id,t.conversations[0].t-1,this)}),i?this.scroll_down_conversation(t.recipient_id):$("#"+n).scrollTop($("#"+n)[0].scrollHeight-s),this.set_read_date(t.recipient_id,!0)}},message_html:function(e,i,n,s,o,a,l){l.class_date="",l.class_name="",n===this.user_id?(l.class_li="message_right",l.class_actions="pull-left"):(l.class_li="message_left",l.class_actions="pull-right"),l.class_date="pull-right",l.message_id=e,l.message=i,l.user_id=n,l.user_name=s,l.user_picture=o,l.not_read=n!==this.user_id&&n!=this.selected_friend&&("undefined"==typeof l.last_read||l.last_read<a),l.has_delete=n===this.user_id,l.time=this.format_timestamp(a);var d=$(t.render(r,l)),c=this;return d.find(".remove-message a").on("click",function(t){t.preventDefault(),c.ask_delete_message(e)}),d.find("#chat_message_"+e).on("mouseover",function(){$("#chat_message_"+e+" .remove-message").show()}),d.find("#chat_message_"+e).on("mouseout",function(){$("#chat_message_"+e+" .remove-message").hide()}),d},message_inside_html:function(e,i,n,s,o){n===this.user_id?(o.class_li="message_right",o.class_actions="pull-left"):(o.class_li="message_left",o.class_actions="pull-right"),o.message_id=e,o.message=i,o.user_id=n,o.not_read=n!==this.user_id&&n!=this.selected_friend&&("undefined"==typeof o.last_read||o.last_read<s),o.has_delete=n===this.user_id;var r=$(t.render(a,o)),l=this;return r.find(".remove-message a").on("click",function(t){t.preventDefault(),l.ask_delete_message(e)}),r.on("mouseover",function(){$("#chat_message_"+e+" .remove-message").show()}),r.on("mouseout",function(){$("#chat_message_"+e+" .remove-message").hide()}),r},scroll_down_conversation:function(e){this.log("scroll_down_conversation",e),"undefined"!=typeof $("#chat_group_messages_tab_"+e)[0]&&$("#chat_group_messages_tab_"+e).scrollTop($("#chat_group_messages_tab_"+e)[0].scrollHeight)},set_read_date:function(e,t,i){this.log("set_read_date "+e),0==e&&this.log("id_user = 0"),"undefined"!=typeof this.friends[e].last_read&&("undefined"==typeof this.friends[e].interaction||"undefined"!=typeof this.friends[e].interaction&&this.friends[e].last_read>this.friends[e].interaction)&&this.log("set_read_date","no need ; last read date > last message"),"undefined"!=typeof t&&t!==!1||this.socket_connection.emit("set_read_date",{type:"friend",id:e}),setTimeout(function(){$("#chat_group_messages_tab_"+e).find(".chat_message_status_not_read").remove()},6e3),$("#select_friend_li_"+e+" div.chat_profile_date").removeClass("not_read"),$("#select_friend_li_"+e+" div.chat_profile_date").attr("title","Date of last message");var n=Math.round((new Date).getTime()/1e3);"undefined"!=typeof this.friends[e]&&(this.friends[e].last_read=n,"undefined"!=typeof i&&i!==!1||(total_unread=this.nb_unread_messages_sum-this.friends[e].nb_unread,total_unread<0&&(total_unread=0),this.updateTotalNbUnread(total_unread),this.friends[e].nb_unread=0,this.update_badge(e))),this.serviceWorkerRegistration&&this.serviceWorkerRegistration.postMessage({action:"update_friend_last_read",friend_id:e,friend_last_read:n})},update_badge:function(e){this.log("update_badge",e);var t=0;"undefined"!=typeof this.friends[e]&&"undefined"!=typeof this.friends[e].nb_unread&&(t=this.friends[e].nb_unread),$("#select_friend_li_"+e+" span.badge").remove(),0!==t&&($("#select_friend_li_"+e+"  .chat_status_favorite").prepend('<span class="badge">'+t+"</span>"),this.log("update",t))},updateTotalNbUnread:function(e){var t=parseInt(e);return t!=e||t<0?void this.log("updateTotalNbUnread","bad value for nb_unread : "+e):(console.log("updateTotalNbUnread",t),this.nb_unread_messages_sum=t,this.title.find("span.badge").remove(),void(0!==t&&this.title.append('<span class="badge">'+t+"</span>")))},send_message:function(){return this.log("send message to "+this.selected_friend,this.input.val()),""===this.input.val().trim()?void this.log("send message","textarea empty"):0==this.selected_friend?void this.log("send message","no friend selected"):(this.socket_connection.emit("send_message",{message:this.input.val(),recipient_id:this.selected_friend}),void this.input.val(""))},receive_message:function(e){if(this.log("receive message",e),"undefined"==typeof e.message_id)return void this.log("data.message_id is undefined");if("undefined"==typeof e.sender_id)return void this.log("data.sender_id is undefined");if("undefined"==typeof e.recipient_id)return void this.log("data.recipient_id is undefined");if("undefined"==typeof e.message)return void this.log("data.message is undefined");var t=parseInt(e.recipient_id)===this.user_id?parseInt(e.sender_id):parseInt(e.recipient_id);return"undefined"==typeof this.friends[t]?(this.log("receive message from an unknown friend. Ask for informations for user "+t),void this.socket_connection.emit("getuserinfos",{friend_id:t,callback_obj:{new_message:!0}})):(this.friends[t].interaction=Math.round((new Date).getTime()/1e3),e.sender_id!=this.user_id&&e.sender_id!==this.selected_friend&&($("#select_friend_li_"+t).remove(),this.add_friend(this.friends[t],!0),"undefined"==typeof this.friends[t].nb_unread&&(this.friends[t].nb_unread=0),this.friends[t].nb_unread++,this.update_badge(t),this.updateTotalNbUnread(this.nb_unread_messages_sum+1),0===$("#chat_group_messages_tab_"+t).length)?void this.log("no tab for this friend"):(this.add_message_friend(e.message_id,t,e.sender_id,e.message,Math.round((new Date).getTime()/1e3)),e.sender_id!=this.user_id&&e.sender_id!=this.selected_friend||this.set_read_date(t,!1,!0),void(this.serviceWorkerRegistration&&this.serviceWorkerRegistration.postMessage({action:"update_friend_interaction",friend_id:t,friend_interaction:this.friends[t].interaction}))))},add_message_friend:function(e,t,i,n,s){this.log("add_message_friend",{message_id:e,friend_id:t,sender_id:i,message:n,timestamp:s});var o=$("#chat_group_messages_tab_"+t);if(0===o.length)return void this.log("add_message_friend","No tab for this friend");if("undefined"==typeof this.friends[t])return void this.log("add_message_friend","No informations for this friend");var r=this;i!=this.user_id&&(r=this.friends[i]);var a=o[0],l=Math.abs(a.scrollHeight-a.scrollTop-a.clientHeight)<10;"undefined"!=typeof this.friends[t].last_timestamp&&s-this.friends[t].last_timestamp<this.time_for_message_group&&this.friends[t].last_id_sender===i?$("#chat_message_"+this.friends[t].last_id_message).parent().append(this.message_inside_html(e,n,i,s,r)):o.append(this.message_html(e,n,i,r.profile_name,r.profile_picture,s,r)),this.friends[t].last_timestamp=s,this.friends[t].last_id_message=e,this.friends[t].last_id_sender=i,l&&this.scroll_down_conversation(t)},setuserinfos:function(e){this.log("setuserinfos");var t=!1;"undefined"!=typeof e.callback_obj.new_message&&e.callback_obj.new_message===!0&&(t=!0),"undefined"!=typeof e.callback_obj.open_tab&&e.callback_obj.open_tab===!0&&(t=!0);var i=e.friendlist.shift();this.add_friend(i,t),"undefined"!=typeof e.callback_obj.open_tab&&e.callback_obj.open_tab===!0&&this.select_friend(i.id_user),this.serviceWorkerRegistration&&this.serviceWorkerRegistration.postMessage({action:"add_friend_info",friend_info:i})},addlink_more_friends:function(){this.log("addlink_more_friends");var e=this;this.userlistoffline.append($('<a href="#" class="list-group-item text-center" id="chat_get_more_friends_link">Get more friends</a>').on("click",function(t){t.preventDefault(),e.get_more_friends()}))},get_more_friends:function(){$("#chat_get_more_friends_link").remove(),this.userlistoffline.append('<a id="new_tab_select_spin" class="list-group-item text-center"><img class="load_history" src="'+window.location.protocol+'//static-hw.xvideos.com/v2/img/xv-inline-ajax-loader.gif"></a>');var e=[];for(var t in this.friends_ids)if("undefined"==typeof this.friends[this.friends_ids[t]]&&e.push(this.friends_ids[t]),e.length>=this.nb_friends_get_with_more_link)break;e.length>0&&this.socket_connection.emit("get_users_infos",{friends_ids:e})},send_users_infos:function(e){if(this.log("send_users_infos"),$("#new_tab_select_spin").remove(),"undefined"==typeof e.friendlist)return void this.log("no friendlist");var t=Object.values(e.friendlist);t.sort(function(e,t){return"undefined"==typeof e.interaction&&"undefined"==typeof t.interaction?0:"undefined"==typeof e.interaction?1:"undefined"==typeof t.interaction?-1:e.interaction>t.interaction?-1:t.interaction>e.interaction?1:0});for(var i in t)this.add_friend(t[i]);Object.keys(this.friends).length<this.friends_ids.length&&this.addlink_more_friends(),this.serviceWorkerRegistration&&this.serviceWorkerRegistration.postMessage({action:"add_friends_infos",friendlist:e.friendlist})},ask_delete_message:function(e){confirm("Do you really want to delete this message ?")&&this.emit_delete_message(e)},emit_delete_message:function(e){this.log("emit_delete_message",e),this.socket_connection.emit("delete_message",{message_id:e,recipient_id:this.selected_friend,type:"friend"})},delete_message:function(e){this.log("delete_message",e);var t=$("#chat_message_"+e.message_id);0!==t.length&&(parent=t.parent(),$("#chat_message_"+e.message_id).remove(),0===parent.children().length&&parent.closest("li").remove())},user_online:function(e){"undefined"!=typeof e.id_user&&e.id_user!==this.user_id&&(this.log("user online",e.id_user),
"undefined"!=typeof this.friends&&"undefined"!=typeof this.friends[e.id_user]?(this.friends[e.id_user].is_online=!0,$(".user"+e.id_user).remove(),this.add_friend(this.friends[e.id_user]),this.serviceWorkerRegistration&&this.serviceWorkerRegistration.postMessage({action:"friend_online",friend_id:e.id_user})):this.socket_connection.emit("get_users_infos",{friends_ids:[e.id_user]}))},user_offline:function(e){this.log("user offline",e),"undefined"!=typeof e&&e!==this.user_id&&("undefined"!=typeof this.friends&&"undefined"!=typeof this.friends[e]&&(this.friends[e].is_online=!1,$(".user"+e).remove(),this.add_friend(this.friends[e])),this.serviceWorkerRegistration&&this.serviceWorkerRegistration.postMessage({action:"friend_offline",friend_id:e}))},search_friend:function(){if(1!=this.on_search){var e=this.search_input.val();if(this.log("search_friend",e),e.length<2)return void this.write_error({message:"Please enter at least 2 characters."});this.search_button.attr("disabled",!0),this.on_search=!0,this.socket_connection.emit("search_friends",{search:e})}},found_friends:function(e){if(this.searching_friends=!0,this.log("found_friends",e),this.userlistsearch.empty(),this.userlist.hide(),this.userlistoffline.hide(),this.userlistsearch.show(),this.userlistsearchclose.show(),this.search_button.removeAttr("disabled"),this.on_search=!1,0==e.length)this.userlistsearch.append('<a class="chat_no_friends">No friends found</a>');else{this.userlistsearch.append('<a class="chat_no_friends">'+e.length+" friends found</a>");for(var t in e)friend=e[t],this.userlistsearch.append(this.add_friend_html(friend,!0))}},hide_search_list:function(){this.userlistsearch.hide(),this.userlistsearchclose.hide(),this.userlist.show(),this.userlistoffline.show()},switch_sound:function(e){0===this.inputsound.length&&this.log("switch sound : unable to get checkbox"),this.log("switch sound to "+this.inputsound[0].checked),this.sound=this.inputsound[0].checked,this.emit_change_prefs(this.sound,this.notif)},switch_notif:function(){if(0===this.inputnotif.length&&this.log("switch sound : unable to get checkbox"),!this.inputnotif[0].checked)return this.log("switch notif to "+this.inputnotif[0].checked),this.notif=!1,void this.emit_change_prefs(this.sound,this.notif);if(!this.notif_allowed)return void this.write_error({message:"Your browser doesn't support HTML5 notifications"});if("denied"===Notification.permission)return this.write_error({message:"You refused to use the notification. You can change this permission in your browser."}),void(this.inputnotif[0].checked=!1);if("default"===Notification.permission){this.log("asking for desktop notification permission");var e=this;return void Notification.requestPermission(function(t){"granted"===t?(e.log("switch notif to true"),e.notif=!0,e.inputnotif[0].checked=e.notif,e.emit_change_prefs(e.sound,e.notif)):e.inputnotif[0].checked=!1})}this.log("switch notif to true"),this.notif=!0,this.inputnotif[0].checked=this.notif,this.emit_change_prefs(this.sound,this.notif)},emit_change_prefs:function(e,t){"undefined"!=typeof this.socket_connection&&this.socket_connection.emit("change_prefs",{sound:e,notif:t,hexavid_login:i.get("HEXAVID_LOGIN")})},set_change_prefs:function(e){this.log("set_change_prefs",e),"undefined"!=typeof e.prefs&&("undefined"!=typeof e.prefs.sound&&(this.sound=1==e.prefs.sound,this.inputsound[0].checked=this.sound),"undefined"!=typeof e.prefs.notif&&this.notif_allowed&&"granted"===Notification.permission&&(this.notif=1==e.prefs.notif,this.inputnotif[0].checked=this.notif)),"undefined"!=typeof e.cookie&&(this.log("set cookie"),i.set("HEXAVID_LOGIN",e.cookie))},removeServiceWorker:function(){this.log("removeServiceWorker"),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(e){for(var t in e)e[t].unregister()}),this.service_worker_register=!1},setSwToken:function(e){this.sw_token=e,this.socket_connection.emit("SW_token",{token:e}),i.setLocal("chat_sw_token",e,864e6,"/")},key_pressed:function(e){this.log("key pressed"),e.which=e.which||e.keyCode,13==e.which&&this.send_message(e)},search_key_pressed:function(e){this.log("key pressed"),e.which=e.which||e.keyCode,13==e.which&&this.search_friend()},format_timestamp:function(e){var t=new Date(1e3*e),i=new Date,n="";return t.getDate()!=i.getDate()&&(n+=this.format_date_number(t.getMonth()+1)+"/"+this.format_date_number(t.getDate())+" "),n+=this.format_date_number(t.getHours())+":"+this.format_date_number(t.getMinutes())},format_date_number:function(e){return e<=9?"0"+e:e},write_error:function(e){this.log("ERROR",e),this.modal("Error","<p>"+e.message+"</p>")},write_message:function(e){this.log("MESSAGE",e),this.modal("Message","<p>"+e.message+"</p>")},modal:function(e,t){this.overlay||(this.overlay=n.get(this.node.children(".overlay-container"),!0,"hide")),this.overlay.setContent("<h3>"+e+"</h3>"+t).show()},log:function(e,t){this.debug&&("undefined"==typeof t?console.log("CHAT: "+e):console.log("CHAT: "+e,t))}},new d(!0)})}),require.config({waitSeconds:90,paths:{jquery:"jquery",text:"text",firebase:"libs/firebase"},shim:{json3:{exports:"JSON"},firebase:{exports:"firebase"}},config:{text:{useXhr:function(e,t,i,n){if("/"===e.substr(0,1))return!0;if(e.match(/^https?:\/\/static[\w-]*\.xvideos\.com\/.*$/))return!0;var s=t+"://"+i;return e.substr(0,s.length)===s}}}}),define("static/utils",window.xv.utils),define("static/cookies",window.xv.cookies),define("static/thumbs",window.xv.thumbs),require.defined("config/ads")||define("config/ads",window.xv.conf.ads||{}),require(["lib/sda"]),require(["respond"]),require(["config/main","lib/helpers/dom","static/cookies","lib/helpers/inline_loader"],function(e,t,i,n){n.setup(e.domains["static"]+"/v3/img/skins/default/xv-inline-loader.gif"),e.data.action&&require(["skins/"+e.sitename+"/"+e.data.action]),require(["skins/default/common"]);var s=$("#mobile-login-btn");if(s.length>0){var o=!1,r=s.offset(),a=$("#mobile-login-menu").css("top",r.top+s.outerHeight()+parseInt(s.css("margin-bottom").replace("px",""))+"px");s.on("click",function(e){e.preventDefault(),a.toggleClass("hidden"),o=!o}),a.on("menu.forceclose",function(){o&&(a.addClass("hidden"),o=!1)}),$("body").on("click",function(e){o&&($(e.target).closest("#mobile-login-menu,#mobile-login-btn").length>0||(a.addClass("hidden"),o=!1))})}var l=$("#page-go-up");if(l.length>0){l.on("click",function(){t.scrollToTop()});var d,c=!1,h=$(window),u=function(){d=null;var e=h.scrollTop()>t.getViewportHeight()/3;e!==c&&(l.toggleClass("displayed",e),c=e)};h.on("scroll",function(){d||(d=window.setTimeout(u,500))}),u()}e.data.login_info.is_logged&&e.data.login_info.profile&&(i.get("hexavid_lastsubscheck")||($.getJSON("/my-subs/videos/update-count",function(e){if(e.result){var t=$("#home-tabs .mysubs .navbadge,#mobile-filters-menu .nb-new-video-subs-badge,#mobile-login-menu .nb-new-video-subs-badge");0===e.nb_subs?t.remove():0===t.length?($("#home-tabs .mysubs").append('<span class="navbadge">'+e.formatted+"</span>"),$("#mobile-filters-menu .my-subs-nav-link,#mobile-login-menu .my-subs-nav-link").append('&nbsp;<span class="navbadge nb-new-video-subs-badge">'+e.formatted+"</span>")):t.text(e.formatted)}}),i.setLocal("hexavid_lastsubscheck","1",3e5,"/")),require(["skins/default/chat/manager"]))}),define("skins/default",function(){}),define("text!skins/default/profile/vote/light.html",[],function(){return'<div class="rating-box-light">\n\t<span class="vote-actions">\n\t\t<span class="vote-action-good"><span class="icon thumb-up white">&nbsp;</span></span><span class="vote-action-bad"><span class="icon thumb-down white">&nbsp;</span></span>\n\t</span>\n\t<span class="rating">{{ rating }}</span> (<span class="total">{{ vtotal }}</span>)\n\t<div class="rating-bar"><div style="width:{{ vrating }}%;"></div></div>\n</div>'}),define("skins/default/profile/vote/light",["config/main","mustache","lib/tools","text!./light.html","lib/helpers/inline_loader","lib/helpers/popup","lib/helpers/overlay/box","lib/i18n!front"],function(e,t,i,n,s,o,r,a){var l=function(e,i,s,o,r,a,l){if("undefined"!=typeof e){this.vtotal=o,this.vrating=i,this.rating=s,this.visitor_vote=!1,"undefined"==typeof r||"GOOD"!==r&&"BAD"!==r||(this.visitor_vote=r),this.login_required="boolean"==typeof a&&a,this.login_container=l,this.node=$(t.render(n,this._get_tpl_vars())),e.replaceWith(this.node),this.actions=this.node.children(".vote-actions"),this.yes_btn=this.actions.children(".vote-action-good"),"GOOD"===this.visitor_vote&&this.yes_btn.addClass("disabled"),this.no_btn=this.actions.children(".vote-action-bad"),"BAD"===this.visitor_vote&&this.no_btn.addClass("disabled"),this.bar_good=this.node.find(".rating-bar div"),this.bar_rating=this.node.children(".rating"),this.total=this.node.find(".total"),this._init_counts();var d=this;this.voting=!1,this.popup=null,this.popup_pos={v:"below",h:"left"},this.yes_btn.on("click",function(){d._vote("GOOD")}),this.no_btn.on("click",function(){d._vote("BAD")})}};return l.prototype={initPostData:function(e,t,i){this.url_good=e,this.url_bad=t,this.post_data=i||{}},setPopupPosition:function(e,t){this.popup_pos.v=e,this.popup_pos.h=t},_init_counts:function(){this.counts_total=this.node.find(".total")},_get_tpl_vars:function(){return{vtotal:this.vtotal,rating:this.rating,vrating:this.vrating}},_update_counts:function(e){this.bar_rating.text(e.vrating),this.total.text(e.total),this.bar_good.css("width",e.rating+"%")},_get_popup:function(e,t){return this.popup?this.popup.setButton(e).setContent(t):this.popup=new o(e,t,{relative_to:this.node.parent(),position:this.popup_pos,trigger:!1}),this.popup},_open_login:function(){require(["skins/default/form/login_create"],function(e){e.open()})},_vote:function(t){if("GOOD"!==t&&"BAD"!==t)return!1;if(t===this.visitor_vote)return!0;if(this.voting)return!1;if(this.login_required&&!e.data.login_info.is_logged)return this._open_login(),!1;var i=this,n="GOOD"===t?this.yes_btn:this.no_btn,o=n.html(),r="GOOD"===t?this.url_good:this.url_bad;this.yes_btn.addClass("disabled"),this.no_btn.addClass("disabled"),n.html(s.getImg()),$.post(r,this.post_data,function(e){var s;e.result?(i._update_counts(e),i.visitor_vote=t,s="<strong>"+a.__("video.votes.thanks")+"</strong>"):s='<strong class="text-danger">'+e.message+"</strong>",i._get_popup(n,s).open()},"json").fail(function(){i._get_popup(n,'<strong class="text-danger">'+a.__("error.err_please_reload")+"</strong>").open()}).complete(function(){n.html(o),i.voting=!1,i.yes_btn.toggleClass("disabled",!e.data.login_info.is_logged||"GOOD"===i.visitor_vote),i.no_btn.toggleClass("disabled",!e.data.login_info.is_logged||"BAD"===i.visitor_vote)})}},l}),define("text!skins/default/profile/action/link/captcha.html",[],function(){return'<p>{{{ labels.ip_not_trusted }}}</p>\n<div id="prof-recaptcha">{{{ loader }}}</div>\n<p>{{{ labels.verifiy_to_trust }}}</p>'}),define("skins/default/profile/action/link",["config/main","mustache","static/utils","lib/tools","lib/helpers/popup","lib/helpers/inline_loader","lib/i18n!front","text!./link/captcha.html"],function(e,t,i,n,s,o,r,a){var l,d,c,h=null,u=function(){return null===h&&(h=e.data.visitor.trusted),h},f=function(i){if(l)i!==c&&(c.enable(),l.setButton(i.link));else{var h=function(){d=$("#prof-recaptcha").empty();var t=grecaptcha.render(d.get(0),{sitekey:e.data.recaptcha_key,callback:function(e){l.close(),c.trigger(e),grecaptcha.reset(t)}})},u={labels:r.__("profile.captcha.*",{"%verif_link_start%":'<a href="'+e.domains.master+'/account/verify_account">',"%verif_link_end%":"</a>"}),loader:o.get("after",r.__("loading.loading"),"prof-recaptcha-loading").getHtml()};l=new s(i.link,t.render(a,u),{trigger:!1,popup_class:"prof-link-captcha"}),l.onClose=function(){c.enable()},n.loadRecaptcha(h,e.dyn.locale)}c=i,c.disable(),l.open()},p=function(e,t,i,n,s){if("undefined"!=typeof e){this.link=e,this.setAction(t,i,n,s),this.enabled=!0,this.posting=!1,this.error_popup=!1;var o=this;e.on("click",function(e){return e.preventDefault(),o.trigger()})}};return p.prototype={validate:null,getPost:function(){return{}},onSuccess:null,setAction:function(e,t,i,n){this.url=e,this.confirm=t,this.is_confirmed=!t,this.check_trusted=!!i,this.csrf_token=n||!1},setLoadingMessage:function(e){this.loading_msg=e},_is_confirmed:function(){if(this.is_confirmed)return!0;var e="string"==typeof this.confirm?this.confirm:r.__("misc.are_you_sure");return!!window.confirm(i.unescape(e))&&(this.is_confirmed=!0,!0)},_is_trusted:function(){return!this.check_trusted||(!!u()||(this.clearError(),f(this),!1))},enable:function(){this.enabled||this.posting||(this.enabled=!0,this.link.removeClass("disabled"))},disable:function(){this.enabled&&(this.enabled=!1,this.link.addClass("disabled"))},toggle:function(e){e?this.enable():this.disable()},showError:function(e){var t=this;this.error_popup?(this.error_popup.setContent("<strong>"+e+"</strong>"),this.error_popup.open()):(this.error_popup=new s(this.link,"<strong>"+e+"</strong>",{trigger:!1,autoclose:!1,closebtn:!0,popup_class:"profile-action-link-popup"}),this.error_popup.open(),this.error_popup.popup.on("click",function(){t.error_popup.close()}))},clearError:function(){this.error_popup&&this.error_popup.close()},trigger:function(e){if(this.enabled&&!this.posting&&this._is_confirmed()&&("function"!=typeof this.validate||this.validate())&&("string"==typeof e||this._is_trusted())){this.clearError(),this.posting=!0,this.disable();var t=this.link.html(),i=o.get("after","undefined"==typeof this.loading_msg?r.__("loading.in_progress"):this.loading_msg).appendTo(this.link.empty()),n=this,s=this.getPost();"string"==typeof e&&(s["g-recaptcha-response"]=e),this.csrf_token&&(s.csrf=this.csrf_token),$.post(this.url,s,function(e){return i.remove(),n.link.html(t),n.posting=!1,n.enable(),e.result?void("function"==typeof n.onSuccess&&n.onSuccess(e)):void n.showError("string"==typeof e.message?e.message:r.__("misc.error_please_retry"))},"json").fail(function(){i.remove(),n.link.html(t),n.posting=!1,n.enable(),n.showError(r.__("misc.error_please_retry"))})}}},p}),define("skins/default/features_test/tracker",["static/cookies"],function(e){var t=94608e6,i=function(e,t){return e.time===t.time?0:e.time>t.time?-1:1},n=function(){return Math.round((new Date).getTime()/1e3)},s=function(e,t){this.cookie_name=e,this.max_elements=t};return s.prototype={isTracking:function(){return"disabled"!==e.get(this.cookie_name+"_tracking")},stopTracking:function(){e.setLocal(this.cookie_name+"_tracking","disabled",t,"/"),e.setLocal(this.cookie_name,"",!1,"/")},startTracking:function(){e.setLocal(this.cookie_name+"_tracking","",!1,"/")},getIds:function(){var t=[],n=e.get(this.cookie_name);if("string"!=typeof n||0===n.length)return t;n=n.split(";");var s=parseInt(n.shift());if(isNaN(s)||s<1474287991)return t;for(var o in n)if(o=n[o].split(":"),2===o.length){var r={};r.time=parseInt(o[1]),isNaN(r.time)||r.time<0||(r.time+=s,r.id=parseInt(o[0]),isNaN(r.id)||r.id<=0||t.push(r))}return t.sort(i),t.length>this.max_elements&&(t=t.slice(0,this.max_elements-1)),t},addId:function(e){if(this.isTracking()){var t=this.getIds(),i=!1;for(var s in t)if(t[s].id===e){t[s].time=n(),i=!0;break}i||(t.unshift({id:e,time:n()}),t.length>this.max_elements&&(t=t.slice(0,this.max_elements-1))),this._write(t)}},removeId:function(e){if(this.isTracking()){var t=this.getIds();for(var i in t)if(t[i].id===e)return t.splice(i,1),void this._write(t)}},hasId:function(e){if(!this.isTracking())return!1;var t=this.getIds();for(var i in t)if(t[i].id===e)return!0;return!1},getTime:function(e){if(!this.isTracking())return!1;var t=this.getIds();for(var i in t)if(t[i].id===e)return t[i].time;return!1},clear:function(){e.setLocal(this.cookie_name,"",!1,"/")},_write:function(i){var n=i.length>0?i[i.length-1].time-3600:0,s=[n];for(var o in i)s.push(i[o].id+":"+(i[o].time-n));e.setLocal(this.cookie_name,s.join(";"),t,"/")}},s}),define("skins/default/features_test/video_subs",["./tracker"],function(e){var t,i=function(){return t||(t=new e("test_video_subs",500)),t},n=function(){};return n.prototype={isTracking:function(){return i().isTracking()},stopTracking:function(){i().stopTracking()},startTracking:function(){i().startTracking()},subscribe:function(e){i().addId(e)},unsubscribe:function(e){i().removeId(e)},hasSubscribed:function(e){return i().hasId(e)}},new n}),define("skins/default/profile/subscribe",["config/main","static/utils","lib/helpers/popup","lib/i18n!front"],function(e,t,i,n){var s=function(e){this.node=$(e),this.is_square=this.node.hasClass("video-subscribe-square"),this.has_label=this.node.find(".label").length>0,this.msg_popup};s.prototype={setLabel:function(e){if(this.has_label)return void this.node.children(".label").html(e).find("a").on("click",function(e){e.stopPropagation()});this.node.is(":visible")&&(this.msg_popup?this.msg_popup.setContent("<strong>"+e+"</strong>"):this.msg_popup=new i(this.node,"<strong>"+e+"</strong>",{trigger:!1}),this.msg_popup.open());var n=e.indexOf("<a");n!==-1&&(e=e.substring(0,n)),this.node.prop("title",t.unescape(e)),this.node.find(".icon").toggleClass("feed-subscribed feed red")},hidePopup:function(){this.msg_popup&&this.msg_popup.close()}};var o=function(e,t,i,n,o){this.nodes=e.map(function(){return new s(this)}).toArray(),this.profile=t,this.id_user=i,this.subscriber=n,this.csrf=o,this.setup()};return o.prototype={onSubscribe:null,onUnsubscribe:null,setLabel:function(e){for(var t in this.nodes)this.nodes[t].setLabel(e)},setOnClick:function(e){for(var t in this.nodes)this.nodes[t].node.on("click",e)},setOffClick:function(){for(var e in this.nodes)this.nodes[e].node.off("click")},setProp:function(e,t){for(var i in this.nodes)this.nodes[i].node.prop(e,t)},hidePopup:function(){for(var e in this.nodes)this.nodes[e].hidePopup()},setup:function(){var t=this,i="/profiles/"+this.profile+"/";return e.data.login_info.is_logged&&e.data.login_info.profile?void require(["skins/default/profile/action/link"],function(e){var s=t.subscriber?"unsubscribe":"subscribe";for(var o in t.nodes){var r=new e(t.nodes[o].node,i+"followers/"+s,"unsubscribe"===s,"subscribe"===s,t.csrf);r.setLoadingMessage(""),r.onSuccess=function(){t.setLabel("subscribe"===s?n.__("subscriptions.subscribed")+' <a href="/my-subs/videos">'+n.__("subscriptions.view_activities")+"</a>":n.__("subscriptions.unsubscribed")),t.subscriber=!t.subscriber,s=t.subscriber?"unsubscribe":"subscribe",r.setAction(i+"followers/"+s,"unsubscribe"===s,"subscribe"===s,t.csrf),t.subscriber&&t.onSubscribe&&t.onSubscribe(),!t.subscriber&&t.onUnsubscribe&&t.onUnsubscribe()}}}):void require(["skins/default/features_test/video_subs"],function(s){s.isTracking()?(t.setOffClick(),t.setOnClick(function(e){e.preventDefault(),s.hasSubscribed(t.id_user)?(s.unsubscribe(t.id_user),t.setLabel(n.__("subscriptions.unsubscribed")),$.post(i+"followers/unsubscribe"),t.onUnsubscribe&&t.onUnsubscribe()):(s.subscribe(t.id_user),t.setLabel(n.__("subscriptions.subscribed")+' <a href="/my-subs/videos">'+n.__("subscriptions.view_activities")+"</a>"),$.post(i+"followers/subscribe"),t.onSubscribe&&t.onSubscribe())})):t.profile?t.setProp("href",e.domains.master+"/account/?redirect="+encodeURIComponent(window.location.href)):t.setProp("href",e.domains.master+"/account/create_profile")})}},o}),define("skins/common/search/autocomplete",["config/main","mustache","lib/tools","lib/converter","lib/i18n!front","jquery-scrollLock"],function(e,t,i,n,s){var o=["KEYWORDS","PORNSTAR","CHANNEL"],r=function(e,t,i,n,s){this.relative=i,this.input=t.prop("autocomplete","off"),this.tpl=n,this.opened=!1,this.autocomplete=$("<div>").addClass("search-autocomplete").appendTo(e.css("position","relative")).hide().scrollLock({unblock:"ul"}),this.source_url=s,this.has_results=!1,this.results={},this.time_btw_searchs=200,this.timer,this.last_time=0,this.cur_search=!1,this.last_search=!1,this.cur_keywords=!1,this.searches=[],this.max_searchs=3,this.has_scroll_height="undefined"!=typeof $("body")[0].scrollHeight,this.max_height=0,this.selected=!1,this.res_selected=0,this.is_keyboard_nav=!1;var o=this;this.input.on("keydown",function(e){o.on_tab_input(e)}).on("keyup paste",function(e){o.on_char_input(e)}).on("blur",function(){setTimeout(function(){o.close()},300)}).on("focus",function(){o.search()}),$(window).on("resize",function(){o.resize()})};return r.prototype={open:function(){this.opened||(this.autocomplete.show(),this.resize(),this.opened=!0)},close:function(){this.opened&&(this.autocomplete.hide(),this.opened=!1)},resize:function(){var e=n.trimPx(this.input.css("border-left-width")),t=n.trimPx(this.input.css("padding-left")),i=n.trimPx(this.input.css("padding-left")),s=this.relative.offset(),o=this.input.offset(),r=this.input.outerHeight(),a=o.top-s.top+r+1,l=o.left-s.left,d=this.relative.outerWidth()-l,c=this.input.width()+i+t+2*e;this.lpadding={left:t+e+"px",right:i+e+"px"},this.autocomplete.css({top:a+"px",left:l+"px"}),d<=c?this.autocomplete.css("width",d+"px"):this.autocomplete.css({minWidth:Math.min(d,Math.max(c,Math.min(d,300)))+"px",maxWidth:d+"px"}),this.max_height=$(window).height()-(o.top+s.top+r+1),this.resizeResults()},resizeResults:function(){if(this.has_scroll_height&&this.has_results){if(this.max_height<768)return this.autocomplete.children(".title").hide(),this.autocomplete.children("ul").css("maxHeight","none"),void this.autocomplete.css({maxHeight:this.max_height-4+"px",overflowY:"auto"});this.autocomplete.css({maxHeight:"none",overflowY:"hidden"});var e=0,t=0,i=[];this.autocomplete.children().each(function(){var n=$(this);if(n.hasClass("title"))return n.show(),void(e+=n.outerHeight(!0));var s={e:n,h:n[0].scrollHeight};t+=s.h,i.push(s)});var n=Math.max(this.max_height-e-4,140*i.length);do{var s=i.length,o=0;for(var r in i){var a=n/s;a>=i[r].h&&(i[r].e.css("maxHeight","none"),o+=i[r].h,i.splice(r,1))}n-=o,t-=o}while(i.length<s);for(var r in i){var a=n/i.length;i[r].e.css("maxHeight",a+"px")}}},getSearch:function(){return $.trim(this.input.val()).replace(/[\s\/]+/," ")},search:function(e){if("undefined"==typeof e?(this.last_search===!1&&(this.last_search=this.getSearch()),e=this.last_search):this.last_search=e,this.cur_keywords===e)return void(this.has_results&&this.open());if(this.cur_search!==e){if("undefined"!=typeof this.results[e])return void this.display(e);if(0===e.length)return this.results[""]={KEYWORDS:[],PORNSTAR:[],CHANNEL:[]},void this.display("");if(!this.timer){var t=this,i=(new Date).getTime(),n=i-this.last_time;if(n<this.time_btw_searchs)return void(this.timer=window.setTimeout(function(){t.timer=null,t.search()},this.time_btw_searchs-n));this.searches.length===this.max_searchs&&this.searches.shift().abort(),this.last_time=i,this.searches.push($.getJSON(this.source_url+"/"+encodeURIComponent(e),function(i){"object"!=typeof i.KEYWORDS&&(i.KEYWORDS=[]),"object"!=typeof i.PORNSTAR&&(i.PORNSTAR=[]),"object"!=typeof i.CHANNEL&&(i.CHANNEL=[]);for(var n in o){var s=o[n];for(var r in i[s]){var a=i[s][r];if("KEYWORDS"!==s)"https:"===window.location.protocol&&(i[s][r].P=a.P.replace("http://","https://")),"number"==typeof a.M?(i[s][r].highlight=!0,i[s][r].t1=a.N.toString().substr(0,a.M),i[s][r].t2=a.N.toString().substr(a.M,a.L),i[s][r].t3=a.N.toString().substr(a.M+a.L)):i[s][r].highlight=!1;else{var l=a.N.toString().toLowerCase().indexOf(e.toLowerCase());l===-1?i[s][r].highlight=!1:(i[s][r].highlight=!0,i[s][r].t1=a.N.toString().substr(0,l),i[s][r].t2=a.N.toString().substr(l,e.length),i[s][r].t3=a.N.toString().substr(l+e.length))}}}for(var r in i.PORNSTAR)i.PORNSTAR[r].model=0===i.PORNSTAR[r].R||i.PORNSTAR[r].R>1e3;t.results[e]=i,t.last_search===e&&t.display(e)}).fail(function(){t.results[e]={KEYWORDS:[],PORNSTAR:[],CHANNEL:[]},t.last_search===e&&t.display(e)}).always(function(){t.cur_search===e&&(t.cur_search=!1,t.timer&&(window.clearTimeout(t.timer),t.timer=null))}))}}},display:function(e){this.cur_keywords=e;var i=this.results[e];return 0===i.KEYWORDS.length&&0===i.PORNSTAR.length&&0===i.CHANNEL.length?(this.selected=!1,this.has_results=!1,void this.close()):(this.has_results=!0,this.open(),this.selected=$(t.render(this.tpl,{results:i,has_keywords:i.KEYWORDS.length>0,has_pornstars:i.PORNSTAR.length>0,has_channels:i.CHANNEL.length>0,padding:this.lpadding,lbl_world:s.__("misc.world"),lbl_model:s.__("profile.model"),lbl_pss:s.__("profile.pornstars_models_camgirls"),lbl_chans:s.__("profile.channels"),lbl_suggestions:s.__("video.suggestions"),uri:function(){return function(e,t){return encodeURIComponent(t(e))}}})).appendTo(this.autocomplete.empty()).filter("ul").first().scrollTop(0).children("li").first().addClass("selected"),this.res_selected=0,void this.resizeResults())},on_tab_input:function(e){9===e.which&&this.has_results&&(e.preventDefault(),this.selected&&(window.location.href=this.selected.children("a").prop("href")))},on_char_input:function(e){if(38===e.which||40===e.which){if(!this.has_results)return;if(this.is_keyboard_nav=!0,38===e.which){if(0===this.res_selected)return;this.res_selected--}else{var t=this.results[this.cur_keywords];if(this.res_selected===t.KEYWORDS.length+t.PORNSTAR.length+t.CHANNEL.length-1)return;this.res_selected++}return this.selected.removeClass("selected"),this.selected=this.autocomplete.children("ul").children("li").eq(this.res_selected).addClass("selected"),void this.selected.parent().scrollTop(this.selected.parent().scrollTop()+this.selected.position().top-20)}if(13===e.which&&this.has_results&&this.is_keyboard_nav&&this.selected)return e.preventDefault(),void(window.location.href=this.selected.children("a").prop("href"));if(this.is_keyboard_nav=!1,"paste"===e.type){"object"==typeof e.originalEvent.clipboardData&&"function"==typeof e.originalEvent.clipboardData.getData&&this.search(e.originalEvent.clipboardData.getData("text"));var i=this;return void window.setTimeout(function(){i.search(i.getSearch())},50)}this.search(this.getSearch())}},function(t,i,n){if("string"==typeof e.dyn.ip&&e.dyn.ip.indexOf(".")!==-1){var s="/search-suggest";!e.dyn.pagefilter||"gay"!==e.dyn.pagefilter&&"shemale"!==e.dyn.pagefilter||(s+="/"+e.dyn.pagefilter);var o=$("header input.search-input").filter("[name='k']");if(o.is(":focus"))return new r(t,o,i||t,n,s),void o.trigger("focus");document.activeElement&&"BODY"===document.activeElement.tagName&&o.is(":visible")&&o.focus(),o.on("keyup keydown focus",function(e){o.off("keyup keydown focus"),new r(t,o,i||t,n,s),o.trigger(e)})}}}),define("text!skins/default/search/autocomplete.html",[],function(){return'{{#has_keywords}}\n<div class="title" style="padding-left:{{padding.left}};padding-right:{{padding.right}}">{{{lbl_suggestions}}}</div>\n<ul class="keywords">\n\t{{#results.KEYWORDS}}\n\t<li style="padding-left:{{padding.left}};padding-right:{{padding.right}}">\n\t\t<a href="/?k={{#uri}}{{{N}}}{{/uri}}&top">\n\t\t\t<span class="nbres">{{R}}</span>\n\t\t\t<span class="keywords">{{#highlight}}{{t1}}<span class="highlighted">{{t2}}</span>{{t3}}{{/highlight}}{{^highlight}}{{N}}{{/highlight}}</span>\n\t\t</a>\n\t</li>\n\t{{/results.KEYWORDS}}\n</ul>\n{{/has_keywords}}\n{{#has_pornstars}}\n<div class="title" style="padding-left:{{padding.left}};padding-right:{{padding.right}}">{{{lbl_pss}}}</div>\n<ul class="pornstars">\n\t{{#results.PORNSTAR}}\n\t<li style="padding-left:{{padding.left}};padding-right:{{padding.right}}">\n\t\t<a href="/profiles/{{{F}}}">\n\t\t\t<span class="thumb" style="background-image:url(\'{{{P}}}\')"></span>\n\t\t\t<span class="name">{{#highlight}}{{t1}}<span class="highlighted">{{t2}}</span>{{t3}}{{/highlight}}{{^highlight}}{{N}}{{/highlight}}</span>\n\t\t\t<span class="rank"><span class="rank-type">{{#model}}M{{/model}}{{^model}}P{{/model}}</span>{{#RF}}#<span class="rank-pos">{{RF}}</span>{{/RF}}</span>\n\t\t</a>\n\t</li>\n\t{{/results.PORNSTAR}}\n</ul>\n{{/has_pornstars}}\n{{#has_channels}}\n<div class="title" style="padding-left:{{padding.left}};padding-right:{{padding.right}}">{{{lbl_chans}}}</div>\n<ul class="pornstars">\n\t{{#results.CHANNEL}}\n\t<li style="padding-left:{{padding.left}};padding-right:{{padding.right}}">\n\t\t<a href="/profiles/{{{F}}}">\n\t\t\t<span class="thumb" style="background-image:url(\'{{{P}}}\')"></span>\n\t\t\t<span class="name">{{#highlight}}{{t1}}<span class="highlighted">{{t2}}</span>{{t3}}{{/highlight}}{{^highlight}}{{N}}{{/highlight}}</span>\n\t\t\t<span class="rank"><span class="rank-type">C</span>{{#RF}}#<span class="rank-pos">{{RF}}</span>{{/RF}}</span>\n\t\t</a>\n\t</li>\n\t{{/results.CHANNEL}}\n</ul>\n{{/has_channels}}'}),define("skins/default/search/autocomplete",["skins/common/search/autocomplete","text!./autocomplete.html"],function(e,t){e($("#page"),$("#header .white-stripe"),t)}),define("skins/default/favorite",["config/main","./profile/vote/light","./profile/subscribe","lib/helpers/thumbs_rotator","./search/autocomplete"],function(e,t,i){if("undefined"!=typeof e.data.fav_list){var n=e.data.fav_list,s=new t($("#fav-list-votes"),n.rating,n.vrating,n.total,n.visitor_vote);s.initPostData("/favorite/vote/"+n.id_list+"/"+n.id_user+"/GOOD","/favorite/vote/"+n.id_list+"/"+n.id_user+"/BAD",{csrf:n.csrf});var o=$(".user-subscribe");o.length>0&&new i(o,e.data.user.username,e.data.user.id_user,e.data.visitor.subscriber,e.data.user.csrf.sub||"")}}),define("skins/default/http_status",["./search/autocomplete"],function(){}),define("skins/default/langidx",["./search/autocomplete"],function(){}),define("text!skins/default/search/cats_trends_countries.html",[],function(){return'<ul>\n{{#countries}}\n{{#c}}<li class="country-{{ c }}"><a><span class="flag-small flag-{{ c }}"></span> {{ n }}</a></li>{{/c}}\n{{^c}}<li><span class="no-country">&nbsp;</span></li>{{/c}}\n{{/countries}}\n</ul>'}),define("skins/default/search/trends",["config/main","mustache","lib/tools","static/cookies","lib/helpers/overlay/box","lib/helpers/popup","lib/helpers/inline_loader","text!./cats_trends_countries.html","lib/i18n!front"],function(e,t,i,n,s,o,r,a,l){var d=$("#home-trends");if(0!==d.length){var c,h,u=d.children("a").not(".label,.view-more,.country-switch"),f=d.children(".view-more"),p=!1,g=d.children(".country-switch"),_=g.data("country"),v=!1,m=function(){if(!p){var e,t=u.first().offset().top,i=0;return u.each(function(){var n=$(this).offset().top;return t===n?void(e=$(this)):(i++,t=n,i<=1&&void 0)}),e?(f.show().insertAfter(e).before(document.createTextNode(" ")),0===f.next().length?void f.hide():void(f.offset().top===t&&f.insertBefore(e).after(document.createTextNode(" ")))):void f.hide()}};if(m(),$(window).on("resize",m),f.on("click",function(){p=!p,d.css("height",p?"auto":""),f.html(p?"-":"+"),p?(d.append(f),f.before(document.createTextNode(" "))):m()}),0!==g.length){var b=function(e){h?h.setContent(e):h=new o(g,e,{relative_to:$("#main"),position:{v:"below",h:"left"},trigger:!1}),h.open()};g.on("click",function(o){if(o.preventDefault(),o.stopPropagation(),c)return c.show(),void(h&&h.close());var y=$(t.render(a,{countries:g.data("countries")})).on("click","a",function(t){if(t.preventDefault(),t.stopPropagation(),!v){v=!0;var s=$(this).parent(),o=s.attr("class").substr(8);if(o!==_){c.hide(),g.children().hide();var a=$(r.getImg());g.append(a),h&&h.close(),$.getJSON("/local-trends/"+e.dyn.trends.filter+"/"+o.toUpperCase(),function(e){return 0===e.trends.length?void b("<p>"+l.__("listing.no_trends_in_country")+"</p>"):(n.setLocal("hexavid_trends_country",o,2592e6,"/"),u.remove(),u=d.append(e.trends).append(f).children("a").not(".label,.view-more,.country-switch"),y.children(".country-"+_).removeClass("disabled"),s.addClass("disabled"),g.children(".flag-small").removeClass("flag-"+_).addClass("flag-"+o),g.prev().prop("title",e.tooltip),_=o,p&&(p=!1,d.css("height",""),f.html("+")),void m())}).fail(function(){b($("<a>"+l.__("loading.failed_retry")+"</a>").on("click",function(){s.children("a").click()}))}).always(function(){v=!1,a.remove(),g.children().show(),d.offset().top<$("body").scrollTop()&&i.scrollTo(d)})}}});y.children(".country-"+_).addClass("disabled"),c=new s("#page",!0,"hide"),c.setClosable(!0,!0),
c.addClass("popup-trends-countries"),c.setContent(y),c.show()})}}}),define("skins/default/search/categories",["config/main","mustache","static/cookies","lib/helpers/overlay/box","lib/helpers/popup","lib/helpers/inline_loader","text!./cats_trends_countries.html","lib/i18n!front"],function(e,t,i,n,s,o,r,a){var l=$("#main .main-categories");if(0!==l.length){var d=l.find("a.view-more").parent();if(0!==d.length){var c=l.find(".topterm"),h=c.first().outerHeight(!0),u=l.find(".country-switch"),f=!1,p=function(){if(c.show(),d.hide(),0!==c.length&&!(c.last().position().top<2*h-1||(d.show(),f)))for(var e=20;e>0;e--)if(c.filter(".topterm-"+e).hide(),d.position().top<2*h-1)return};p(),$(window).on("resize",p);var g=d.children("a").on("click",function(){f=!f,g.html(f?"-":"+"),p()});if(0!==u.length){var _,v,m=u.data("country"),b=!1,y=function(e){_?_.setContent(e):_=new s(u,e,{relative_to:$("#main"),position:{v:"below",h:"left"},trigger:!1}),_.open()};u.on("click",function(s){if(s.preventDefault(),s.stopPropagation(),v)return v.show(),void(_&&_.close());var d=$(t.render(r,{countries:u.data("countries")})).on("click","a",function(t){if(t.preventDefault(),t.stopPropagation(),!b){b=!0;var n=$(this).parent(),s=n.attr("class").substr(8);if(s!==m){v.hide(),u.children().hide();var r=$(o.getImg());u.append(r),_&&_.close(),$.getJSON("/local-tops/"+e.dyn.trends.filter+"/"+s.toUpperCase(),function(e){i.setLocal("hexavid_tops_country",s,2592e6,"/");var t=l.find(".dyn"),o=t.first().prev();t.remove(),o.after(e.tops).after(document.createTextNode(" ")),d.children(".country-"+m).removeClass("disabled"),n.addClass("disabled"),u.children(".flag-small").removeClass("flag-"+m).addClass("flag-"+s),m=s}).fail(function(){y($("<a>"+a.__("loading.failed_retry")+"</a>").on("click",function(){n.children("a").click()}))}).always(function(){b=!1,r.remove(),u.children().show(),l.offset().top<$("body").scrollTop()&&tools.scrollTo(l)})}}});d.children(".country-"+m).addClass("disabled"),v=new n("#page",!0,"hide"),v.setClosable(!0,!0),v.addClass("popup-trends-countries"),v.setContent(d),v.show()})}}}}),define("skins/default/main",["static/cookies","lib/helpers/thumbs_rotator","./search/autocomplete","./search/trends","./search/categories"],function(e){var t=$("#show-more-best");t.length>0&&t.on("click",function(){e.setLocal("hexavid_bestall","1",3e4,"/")})}),define("skins/default/mozaique",["static/cookies","lib/helpers/thumbs_rotator","./search/autocomplete","./search/trends","./search/categories"],function(e){var t=$("#best-months");if(0!==t.length){var i=t.children("a.hidden"),n=t.children(".view-more"),s=!1;n.on("click",function(){s=!s,n.html(s?"-":"+"),i.toggleClass("hidden",!s)}),e.get("hexavid_bestall")&&(n.click(),e.setLocal("hexavid_bestall","",1e3,"/"))}}),define("text!skins/default/profile/desc_page_thumb.html",[],function(){return'<div>\n\t<div class="prev" title="{{{ prev }}}">&lt;&lt;</div>\n\t<div class="next" title="{{{ next }}}">&gt;&gt;</div>\n\t<p>{{{ title }}}</p>\n\t<img class="img-responsive" src="{{ src }}" />\n</div>\n'}),define("skins/default/profile/desc_page",["lib/helpers/overlay/box","lib/helpers/inline_loader","mustache","text!./desc_page_thumb.html","lib/i18n!front"],function(e,t,i,n,s){var o=$(".tab-description");if(o.length>0){var r,a,l,d,c,h=null;o.find(".thumbs").each(function(){var t=$(this),o=[];t.find("img").each(function(t){var u=$(this),f=t,p={node:u,src:u.prop("src").replace("-thumb",""),title:u.prop("title")};o.push(p),u.on("click",function(t){t.stopPropagation(),c=f,h?(r.prop("src",p.src),a.html(p.title)):(h=e.get("#main",!0,"hide").setClosable(!0,!0).setContent(i.render(n,{src:p.src,title:p.title,prev:s.__("misc.previous"),next:s.__("misc.next")})),r=h.container.find("img"),a=h.container.find("p"),l=h.container.find(".prev").on("click",function(){var e=c>0?c-1:o.length-1;o[e].node.trigger("click")}),d=h.container.find(".next").on("click",function(){var e=c<o.length-1?c+1:0;o[e].node.trigger("click")})),l.toggle(o.length>1),d.toggle(o.length>1),h.show(!1)})})})}var u=$("#login-link,#login-link-limit");u.length>0&&require(["skins/default/form/login_create"],function(e){e.setup_links(u)});var f=!1,p=$(),g=function(e){p=p.add(e),e.on("click",function(){if(!f&&confirm("Are you sure you want to subscribe to all uploaders of videos you like?")){f=!0;var e=t.get("after","Subscribing...").getNode().insertAfter(p);p.hide(),$.post("/videos-i-like/subscribe-all",function(e){e.result?(p.remove(),alert(e.message),window.location.reload()):(p.show(),f=!1,alert(e.message))},"json").fail(function(){p.show(),f=!1,alert("An error occured. Please retry.")}).always(function(){e.remove()})}})};return g($(".subscribe-all-upvidsilike")),g}),define("skins/default/prof_video_subs",["config/main","static/utils","static/cookies","lib/tools","lib/helpers/inline_loader","lib/helpers/thumbs_rotator","lib/helpers/overlay/box","skins/default/features_test/video_subs","skins/default/profile/subscribe","./profile/desc_page","lib/i18n!front","./search/autocomplete","lib/json"],function(e,t,i,n,s,o,r,a,l,d,c){var h=$("#toggle-tracking");if(h.length>0){var u=function(e){h.html(c.__(e?"profile.tracking.stop_subs_and_del":"profile.tracking.store_subs"))},f=function(){var e=a.isTracking();u(!e),e?window.confirm(t.unescape(c.__("misc.are_you_sure")))&&(a.stopTracking(),window.location.reload()):a.startTracking()};u(a.isTracking()),h.on("click",f)}var p=$("#content .eventslist");if(0!==p.length){var g,_,v,m,b,y=$(".tab-description").children(".hidden"),w=function(){var e=$(this),t=e.data("profile"),i=e.find(".user-subscribe");if("undefined"==typeof g[t])return void i.remove();var r=e.data("event"),a=e.find(".show-more-vids").children("a"),d=new l(i,t,g[t].u,!0,g[t].c||"");d.onUnsubscribe=function(){this.hidePopup(),e.remove(),p.children(".activity-"+r+"-"+t).remove()},0!==a.length&&a.on("click",function(){if(g[t].n<=5)return e.removeClass("show-less"),void a.remove();a.hide();var i=s.getSafe("after",c.__(" loading.loading")).getNode().insertAfter(a);$.post("/my-subs/videos/"+v+"/"+g[t].u+"/"+r+"/"+g[t].t+"/"+_+"/"+g[t].v.join(","),function(t){if(!t.result)return void a.show().addClass("text-danger").html("<strong>"+c.__("loading.failed_retry")+"</strong>");if(t.has_results){var i=$(n.replaceThumbcast(t.html.replace(/\\'/gi,"'"))).children(".mozaique").children(".thumb-block");e.find(".mozaique").append(i),o(i,!0)}a.remove(),e.removeClass("show-less")},"json").fail(function(){a.show().addClass("text-danger").html("<strong>"+c.__("loading.failed_retry")+"</strong>")}).always(function(){i.remove()})})},k=function(e){m&&m.abort(),"string"!=typeof e?(e&&e.preventDefault(),e=v):v=e,p.html('<p class="text-center"><strong>'+s.getSafe("after",c.__("loading.loading")).getHtml()+"</strong></p>"),p.show(),y.addClass("hidden"),m=$.post("/my-subs/videos/"+e,function(e){return e.result?(e.mass_sub?b?b.show():(b=$('<div class="main-message closable">'+e.mass_sub+'<div class="close">x</div></div>').insertBefore("#content"),b.find(".close").on("click",function(){b.hide(),i.setLocal("hexavid_hidemasssubs","1",6048e5,"/")}),d(b.find("a"))):b&&b.hide(),$("#home-tabs .mysubs .navbadge,#mobile-filters-menu .nb-new-video-subs-badge,#mobile-login-menu .nb-new-video-subs-badge").remove(),e.has_results?(p.html(n.replaceThumbcast(e.html.replace(/\\'/gi,"'"))),o(p),g=e.users,_=e.last_ts,void p.children(".activity-event").each(w)):(p.hide(),void y.removeClass("hidden"))):void p.html('<p class="text-center"><a class="text-danger"><strong>'+c.__("loading.failed_retry")+"</strong></a></p>").find("a").on("click",k)},"json").fail(function(){p.html('<p class="text-center"><a class="text-danger"><strong>'+c.__("loading.failed_retry")+"</strong></a></p>").find("a").on("click",k)})};k("all");var x=$("#video-subs-load-all").on("click",function(e){e.preventDefault(),x.removeClass("content-title"),$(this).addClass("content-title"),k("all")});x=x.add($("#video-subs-load-channels").on("click",function(e){e.preventDefault(),x.removeClass("content-title"),$(this).addClass("content-title"),k("channels")})),x=x.add($("#video-subs-load-models").on("click",function(e){e.preventDefault(),x.removeClass("content-title"),$(this).addClass("content-title"),k("models")}))}}),define("text!lib/helpers/pager/template.html",[],function(){return'<div class="pagination">\n<ul>\n{{# has_first }}<li><a href="{{ first.url }}" class="no-page">First</a></li>{{/ has_first }}\n{{# has_prev }}<li><a href="{{ prev.url }}" class="no-page">Previous</a></li>{{/ has_prev }}\n{{# pages }}<li>\n{{# current }}<a class="active" href="">{{ display }}</a>{{/ current }}\n{{^ current }}\n{{# no_page }}<a class="no-page" href="">{{ display }}</a>{{/ no_page }}\n{{^ no_page }}<a href="{{ url }}">{{ display }}</a>{{/ no_page }}\n{{/ current }}\n</li>{{/ pages }}\n{{# has_next }}<li><a href="{{ next.url }}" class="no-page">Next</a></li>{{/ has_next }}\n{{# has_last }}<li><a href="{{ first.url }}" class="no-page">Last</a></li>{{/ has_last }}\n</ul>\n</div>'}),define("lib/helpers/pager",["mustache","text!./pager/template.html"],function(e,t){var i={};return i.get=function(i){return i.has_first=i.first!==!1,i.has_prev=i.prev!==!1,i.has_next=i.next!==!1,i.has_last=i.last!==!1,$(e.render(t,i))},i}),define("text!skins/default/video/favorites/list.html",[],function(){return'<li href="#" class="list-group-item">\n\t<span class="badge">{{ nb_video }} {{{ labels.vids }}}</span>\n\t<strong><a href="/favorite/{{ id }}/{{ urlname }}">{{{ name }}}</a></strong>\n\t<button type="button" class="btn btn-default btn-xs add"{{^add_btn}} style="display:none;"{{/add_btn}}>{{{ labels.add_video }}}</button>\n\t{{#in_list}} {{>remove}}{{/in_list}}\n\t{{#max_videos_reached}} {{{>maxreached}}}{{/max_videos_reached}}\n</li>'}),define("text!skins/default/video/favorites/list_remove.html",[],function(){return'<span class="small remove">/ {{{ labels.video_in_list }}} <button type="button" class="btn btn-default btn-xs">{{{ misc.actions.remove }}}</button></span>'}),define("text!skins/default/video/favorites/list_maxreached.html",[],function(){return'<span class="small text-danger maxreached">/ {{{ max_vids_reached }}}</span>'}),define("skins/default/video/favorites/list",["config/main","mustache","lib/helpers/inline_loader","text!./list.html","text!./list_remove.html","text!./list_maxreached.html","lib/i18n!front"],function(e,t,i,n,s,o,r){var a,l,d=function(e,t,n){e.on("click",function(e){e.preventDefault();var s="add"===n?r.__("video.favs.adding_video"):r.__("video.favs.removing_video");a.setContent(i.getSafe("after",s+' "'+t.name+'"...').getHtml()).setClosable(!1).show(),$.post("/favorite/"+n+"/"+t.id+"/"+t.id_video,{csrf:t.csrf[n]},function(e){return e.result?e.logged?(t.setInList("add"===n),void a.hide()):void t.display_login():void a.setContent('<span class="text-danger">'+r.__("add"===n?"video.favs.error_occured_adding":"video.favs.error_occured_removing")+": "+e.message+"</span>").setClosable(!0)},"json").fail(function(e,t,i){a.setContent('<span class="text-danger">'+r.__("add"===n?"video.favs.error_occured_adding":"video.favs.error_occured_removing")+"</span>").setClosable(!0)})})},c=function(e,i,a){l||(l={labels:r.__("video.favs.*"),misc:r.__("misc.*")}),this.id_video=e,this.display_login=a,$.extend(this,i),i.add_btn=!i.in_list&&!i.max_videos_reached,i.labels=l.labels,i.misc=l.misc,this.node=$(t.render(n,i,{remove:s,maxreached:o})),i.in_list&&this.node.addClass("video-in-list"),this.addbtn=this.node.find(".btn.add"),d(this.addbtn,this,"add"),this.removebtn=this.node.find(".remove .btn"),this.removebtn.length>0&&d(this.removebtn,this,"remove"),this.maxreached=this.node.find(".maxreached")};return c.prototype={getNode:function(){return this.node},setInList:function(e){if(e&&0===this.removebtn.length){var i=$(t.render(s,l));this.removebtn=i.find(".btn"),d(this.removebtn,this,"remove"),this.maxreached.length>0?i.insertBefore(this.maxreached):this.node.append(i)}this.in_list=e,e?(this.nb_video++,this.node.addClass("video-in-list")):(this.nb_video--,this.max_videos_reached=!1,this.maxreached.hide(),this.node.removeClass("video-in-list")),this.addbtn.toggle(!e&&!this.max_videos_reached),this.removebtn.parent().toggle(e),this.node.find(".badge").text(this.nb_video+" vids")}},c.setOverlay=function(e){a=e},c}),define("text!skins/default/video/favorites/form.html",[],function(){return'<div class="list-group">\n\t<div class="list-group-item">\n\t\t<form class="form-inline">\n\t\t\t<input type="hidden" name="csrf" value="{{ csrf_token }}" />\n\t\t\t{{^max_reached}}\n\t\t\t<div class="form-group">\n\t\t\t\t<p class="form-control-static"><strong>{{{ labels.or_create_new_list }}}:</strong></p>\n\t\t\t</div>\n\t\t\t<div class="form-group">\n\t\t\t\t<label class="sr-only" for="new-fav-list-name">{{{ label_name }}}</label>\n\t\t\t\t<input type="text" name="name" class="form-control" id="new-fav-list-name" placeholder="{{{ label_name }}}" required />\n\t\t\t</div>\n\t\t\t<div class="form-group">\n\t\t\t\t<label>{{{ labels.visibility }}}</label>\n\t\t\t\t<select class="form-control" name="status">\n\t\t\t\t\t<option value="ANYONE">{{{ allow.public }}}</option>\n\t\t\t\t\t<option value="REGISTER">{{{ allow.registered }}}</option>\n\t\t\t\t\t<option value="FRIEND">{{{ allow.friends }}}</option>\n\t\t\t\t\t<option value="NOBODY">{{{ allow.nobody }}}</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t<button type="submit" class="btn btn-default">{{{ labels.create_list_and_add }}}</button>\n\t\t\t{{/max_reached}}\n\t\t\t{{#max_lists_reached}}\n\t\t\t<div class="form-group">\n\t\t\t\t<p class="form-control-static text-danger"><strong>{{{ labels.max_reached_delete_to_create_new }}}</strong></p>\n\t\t\t</div>\n\t\t\t{{/max_lists_reached}}\n\t\t\t{{#max_vids_reached}}\n\t\t\t<div class="form-group">\n\t\t\t\t<p class="form-control-static text-danger"><strong>{{{ labels.max_videos_reached_delete_to_create_new }}}</strong></p>\n\t\t\t</div>\n\t\t\t{{/max_vids_reached}}\n\t\t\t<a href="{{ upload_domain }}/account/managefavorites" class="btn btn-default" target="blank">{{{ labels.manage_favs }}}</a>\n\t\t</form>\n\t</div>\n</div>'}),define("skins/default/video/favorites/form",["config/main","mustache","static/utils","lib/tools","lib/helpers/inline_loader","text!./form.html","lib/i18n!front"],function(e,t,i,n,s,o,r){var a,l=function(l,d,c,h,u){this.id_video=l,this.display_login=u,this.translations=r.__("video.favs.*"),this.node=$(t.render(o,{max_reached:d||c,max_lists_reached:d,max_vids_reached:c,upload_domain:e.domains.master,labels:this.translations,allow:r.__("profile.allow.*"),label_name:r.__("user.name"),csrf_token:h})),this.input_name=this.node.find('input[type="text"]'),this.select_vis=this.node.find("select");var f=this;this.form=this.node.find("form").on("submit",function(e){e.preventDefault();var t=$.trim(f.input_name.val());return t.length<3?void alert(i.unescape(f.translations.min_length.replace("%nb_chars%",3))):(a.setContent(s.getSafe("after",f.translations.creating_and_adding).getHtml()).setClosable(!1).show(),void $.post("/favorite/create/"+f.id_video,f.form.serializeArray(),function(e){if(!e.result){var s=f.translations.error_occured_adding;return"string"==typeof e.message&&(s=e.message),void a.setContent('<span class="text-danger">'+s+"</span>").setClosable(!0)}if(!e.logged)return void f.display_login();f.input_name.val(""),f.select_vis.val("ANYONE");var o={id:e.id_list,name:i.escape(t),urlname:n.translit(t).replace(/[^\w]/g,"_").replace(/_+/g,"_"),in_list:e.video_added,nb_video:1,max_videos_reached:!1};if(f.onListCreated(o),e.video_added)a.hide();else{var s=r.__("misc.error")+": "+e.video_added_error;a.setContent('<span class="text-danger">'+s+"</span>").setClosable(!0)}},"json").fail(function(){a.setContent('<span class="text-danger">'+f.translations.error_occured_adding+"</span>").setClosable(!0)}))})};return l.prototype={onListCreated:null,getNode:function(){return this.node},setIdVideo:function(e){this.id_video=e}},l.setOverlay=function(e){a=e},l}),define("text!skins/default/video/favorites/page.html",[],function(){return'<div class="row">\n\t<div class="col-sm-6"><ul class="list-group"></ul></div>\n\t{{#two_cols}}<div class="col-sm-6"><ul class="list-group"></ul></div>{{/two_cols}}\n</div>'}),define("skins/default/video/favorites",["config/main","mustache","lib/helpers/dom","lib/helpers/pager","lib/helpers/overlay/box","lib/helpers/inline_loader","./favorites/list","./favorites/form","text!./favorites/page.html","lib/i18n!front"],function(e,t,i,n,s,o,r,a,l,d){var c,h,u,f,p,g,_,v,m=!1,b=!1,y=[],w=[],k=!1,x=function(){for(var e in y)"object"==typeof y[e]&&(y[e].node.remove(),y[e].pager&&y[e].pager.remove());y=[];for(var t in w)delete w[t];w=[],k=!1,b=!1},T=function(){x(),require(["skins/default/form/login_create"],function(e){e.setup_links($('<h4 class="text-center text-danger">'+d.__("video.favs.must_be_logged_in_to_fav")+' <a class="text-danger">'+d.__("misc.click_here_login_create_account")+"</a></h4>").appendTo(f.empty()).children("a"))})},C=function(e){k!==!1&&(y[k].node.toggle(e),y[k].pager&&y[k].pager.toggle(e))},E=function(){return p||(p=s.get(f,!1,"hide").setContent(o.get("after",d.__("profile.loading_favorites")).getNode())),p},S=function(){g&&E().show()},N=function(e){e.preventDefault(),I(parseInt($(this).attr("href").substr(1)))},O=function(e){if(!e.result){var o=$('<p class="text-center"><a class="text-danger">'+d.__("video.favs.failed_loading_click_here").replace("%here%",d.__("misc.here"))+"</a></p>");return o.find("a").on("click",function(){_.close(),I(k,!0)}),void(_=s.get(f,!0).setContent(o).show())}if(!e.logged)return void T();b||(b=!0,v=new a(c,e.max_lists_reached,e.max_videos_reached,e.csrf_create,T),f.append(v.getNode()),v.onListCreated=function(e){var t=new r(c,e,T);y[k].node.find("ul").eq(0).append(t.getNode()),w.push(t)}),C(!1);var p=e.lists.length,g=$(t.render(l,{two_cols:p>3})),m=g.find("ul");for(var x in e.lists){var E=new r(c,e.lists[x],T),S=0;p>3&&x>=Math.floor(p/2)&&(S=1),m.eq(S).append(E.getNode()),w.push(E)}if(g.prependTo(f),y[h]={node:g},e.pager){var O=n.get(e.pager).on("click","a",N);y[h].pager=O,O.prependTo(f)}u.length>0&&i.scrollToTop(u.position().top-10),k=h},I=function(e,t){if("undefined"==typeof e&&(e=0),!g&&(t||e!==k)){if("undefined"!=typeof y[e])return C(!1),k=e,C(!0),void(u.length>0&&i.scrollToTop(u.position().top-10));g=!0,h=e,window.setTimeout(S,500),$.post("/favorite/view/"+c+"/"+e,O,"json").fail(function(){s.get(f,!0).setContent('<strong class="text-danger">'+d.__("video.favs.failed_loading_retry")+"</strong>").show()}).complete(function(){g=!1,E().hide()})}},A=function(e){x(),b=!0,c=e,v.setIdVideo(e),I()};return function(t){if(!m)return m=!0,c="number"==typeof t?t:e.data.id_video,u=$("#tabFavs"),f=$("#favs-container"),r.setOverlay(s.get(f,!1,"hide")),a.setOverlay(s.get(f,!1,"hide")),I(),A}}),define("text!skins/default/profile/videos_ilike_favs.html",[],function(){return'<div>\n\t<h4>Add "<en class="vid-title"></en>" to you favorites:</h4>\n\t<div id="favs-container"></div>\n</div>'}),define("skins/default/features_test/videos_i_like",["./tracker"],function(e){var t,i=function(){return t||(t=new e("test_videos_ilike",500)),t},n=function(){};return n.prototype={isTracking:function(){return i().isTracking()},stopTracking:function(){i().stopTracking()},startTracking:function(){i().startTracking()},voteGood:function(e){i().addId(e)},voteBad:function(e){i().removeId(e)}},new n}),define("skins/default/prof_videos_i_like",["config/main","static/utils","lib/helpers/inline_loader","lib/helpers/overlay/box","skins/default/video/favorites","text!skins/default/profile/videos_ilike_favs.html","skins/default/features_test/videos_i_like","lib/i18n!front","lib/helpers/thumbs_rotator","./profile/desc_page","./search/autocomplete"],function(e,t,i,n,s,o,r,a){var l=$("#toggle-tracking");if(l.length>0){var d=function(e){l.html(a.__(e?"profile.tracking.stop_liked_and_del":"profile.tracking.store_liked"))},c=function(){var e=r.isTracking();d(!e),e?window.confirm(t.unescape(a.__("misc.are_you_sure")))&&(r.stopTracking(),window.location.reload()):r.startTracking()};d(r.isTracking()),l.on("click",c)}var h,u,f,p=function(e,t){if(h)h.show(t),f(e);else{var i=$(o);u=i.find(".vid-title"),h=n.get($("#page"),!0,"hide").setContent(i).show(t),f=s(e)}var r=t.children("p").first().children("a").html();u.html(r)};$(".mozaique .thumb-block").each(function(){var t=$(this),s=parseInt(t.prop("id").substr(6)),o=t.find(".btn-action.remove"),l=!1,d=t.find(".btn-action.add-to-favs");d.on("click",function(){l||p(s,t)}),o.on("click",function(){return e.data.login_info.is_logged?void(l||(l=!0,o.html(i.getImg()),$.post("/profiles/likes/likedvideo-remove/"+s,function(e){e.result?t.remove():(n.get(t,!0).setContent('<p class="text-danger">'+a.__("misc.error_please_retry")+"</p>").show(),o.text("x"),l=!1)},"json").fail(function(){n.get(t,!0).setContent('<p class="text-danger">'+a.__("misc.error_please_retry")+"</p>").show(),o.text("x"),l=!1}))):(r.voteBad(s),void t.remove())})})}),function(e){"function"==typeof define&&define.amd?define("lib/pathchange",["jquery"],e):e(jQuery)}(function(e){e.fn.pathchange=function(e){return e?this.bind("pathchange",e):this.trigger("pathchange")};var t=e.pathchange={options:{useHistory:!0,useHashchange:!0,pollingInterval:250,interceptLinks:!0,disableHashLinks:!0},init:function(i){var n;e.extend(t.options,i),t.options.useHistory&&t.detectHistorySupport()&&e(window).bind("popstate",function(t){e(window).trigger("pathchange")}),t.options.useHashchange&&(e(window).bind("hashchange",function(t){e(window).trigger("pathchange")}),t.detectHashchangeSupport()||(n=window.location.hash,setInterval(function(){n!==window.location.hash&&(e(window).trigger("hashchange"),n=window.location.hash)},t.options.pollingInterval))),t.options.interceptLinks&&e("body").delegate('a[href^="/"]',"click",function(i){t.changeTo(e(this).attr("href")),i.preventDefault()}),t.options.disableHashLinks&&e("body").delegate('a[href="#"]',"click",function(e){e.preventDefault()})},changeTo:function(i){t.options.useHistory&&t.detectHistorySupport()?(window.history.pushState(null,null,i),e(window).trigger("pathchange")):(i.indexOf("#")<0&&(i+="#"),window.location.href=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")+i)},detectHistorySupport:function(){return!(!window.history||!history.pushState)},detectHashchangeSupport:function(){var e="onhashchange"in window;return!e&&window.setAttribute&&(window.setAttribute("onhashchange","return;"),e="function"==typeof window.onhashchange),e}};return t}),define("lib/history",["./tools","./pathchange"],function(e){var t="##NOHASH##",i={},n="",s={};return s.getNoHashValue=function(){return t},s.registerHash=function(e,n){return"function"==typeof n&&(e||(e=t),i[e]=n,!0)},s.setUrlHash=function(t){n!==t&&(n=t,e.setUrlHash(t))},$.pathchange&&($.pathchange.init({interceptLinks:!1}),$(window).on("pathchange",function(){var s=e.getUrlHash();s||(s=t),s!==n&&i[s]&&i[s](s),n=s})),s}),define("lib/tab",["lib/helpers/dom","lib/tools","./history"],function(e,t,i){var n=function(n,s,o,r,a){this.node=$(n),this.closable=!!o,this.use_class="class"===a,this.no_first_tab_hash=!!r;var l=this.node.find(".tab-buttons a").not(".notab"),d=this.node.find(".tabs .tab"),c=this;if(0===d.length||l.length<d.length)return void console.error("Invalid tabs number");var h=e.getViewportWidth()<=768;s=s||{},this.first_tab_id,this.active=!1,this.tabs={},d.each(function(e){var t=l.first(),n=t.data("target");l=n?l.filter(function(e){return 0!==e&&($(this).data("target")!==n||(t=t.add(this),!1))}):l.slice(1);var o=$(this),r=o.prop("id"),a={};if(c.first_tab_id||(c.first_tab_id=r),a.first=0===e,a.id=r,a.tab=o,a.btn=t,a.target=n,a.active=!1,c.active)c.use_class?o.removeClass("active"):o.hide(),a.btn.removeClass("active");else{var d=a.btn.hasClass("active")||h&&a.btn.hasClass("mobile-active")||!h&&a.btn.hasClass("desktop-active");d?(a.active=!0,c.active=r,c.use_class?o.addClass("active"):o.show()):c.use_class?o.removeClass("active"):o.hide()}o.removeClass("mobile-active desktop-active"),a.btn.removeClass("mobile-active desktop-active"),a.action=!1;var u=[];"function"==typeof s[r]?a.action=s[r]:"object"==typeof s[r]&&("function"==typeof s[r].action&&(a.action=s[r].action),"object"==typeof s[r].subhashes&&(u=s[r].subhashes));var f="_"+r;c.no_first_tab_hash&&0===e&&(f=!1),i.registerHash(f,function(e){c._onhashchange(e)}),a.btn.on("click",function(e){e.preventDefault(),c.closable&&c.active===r?c.close():c.open(r)}),c.tabs[r]=a;for(var p in u)c.tabs[r+","+u[p]]=a,i.registerHash("_"+r+","+u[p],function(e){c._onhashchange(e)})});var u=t.getUrlHash();u&&(u=u.substr(1),"undefined"!=typeof this.tabs[u]&&(this._close(),this.active=u)),o||this.active||(this.active=this.first_tab_id),o&&!this.no_first_tab_hash&&i.registerHash(!1,function(e){c._onhashchange(e)}),this.active&&this.open(this.active,!0)};return n.prototype={open:function(e,t){if((t||this.active!==e)&&"undefined"!=typeof this.tabs[e]){t&&this.active===e||this._close();var n=this.tabs[e];n.active=!0,this.use_class?n.tab.addClass("active"):n.tab.show(),n.btn.addClass("active"),n.action&&n.action(e);var s="_"+e;this.no_first_tab_hash&&n.first&&s.indexOf(",")===-1&&(s=""),this.active=e,i.setUrlHash(s),this.node.addClass("disp-"+e.replace(",","-"))}},close:function(){this.closable&&this._close()},_close:function(){if(this.active){this.node.removeClass("disp-"+this.active.replace(",","-"));var e=this.tabs[this.active];e.active=!1,this.use_class?e.tab.removeClass("active"):e.tab.hide(),e.btn.removeClass("active"),this.active=!1}},_onhashchange:function(e){this.no_first_tab_hash&&e===i.getNoHashValue()&&(e="_"+this.first_tab_id),e!==i.getNoHashValue()?this.open(e.substr(1)):this.close()}},n}),define("text!skins/default/profile/vote/votes_box.html",[],function(){return'<div class="rating-box">\n\t<span class="vote-actions">\n\t\t<a class="btn btn-default vote-action-good"><span class="icon thumb-up black">&nbsp;</span></a><a class="btn btn-default vote-action-bad"><span class="icon thumb-down red">&nbsp;</span></a>\n\t</span>\n\t<div class="rating-bar-block">\n\t\t{{# disp_good_bad }}\n\t\t<span class="icon thumb-up"></span> <span class="good">{{ vgood }}</span>\n\t\t<span class="icon thumb-down red"></span> <span class="bad">{{ vbad }}</span>\n\t\t{{/ disp_good_bad }}\n\t\t{{^ disp_good_bad }}\n\t\t<span class="total">{{ vtotal }}</span>\n\t\t{{/ disp_good_bad }}\n\t\t<div class="rating-bar"><div style="width:{{ vrating }}%;"></div></div>\n\t</div>\n\t<span class="rating">{{ rating }}</span>\n</div>'}),define("skins/default/profile/vote/total",["config/main","mustache","lib/tools","text!./votes_box.html","lib/helpers/inline_loader","lib/helpers/popup","lib/helpers/overlay/box","lib/i18n!front"],function(e,t,i,n,s,o,r,a){var l=function(e,i,s,o,r,a,l){if("undefined"!=typeof e){this.vtotal=o,this.vrating=i,this.rating=s,this.visitor_vote=!1,"undefined"==typeof r||"GOOD"!==r&&"BAD"!==r||(this.visitor_vote=r),this.login_required="boolean"==typeof a&&a,this.login_container=l,this.node=$(t.render(n,this._get_tpl_vars())),e.replaceWith(this.node),this.actions=this.node.children(".vote-actions"),this.yes_btn=this.actions.children(".vote-action-good"),"GOOD"===this.visitor_vote&&this.yes_btn.addClass("disabled"),this.no_btn=this.actions.children(".vote-action-bad"),"BAD"===this.visitor_vote&&this.no_btn.addClass("disabled"),this.bar_good=this.node.find(".rating-bar div"),this.bar_rating=this.node.children(".rating"),this.total=this.node.find(".total"),this._init_counts();var d=this;this.voting=!1,this.popup=null,this.popup_pos={v:"below",h:"left"},this.yes_btn.on("click",function(){d._vote("GOOD")}),this.no_btn.on("click",function(){d._vote("BAD")})}};return l.prototype={initPostData:function(e,t,i){this.url_good=e,this.url_bad=t,this.post_data=i||{}},setPopupPosition:function(e,t){this.popup_pos.v=e,this.popup_pos.h=t},_init_counts:function(){this.counts_total=this.node.find(".total")},_get_tpl_vars:function(){return{vtotal:this.vtotal,rating:this.rating,vrating:this.vrating}},_update_counts:function(e){this.bar_rating.text(e.vrating),this.total.text(e.total),this.bar_good.css("width",e.rating+"%")},_get_popup:function(e,t){return this.popup?this.popup.setButton(e).setContent(t):this.popup=new o(e,t,{relative_to:this.node.parent(),position:this.popup_pos,trigger:!1}),this.popup},_open_login:function(){require(["skins/default/form/login_create"],function(e){e.open()})},_vote:function(t){if("GOOD"!==t&&"BAD"!==t)return!1;if(t===this.visitor_vote)return!0;if(this.voting)return!1;if(this.login_required&&!e.data.login_info.is_logged)return this._open_login(),!1;var i=this,n="GOOD"===t?this.yes_btn:this.no_btn,o=n.html(),r="GOOD"===t?this.url_good:this.url_bad;this.yes_btn.addClass("disabled"),this.no_btn.addClass("disabled"),n.html(s.getImg()),$.post(r,this.post_data,function(e){var s;e.result?(i._update_counts(e),i.visitor_vote=t,s="<strong>"+a.__("video.votes.thanks")+"</strong>"):s='<strong class="text-danger">'+e.message+"</strong>",i._get_popup(n,s).open()},"json").fail(function(){i._get_popup(n,'<strong class="text-danger">'+a.__("error.err_please_reload")+"</strong>").open()}).complete(function(){n.html(o),i.voting=!1,i.yes_btn.toggleClass("disabled",!e.data.login_info.is_logged||"GOOD"===i.visitor_vote),i.no_btn.toggleClass("disabled",!e.data.login_info.is_logged||"BAD"===i.visitor_vote)})}},l}),define("skins/default/profile/action/aboutme_desc",["config/main","mustache","lib/helpers/overlay","lib/helpers/inline_loader","lib/i18n!front"],function(e,t,i,n,s){var o=$("#pinfo-aboutme");if(o.hasClass("editable")){var r=!1;o.on("click",function(){r||(o.addClass("editing").find("textarea").focus(),r=!0)});var a=o.find("button").on("click",function(){var l=a.prevAll("textarea"),d=o.find(".value"),c=$.trim(l.val());a.prev("p").remove();var h=i.get(o,!1).setContent(n.getSafe("after",s.__("misc.updating")).getHtml()).show();$.post("/profiles/"+e.data.user.username+"/update",{"profile[aboutme]":c,csrf:e.data.user.csrf.uupdate},function(e){if(e.result){r=!1,o.removeClass("missing editing"),0===c.length?(o.addClass("missing"),o.find(".tip span").html(s.__("profile.aboutme.click_write_desc"))):o.find(".tip span").html(s.__("profile.aboutme.click_edit_desc"));var i=t.render("{{ text }}",{text:c}).split("\n").join("\n<br>");d.html(i),$("#header-about-me").html(i)}else{var n;n=e.message?s.__("misc.update_failed_error")+" "+e.message:s.__("misc.update_failed_please_retry"),a.before('<p class="text-center"><strong class="text-danger">'+n+"</strong></p>")}},"json").fail(function(){h.close(),a.before('<p class="text-center"><strong class="text-danger">'+s.__("misc.error_please_retry")+"</strong></p>")}).always(function(){h.close()})})}}),define("text!skins/default/profile/action/link/user_blocked.html",[],function(){return'<button type="button" class="btn btn-default btn-xs btn-link" ><span class="icon blocked-user"></span> <strong class="label text-danger">{{{ label }}}</strong></button>'}),define("text!skins/default/profile/action/report.html",[],function(){return'<div class="tab-form">\n\t<form id="profile-report-form" class="form-horizontal">\n\t\t<input type="hidden" name="csrf" value="{{ csrf_token }}" />\n\t\t<h2 class="text-center">{{# is_profile }}{{{ labels.report_user }}}{{/ is_profile }}{{^ is_profile }}{{{ labels.report_comment }}}{{/ is_profile }}</h2>\n\t\t{{# content_removal }}\n\t\t<div class="row">\n\t\t\t<div class="col-sm-6">\n\t\t{{/ content_removal }}\n\t\t\t\t<div class="form-group" id="report-reason">\n\t\t\t\t\t<div class="col-xs-12 text-center">\n\t\t\t\t\t\t{{# reasons }}\n\t\t\t\t\t\t<div class="radio-inline"><label><input type="radio" name="report[reason]" value="{{ value }}"{{# checked }} checked{{/ checked }}> {{ label }}</label></div>\n\t\t\t\t\t\t{{/ reasons }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="form-group" id="report-details">\n\t\t\t\t\t<div class="col-xs-12">\n\t\t\t\t\t\t<textarea class="form-control" name="report[details]" rows="3" required placeholder="{{{ labels.give_details }}}"></textarea>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="form-group" id="report-confirm">\n\t\t\t\t\t<div class="col-xs-12"><div class="checkbox"><label><input name="report[confirm]" type="checkbox" /> {{# is_profile }}{{{ labels.confirm_spam_illegal }}}{{/ is_profile }}{{^ is_profile }}{{{ labels.confirm_comment_spam_illegal }}}{{/ is_profile }}</label></div></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<div class="col-xs-12">\n\t\t\t\t\t\t<button type="button" class="submit btn btn-default pull-right report">{{{ labels.report }}}</button>\n\t\t\t\t\t\t<button type="button" class="submit btn btn-default cancel">{{{ cancel_label }}}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{{# content_removal }}\n\t\t\t<div class="col-sm-6 content-infrigment">\n\t\t\t\t<p><strong class="text-danger">{{{ content_removal.links }}}</strong></p>\n\t\t\t\t<p>{{{ content_removal.link_copyright }}}</p>\n\t\t\t\t<p>{{{ content_removal.link_privacy }}}</p>\n\t\t\t</div>\n\t\t</div>\n\t\t{{/ content_removal }}\n\t</form>\n</div>';
}),define("skins/default/profile/action/report",["config/main","mustache","static/utils","lib/tools","lib/helpers/overlay/box","lib/helpers/inline_loader","lib/i18n!front","text!./report.html"],function(e,t,i,n,s,o,r,a){var l=function(t,i,s,o,r){if("profile"===t&&!e.data.login_info.is_logged)return void require(["skins/default/form/login_create"],function(e){e.setup_links(i,function(){var e=n.parseUrl(window.location.href),t=e.body;t+=e.query?e.query+"&reportuser=1":"?reportuser=1",e.hash&&(t+="#"+e.hash),window.location.href=t})});this.type=t,this.id=o,this.btn=i,this.container=s,this.csrf_token=r,this.overlay;var a=this;if(i.on("click",function(e){e.preventDefault(),a._handle()}),"profile"===t){var l=n.parseUrl(window.location.href,"query",!0);l.reportuser&&a._handle()}};return l.prototype={_handle:function(){return this.overlay?void this.overlay.show():void this._load_form()},_load_form:function(){this.messages=r.__("report_form.*",{"%user%":e.data.user.display});var n=[];n.push({value:"nevermind",label:this.messages.nevermind,checked:!0}),n.push({value:"spammer",label:this.messages.spammer,checked:!1}),n.push({value:"underage",label:this.messages.underage,checked:!1}),"profile"===this.type&&n.push({value:"fake",label:this.messages.fake_profile,checked:!1}),n.push({value:"other",label:this.messages.other,checked:!1});var l={is_profile:"profile"===this.type,reasons:n,labels:this.messages,cancel_label:r.__("misc.cancel"),csrf_token:this.csrf_token};"profile"===this.type&&(l.content_removal=r.__("content_removal.*",{"%start_copy_link%":'<a href="http://support.xvideos.com/takedown/" target="_blank">',"%start_privacy_link%":'<a href="http://support.xvideos.com/takedown-amateur" target="_blank">',"%end_link%":"</a>"}));var d=$(t.render(a,l));this.overlay=s.get(this.container,!0,"hide").append(d).show();var c,h=this,u=d.children("form"),f=d.find("button.report"),p=function(e){if(h.overlay.show(),e.validation_error)for(var t in e.validation_error)$("#report-"+t).addClass("has-error").children().append('<p class="help-block text-left">'+e.validation_error[t]+"</p>");else e.result?(d.replaceWith('<p class="text-center"><strong class="text-success">'+(e.message||h.messages.thanks)+"</strong></p>"),h.overlay.autoclose(1e4),h.btn.remove()):(h.overlay.show(),f.parent().prepend('<p class="text-center"><strong class="text-danger">'+e.message+"</strong></p>"))},g=function(){var t=u.serializeArray(),n=!1;for(var r in t)if("report[reason]"!==t[r].name){if("report[details]"!==t[r].name)"report[confirm]"!==t[r].name||t[r].value!==!0&&1!==t[r].value&&"on"!==t[r].value||(n=!0);else if($.trim(t[r].value).length<10)return alert(i.unescape(h.messages.enter_reason.replace("%nb_chars%",10)))}else if("nevermind"===t[r].value)return void p({result:!0,message:h.messages.thanks});if(!n)return alert(i.unescape(h.messages.please_confirm_spam_illegal));f.prevAll("p").remove(),u.find(".has-error").removeClass("has-error").find(".help-block").remove(),h.overlay.hide(),c=s.get(h.container,!1).setContent(o.get("after",h.messages.sending).getHtml()).show();var a;a="profile"===h.type?"/profiles/"+e.data.user.username+"/report":"/profiles/"+e.data.user.username+"/comments/"+h.id+"/report",$.post(a,t,p,"json").fail(function(){h.overlay.show(),f.parent().prepend('<p class="text-center"><strong class="text-danger">'+h.messages.sending_failed_2+"</strong></p>")}).always(function(){c.close()})};d.find("button.cancel").on("click",function(){h.overlay.hide()}),f.on("click",g)}},l}),define("text!skins/default/profile/action/popup_form.html",[],function(){return'<form class="form-horizontal">\n\t{{# title }}\n\t<div class="form-group title">\n\t\t<div class="col-sm-12">\n\t\t\t<p class="form-control-static">{{{ title }}}</p>\n\t\t</div>\n\t</div>\n\t{{/ title }}\n\t{{# inputs }}\n\t<div class="form-group">\n\t\t<label for="{{ base_id }}_{{ name }}" class="col-sm-6 control-label">{{{ label }}}</label>\n\t\t<div class="col-sm-6">\n\t\t\t<input type="text" class="form-control" id="{{ id }}" name="{{ name }}" />\n\t\t</div>\n\t</div>\n\t{{/ inputs }}\n\t{{# settings }}\n\t<div class="form-group">\n\t\t<label for="{{ base_id }}_{{ name }}" class="col-sm-6 control-label">{{{ label }}}</label>\n\t\t<div class="col-sm-6">\n\t\t\t<select class="form-control" id="{{ id }}" name="{{ name }}">\n\t\t\t\t{{# options }}<option value="{{ opt_value }}"{{# opt_cheked }} checked="checked"{{/ opt_cheked }}>{{{ opt_label }}}</option>{{/ options }}\n\t\t\t</select>\n\t\t</div>\n\t</div>\n\t{{/ settings }}\n\t{{# static_fields }}\n\t<div class="form-group">\n\t\t<label class="col-sm-6 control-label">{{{ label }}}</label>\n\t\t<div class="col-sm-6">\n\t\t\t<p class="form-control-static">{{{ content }}}</p>\n\t\t</div>\n\t</div>\n\t{{/ static_fields }}\n\t<div class="form-group actions">\n\t\t<div class="col-sm-12 text-right">\n\t\t\t<div>\n\t\t\t\t{{# csrf_token }}\n\t\t\t\t<input type="hidden" name="csrf" value="{{ csrf_token }}" />\n\t\t\t\t{{/ csrf_token }}\n\t\t\t\t<button type="button" class="btn btn-default btn-xs">{{{ btn_label }}}</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</form>'}),define("skins/default/profile/action/popup_form",["config/main","mustache","lib/helpers/inline_loader","lib/helpers/popup","text!./popup_form.html","lib/i18n!front"],function(e,t,i,n,s,o){var r=function(e,t,i){this.btn=e,this.title=t,this.btn_label=i||o.__("misc.save"),this.msg_success,this.msg_updating,this.url=!1,this.validator=!1,this.csrf_token=!1,this.inputs=[],this.settings=[],this.static_fieds=[],this.popup=null;var n=this,s=this.btn.on("click",function(e){e.preventDefault(),n.btn.off("click",s),n._get_popup().open()});this.saving=!1};return r.prototype={setMessages:function(e,t){this.msg_success=e,this.msg_updating=t},setRequestParams:function(e,t,i){this.url=e,this.validator=t,this.csrf_token=i},addInput:function(e,t){this.inputs.push({label:e,name:t,id:this.btn.prop("id")+"-"+t.replace("[","-").replace("]","-")})},addSetting:function(e,t,i,n){for(var s in i)i[s].opt_cheked=i[s].opt_value===n;this.settings.push({label:e,name:t,id:this.btn.prop("id")+"-"+t.replace("[","-").replace("]","-"),options:i})},addStaticField:function(e,t){this.static_fieds.push({label:e,content:t})},_get_popup:function(){if(!this.popup){this.form=$(t.render(s,{title:this.title,inputs:this.inputs,settings:this.settings,static_fields:this.static_fieds,btn_label:this.btn_label,csrf_token:this.csrf_token||e.data.user.csrf.uupdate})),this.popup=new n(this.btn,this.form,{popup_class:"x-popup-white profile-privacy-popup"});var i=this;this.form.find(".actions button").on("click",function(){i._save_form()})}return this.popup},_save_form:function(){if(!this.saving&&(!this.validator||this.validator())){this.saving=!0,this.form.prevAll().remove();var t=this,n=this.form.serializeArray(),s=i.getSafe("after",this.msg_updating||o.__("profile.privacy.saving")).insertAfter(this.form.hide());$.post(this.url||"/profiles/"+e.data.user.username+"/update",n,function(e){if(e.result)t.form.before('<p class="text-success"><strong>'+(t.msg_success||o.__("profile.privacy.saved"))+"</strong></p>");else{var i;i=e.message?o.__("misc.update_failed_error")+" "+e.message:o.__("misc.update_failed_please_retry"),t.form.before('<p class="text-danger"><strong>'+i+"</strong></p>")}},"json").fail(function(){t.form.before('<p class="text-danger"><strong>'+o.__("misc.error_please_retry")+"</strong></p>")}).always(function(){t.saving=!1,s.remove(),t.form.show()})}}},r}),define("skins/default/profile/tabs/aboutme",["config/main","lib/tools","lib/helpers/popup","skins/default/profile/vote/total","lib/i18n!front","../action/aboutme_desc"],function(e,t,i,n,s){var o="/profiles/"+e.data.user.username+"/",r=function(e){var t=$("#pinfo-"+e+"-info-switch");if(0!==t.length){var i=t.parents(".pinfo-switch"),n=i.nextAll(".pinfo-"+e);t.on("click",function(e){e.preventDefault(),n.removeClass("pinfo-hidden"),i.remove()})}};r("personal"),r("physical");var a=$("#block-user");a.length>0&&require(["mustache","skins/default/profile/action/link","text!skins/default/profile/action/link/user_blocked.html"],function(t,i,n){var r=new i(a,o+"block/add",s.__("profile.confirm_block",{"%user%":e.data.user.display}),!1,e.data.user.csrf.blockadd);r.onSuccess=function(){var e=this.link.parent();this.link.remove(),0===e.children().length&&e.remove();var i=$("#tabAboutMe"),o=i.children(".pfinfo-actions");0===o.length?o=$('<div class="pfinfo-actions"></div>').prependTo(i):o.empty(),o.prepend(t.render(n,{label:s.__("profile.blocked")})),window.setTimeout(function(){window.location.reload()},1e3)}});var l=$("#report-user");l.length>0&&require(["skins/default/profile/action/report"],function(t){new t("profile",l,$("#page"),null,e.data.user.csrf.ureport)});var d=e.data.user.pvote,c=new n($("#profile-vote"),d.vrating,d.rating,d.total,e.data.visitor.pvote.res,!e.data.visitor.pvote.allowed,$("#page"));c.initPostData(o+"vote/good",o+"vote/bad",{csrf:e.data.user.csrf.uvote});var h=$("#vote-info");if(h.length>0){var u=s.__("profile.vote.tip_good_vote_save_user",{"%start_link%":e.data.login_info.is_logged?'<a href="'+e.domains.master+'/account/people/ilike">':"","%end_link%":e.data.login_info.is_logged?"</a>":""});new i(h,"<div><strong>"+s.__("misc.tip")+": </strong>"+u+"</div>",{trigger:"click mouseenter"})}var f=$("#privacy-edit-aboutme");f.length>0&&require(["skins/default/profile/action/popup_form"],function(t){var i=new t(f),n=[];n.push({opt_value:"ANYONE",opt_label:s.__("misc.everybody")}),n.push({opt_value:"REGISTER",opt_label:s.__("profile.allow.only_registered")}),n.push({opt_value:"FRIEND",opt_label:s.__("profile.allow.friends")}),n.push({opt_value:"NOBODY",opt_label:s.__("profile.allow.nobody")}),i.addSetting(s.__("profile.privacy.who_can_view_contact"),"profile[contact_access]",n,e.data.user.access.contact);var o=s.__("profile.privacy.no_country_blocked")+", ";if(e.data.user.blocked_countries.length>0){o="";for(var r in e.data.user.blocked_countries){var a=e.data.user.blocked_countries[r];o+='<span class="text-nowrap"><span class="flag-small flag-'+a.toLowerCase()+'"></span> [:CTRY:{"country":"'+a+'"}:]</span>, '}}o+='<a href="'+e.domains.master+'/account/edit#profile-edit-privacy-settings">'+s.__("misc.change")+"</a>",i.addStaticField(s.__("profile.privacy.blocked_countries"),o)});var p=$("#pinfo-aboutme");if(p.length>0){var g,_=$("#header-about-me"),v=!1,m=!1,b=function(){m||(v||(v=p.find(".show-more").on("click",function(){m=!0,p.css("max-height","none"),$(this).remove(),$(window).off("resize",g),v.off("click")})),v.css("display",p.outerHeight()>142?"block":""))};return g=$(window).on("resize",b),_.on("click",function(){_.off("click").addClass("expanded"),$("#tab-aboutme").click(),v.click()}),b}return function(){}}),define("text!skins/default/profile/action/link/friend_asked.html",[],function(){return'<button type="button" class="btn btn-default btn-xs btn-link" title="{{{ label }}}"><span class="icon pending-friend-req"></span> <span class="label">{{{ label }}}</span></button>'}),define("skins/default/profile/title_actions",["config/main","mustache","./action/link","./subscribe","lib/i18n!front","text!./action/link/friend_asked.html"],function(e,t,i,n,s,o){var r="/profiles/"+e.data.user.username+"/",a=$("#profile-add-to-friends");if(a.length>0){var l=new i(a,r+"friends/requests/ask",!1,!0,e.data.user.csrf.freqask);l.onSuccess=function(){this.disable(),this.link.replaceWith(t.render(o,{label:s.__("profile.friends.you_asked_friends",{"%name%":e.data.user.display})}))}}var d=$("#pending-friend-req-confirm");if(d.length>0){var c=new i(d,r+"friends/requests/confirm",!1,!1,e.data.user.csrf.freqconfirm);c.onSuccess=function(){this.link.next().remove();var e=this.link.parent().prev();this.link.remove(),e.children(".label").html('<strong class="text-success">'+s.__("misc.confirmed")+"</strong>"),window.setTimeout(function(){window.location.reload()},1e3)}}var h=$("#pending-friend-req-ignore");if(h.length>0){var u=new i(h,r+"friends/requests/ignore",!1,!1);u.onSuccess=function(){this.link.prev().remove();var e=this.link.parent().prev();this.link.remove(),e.children(".label").html('<strong class="text-success">'+s.__("misc.ignored")+"</strong>")}}var f=$("#profile-unfriend");if(f.length>0){var p=new i(f,r+"friends/remove",s.__("profile.friends.confirm_unfriend",{"%user%":e.data.user.display}),!1,e.data.user.csrf.frremove);p.onSuccess=function(){var e=this.link.prev();this.link.remove(),e.children(".label").html('<strong class="text-success">'+s.__("profile.friends.not_anymore")+"</strong>"),window.setTimeout(function(){window.location.reload()},1e3)}}var g=$("#unblock-user");if(g.length>0){var _=new i(g,r+"block/remove",!1,!1,e.data.user.csrf.blockremove);_.onSuccess=function(){var e=this.link.prev();this.link.remove(),e.children(".label").html('<strong class="text-success">'+s.__("profile.unblocked")+"</strong>"),window.setTimeout(function(){window.location.reload()},1e3)}}var v=$(".user-subscribe");v.length>0&&new n(v,e.data.user.username,e.data.user.id_user,e.data.visitor.subscriber,e.data.user.csrf.sub||"")}),define("skins/common/listing/loader",["lib/tools","lib/helpers/inline_loader","lib/helpers/thumbs_rotator","skins/common/debug/console","lib/i18n!front"],function(e,t,i,n,s){var o=function(e,t,i,n,s){this.type=e,this.container=t,this.url=i,this.is_video=!!n,this.is_pic=!!s,this.loading=!1,this.loaded=!1,this.error};return o.prototype={onLoaded:null,load:function(){if(!this.loading&&!this.loaded){this.loading=!0,this.error&&this.error.remove(),this._display_loader();var e=this,t=this._get_url();n.print('POST "'+t+'"',"Listing loader "+this.type),$.post(t,function(t){n.print("Loaded!","Listing loader "+e.type),e._on_loaded(t)},"html").fail(function(t,i,s){n.print("ERROR: "+i+' - "'+s+'"',"Listing loader "+e.type,t),e._on_error()}).always(function(){e.loading=!1})}},get_loader_containers:function(){return this.container},_display_loader:function(){this.get_loader_containers().html('<p class="text-center">'+t.getSafe("after",s.__("profile.loading_"+this.type)).getHtml()+"</p>")},_get_url:function(){return this.url},_on_error:function(){var e=this;this.container.html('<div class="text-center"><strong><a href="#" class="text-danger">'+s.__("loading.failed_retry")+"</a></strong></div>").find("a").on("click",function(t){return t.preventDefault(),e.load(),!1})},_on_loaded:function(t){"string"==typeof t&&((this.is_video||this.is_pic)&&(t=e.replaceThumbcast(t)),this.container.html(t),this.is_video&&i(this.container)),this.loaded=!0,"function"==typeof this.onLoaded&&this.onLoaded()}},o}),define("skins/common/listing/loader/paginated",["./../loader","lib/helpers/inline_loader","lib/helpers/overlay/box","lib/i18n!front"],function(e,t,i,n){var s=function(t,i,n,s){e.apply(this,arguments),this.page=0,this.loaded_once=!1,this.overlay};return s.prototype=new e,s.prototype._get_url=function(){return this.url+"/"+this.page},s.prototype.loadPage=function(e){this.page=parseInt(e),this.loaded=!1,this.load()},s.prototype._display_loader=function(){if(!this.loaded_once)return void e.prototype._display_loader.call(this);this.overlay||(this.overlay=i.get(this.container,!1).setContent('<p class="text-center">'+t.getSafe("after",n.__("profile.loading_"+this.type)).getHtml()+"</p>"));var s=this;window.setTimeout(function(){s.loading&&s.overlay&&s.overlay.show()},500)},s.prototype._show_overlay=function(){},s.prototype._on_error=function(){e.prototype._on_error.call(this),this.overlay&&this.overlay.hide()},s.prototype._on_loaded=function(t){this.loaded_once=!0,e.prototype._on_loaded.call(this,t);var i=this;this.container.find(".pagination a").on("click",function(e){if(e.preventDefault(),!$(this).hasClass("active")){var t=$(this).attr("href");t&&i.loadPage(t.substr(1))}}),this.overlay&&this.overlay.hide()},s}),define("skins/default/profile/listing/videos",["config/main","lib/helpers/dom","lib/tools","skins/common/listing/loader","skins/common/listing/loader/paginated"],function(e,t,i,n,s){var o=["best","new","rating"],r=function(t){return e.data.user.url+"/videos/"+t},a=function(e){this.container=e,this.loaders={},this.ups_sort=!1,this.status="not_loaded",this.has_uploads=!1,this.has_pornstar=!1};return a.prototype={load:function(e){var a="best",l=!1,d=e.indexOf(",");if(d!==-1){var c=e.substr(d+1);"videos-pornstar"===c&&(l=!0,this.ups_sort&&(a=this.ups_sort)),"videos-new"!==c&&"videos-rating"!==c||(a=c.substr(7))}if("not_loaded"===this.status){this.status="loading",this.ups_sort=a;var h=this,u=new n("videos",this.container,r(a),!0);return u._on_loaded=function(e){n.prototype._on_loaded.call(this,e);var d=h.container.find("#profile-listing-uploads");if(d.length>0){h.has_uploads=!0,h.loaders[a]=new s("videos",d,r(a),!0),h.loaders[a]._on_loaded();for(var c in o)a!==o[c]&&(h.loaders[o[c]]=new s("videos",d,r(o[c]),!0),h.loaders[o[c]].loaded_once=!0);if(!l){var u=h.container.before();t.isElementInView(u,!1)||i.scrollTo(u,35)}}var f=h.container.find("#profile-listing-pornstar");f.length>0&&(h.has_pornstar=!0,h.loaders.pornstar=new s("videos",f,r("pornstar"),!0),h.loaders.pornstar._on_loaded(),l&&i.scrollTo(f,35)),h.status="loaded",h.ups_sort!==a&&h.load("tabVideos,"+h.ups_sort)},void u.load()}if("loaded"===this.status){if(l&&i.scrollTo(this.loaders.pornstar.container,35),this.ups_sort===a)return;if(this.ups_sort=a,this.loaders[a].loadPage(0),!l){var f=this.container.before();t.isElementInView(f,!1)||i.scrollTo(f,35)}}this.ups_sort=a}},a}),define("skins/common/listing/loader/infinite",["lib/tools","lib/helpers/inline_loader","lib/helpers/thumbs_rotator"],function(e,t,i){var n=$(document),s=$(window),o=function(e,t,i,n,o,r){this.btn=e,this.btn_content=this.btn.html(),this.list=t,this.autoload=!!r,this.loading=!1,this.loading_msg=o,this.last_timestamp=n,this.url=i;var a=this,l=function(){a.loadNext()};this.last_child=t.children().last().prev(),this.autoload&&(this.last_child_pos=this.last_child.offset().top,this.scroll_handler=s.on("scroll",l),this.resize_handler=s.on("resize",function(){a.last_child_pos=a.last_child.offset().top,l()})),this.btn.on("click",l)};return o.prototype={onLoaded:function(t){var n=t.indexOf("-->");this.last_timestamp=parseInt(t.substring(5,n)),t=t.substr(n+3),this.list.append(e.replaceThumbcast(t.replace(/\\'/gi,"'"))),i(this.last_child.nextAll(),!0),this.last_child=this.list.children().last().prev(),this.autoload&&(this.last_child_pos=this.last_child.offset().top),0===this.last_timestamp&&(this.btn.remove(),this.autoload&&(s.off("scroll",this.scroll_handler),s.off("resize",this.resize_handler)))},loadNext:function(){if(!(this.loading||!this.last_timestamp||this.autoload&&n.scrollTop()+2*s.height()<this.last_child_pos)){this.btn.prop("disabled",!0).addClass("disabled").html(t.getSafe("after",this.loading_msg).getHtml()),this.loading=!0;var e=this;$.get(this.url+this.last_timestamp,function(t){e.onLoaded(t)},"html").always(function(){e.loading=!1,e.btn.prop("disabled",!1).removeClass("disabled").html(e.btn_content)})}}},o}),define("skins/default/profile/listing/infinite",["skins/common/listing/loader","skins/common/listing/loader/infinite"],function(e,t){var i=function(e,t,i,n,s,o,r){this.type=e,this.node=t,this.url=i,this.is_video=n,this.btn_id=s,this.loading_msg=o,this.list_id=r};return i.prototype={on_first_load:null,on_next_load:null,load:function(){var i=this;this.list_loader=new e(this.type,this.node,this.url,this.is_video),this.list_loader._on_loaded=function(n){var s=n.indexOf("-->"),o=parseInt(n.substring(5,s));n=n.substr(s+3),e.prototype._on_loaded.call(this,n);var r=$("#"+i.btn_id),a=$("#"+i.list_id);return 0===r.length||0===a.length?void("function"==typeof i.on_first_load&&i.on_first_load()):(i.infinite_loader=new t(r,a,i.url+"/",o,i.loading_msg,!1),i.infinite_loader.onLoaded=function(e){var n=this.last_child;t.prototype.onLoaded.call(this,e),"function"==typeof i.on_next_load&&i.on_next_load(n.nextAll())},void("function"==typeof i.on_first_load&&i.on_first_load()))},i.list_loader.load()}},i}),define("skins/default/profile/images",[],function(){var e=$(".img-block .gif-tag"),t=function(e){e.each(function(){var e=$(this),t=e.prev(),i=t.position();e.css({left:i.left+3,top:i.top+3})})},i=function(i){if(i){if(0===i.length)return;return i.prev().one("load",function(){t($(this).next())}),t(i),void(e=e.add(i))}t(e)};return e.prev().one("load",function(){t($(this).next())}),i(),$(window).resize(function(){i()}),i}),define("text!lib/helpers/viewer/photos.html",[],function(){return'<div class="viewer">\n\t{{# closable }}<p class="viewer-close-button"><a>[{{{ close_label }}}]</a></p>{{/ closable }}\n\t<div class="viewer-image-wrapper">\n\t\t<img class="viewer-loader" src="{{ static_host }}/v3/img/skins/default/xv-big-loader.gif">\n\t\t{{# next_prev }}\n\t\t<div class="viewer-next"><div class="viewer-next-image"></div></div>\n\t\t<div class="viewer-prev"><div class="viewer-prev-image"></div></div>\n\t\t{{/ next_prev }}\n\t</div>\n</div>'}),define("text!lib/helpers/viewer/photo.html",[],function(){return'<div class="viewer-image">\n\t<img src="{{ img_src }}" />\n\t<p>\n\t\t<span class="position">{{ position }}/{{ nb_pics }}</span>\n\t\t<strong>{{{ title }}}</strong>\n\t\t{{# error }}<span class="text-danger">{{{ error }}}</span>{{/ error }}\n\t</p>\n</div>'}),define("lib/helpers/viewer/photos",["mustache","text!./photos.html","text!./photo.html","lib/i18n!front"],function(e,t,i,n){var s=function(e){"function"==typeof e&&e.call(this)},o=function(e,t,i,n){if(e>i){var s=t/e;e=i,t=Math.round(i*s)}if(t>n){var s=e/t;t=n,e=Math.round(n*s)}return{width:e,height:t}},r=function(e,t,i){if(e.css("left","0"),t<i){var n=i-t;e.css("left",n/2+"px")}},a=function(e){return!("undefined"!=typeof e.complete&&!e.complete)&&("undefined"==typeof e.naturalWidth||0!=e.naturalWidth)},l={close_button:!1,other_links:{},insert_dom_selector:!1,insert_dom_jqfunc:"before",static_host:window.location.protocol+"//static-hw.xvideos.com"},d=function(i,s,o){this.settings=$.extend(l,o||{}),this.gallery=s,this.id_gal=i,this.opened=!1,this.current_idx=-1,this.current_image=!1,this.loading_idx=-1;var r=this.gallery.find(".thumb > a");this.node=$(e.render(t,{closable:this.settings.close_button,close_label:n.__("viewer.close"),next_prev:r.length>1,static_host:this.settings.static_host})),$(this.settings.insert_dom_selector?this.settings.insert_dom_selector:this.gallery)[this.settings.insert_dom_jqfunc](this.node),this.imgwrapper=this.node.find(".viewer-image-wrapper"),this.loader=this.node.find(".viewer-loader").hide();var a=this;this.settings.close_button&&(this.close_button=this.node.find(".viewer-close-button a"),this.close_button.click(function(e){e.preventDefault(),a.close()})),this.preloads=$('<div class="viewer-preloads"></div>').appendTo(document.body),this._resize(),this.node.hide(),this.images=[],r.each(function(e){var t=$(this);t.click(function(t){t.preventDefault(),a.openImage(e)}),a.images.push({image:t.attr("href"),error:!1,preloaded:!1,title:a.settings.title||t.find("img").attr("title"),size:!1,thumb_link:t});for(var i in a.settings.other_links){var n=a.settings.other_links[i];t.parents(n).find(i).click(function(e){e.preventDefault(),t.click()})}}),$(window).resize(function(){a._resize()}),this.images.length<=1||($(document).on("keydown",function(e){39==e.keyCode?a.nextImage():37==e.keyCode&&a.prevImage()}),a.node.on("click",function(){a.nextImage()}),this.next_link=this.node.find(".viewer-next").on("click",function(e){e.stopPropagation(),a.nextImage()}),this.prev_link=this.node.find(".viewer-prev").on("click",function(e){e.stopPropagation(),a.prevImage()}),this.prev_link.add(this.next_link).on("mouseover",function(){$(this).children().css("opacity",1)}).on("mouseout",function(){$(this).children().css("opacity",.7)}).children().css("opacity",.7))};return d.prototype={_resize:function(){if(this.imgwrapper_w=this.imgwrapper.width(),this.imgwrapper_maxh=$(window).height()-40,this.current_image){var e=this.imgwrapper.children(".viewer-image");this._resizeViewer(e,this.images[this.current_idx],e.children("img"))}},open:function(){this.opened||(this.node.show(),this.opened=!0)},close:function(){this.opened&&(this.node.hide(),this.gallery.find(".viewer-active").removeClass("viewer-active"),this.opened=!1)},openImage:function(e){this.opened||(d.manager.closeAll(),this.open()),this._showImage(e),$("html,body").animate({scrollTop:this.node.offset().top-50},500)},_showImage:function(e){if("undefined"!=typeof this.images[e]){this.loading_idx=e,this.loader.hide();var t=this.images[e];if(e===this.current_idx)return void this._highLightThumb(t.thumb_link);if(t.preloaded)this._onImageLoaded(e);else{this.loader.show();var i=this;this._preloadImage(e,function(){i._onImageLoaded(e)})}}},_onImageLoaded:function(t){if("undefined"!=typeof this.images[t]&&this.loading_idx===t){this.loader.hide();var s=this.images[t],o=$(e.render(i,{img_src:s.error?this.settings.static_host+"/v3/img/skins/default/xv-viewer-loading-error.png":s.image,position:t+1,nb_pics:this.images.length,title:s.title,error:!!s.error&&n.__("loading.error")+"!"})),r=o.children("img");this.imgwrapper.prepend(o),this._resizeViewer(o,s,r),this._highLightThumb(s.thumb_link),this.current_image&&this.current_image.remove(),this.current_idx=t,this.current_image=o,this.node.trigger("imageloaded",s)}},_preloadImage:function(e,t){if("undefined"!=typeof this.images[e]){var i=this.images[e];this.images[e].preloaded&&s(t);var n=$(new Image);if(n.attr("src",i.image),a(n[0]))return i.preloaded=!0,i.size={width:n[0].width,height:n[0].height},void s(t);this.preloads.append(n),n.load(function(){i.preloaded=!0,i.size={width:this.width,height:this.height},s(t)}).error(function(){i.error=!0,i.preloaded=!0,i.size=!1,s(t)})}},_resizeViewer:function(e,t,i){var n=o(t.error?300:t.size.width,t.error?300:t.size.height,this.imgwrapper_w,this.imgwrapper_maxh);return i.attr("width",n.width).attr("height",n.height),e.css({width:n.width+"px",height:n.height+"px"}),this.imgwrapper.css("height",n.height+"px"),r(e,n.width,this.imgwrapper_w),n},_highLightThumb:function(e){this.gallery.find(".viewer-active").removeClass("viewer-active"),e.addClass("viewer-active")},_getNextIndex:function(){return this.loading_idx===this.images.length-1?0:this.loading_idx+1},nextImage:function(){var e=this._getNextIndex();this._preloadImage(e+1),this._showImage(e)},_getPrevIndex:function(){return 0===this.loading_idx?this.images.length-1:this.loading_idx-1},prevImage:function(){var e=this._getPrevIndex();this._preloadImage(e-1),this._showImage(e)}},d}),define("lib/helpers/viewer/manager",["./photos"],function(e){var t=function(){this.instances={}};t.prototype={getOrCreate:function(t,i,n){var s=this.get(t);return s?s:(s=new e(t,$(i),n),this.instances[t]=s,s)},get:function(e){return"object"==typeof this.instances[e]?this.instances[e]:null},closeAll:function(){for(var e in this.instances)this.instances.hasOwnProperty(e)&&this.instances[e].close()}};var i=new t;return e.manager=i,i}),define("skins/default/profile/listing/friends",["config/main","lib/helpers/dom","skins/common/listing/loader"],function(e,t,i){var n=["friends","fans"],s=function(t){return e.data.user.url+"/"+t},o=function(e){this.container=e,this.loaders={},this.nodes={},this.type=!1,this.status="not_loaded"};return o.prototype={load:function(e){var o="friends",r=e.indexOf(",");if(r!==-1){var a=e.substr(r+1);"fans"===a&&(o=a)}if("not_loaded"===this.status){this.status="loading",this.type=o,this.nodes[o]=$("<div></div>").prependTo(this.container);var l=this,d=new i(o,this.nodes[o],s(o),!1,!0);return d.onLoaded=function(){l.loaders[o]=d,d.onLoaded=null;for(var e in n)o!==n[e]&&(l.nodes[n[e]]=$("<div></div>").prependTo(l.container).hide(),l.loaders[n[e]]=new i(n[e],l.nodes[n[e]],s(n[e]),!1,!0));l.status="loaded",l.type!==o?l.load("tabFriends,"+l.type):t.scrollToTop()},void d.load()}if("loaded"===this.status){if(this.type===o)return;this.nodes[this.type].hide(),this.nodes[o].show(),this.type=o,this.loaders[o].load(),t.scrollToTop()}this.type=o}},o}),define("skins/default/profile/vote/good_bad",["./total"],function(e){var t=function(t,i,n,s,o,r,a,l,d){this.vgood=i,this.vbad=n,e.apply(this,[t,s,o,r,a,l,d])};return t.prototype=new e,t.prototype._init_counts=function(){e.prototype._init_counts.call(this),this.counts_vgood=this.node.find(".rating-bar-block .good"),this.counts_vbad=this.node.find(".rating-bar-block .bad")},t.prototype._get_tpl_vars=function(){var t=e.prototype._get_tpl_vars.call(this);return t.vgood=this.vgood,t.vbad=this.vbad,t.disp_good_bad=!0,t},t.prototype._update_counts=function(t){e.prototype._update_counts.call(this,t),this.counts_vgood.text(t.vgood),this.counts_vbad.text(t.vbad)},t}),define("text!skins/default/profile/action/comment_form.html",[],function(){return'<form>\n\t<div class="form-group">\n\t\t<label for="profile-comment-content">{{{ label }}}:</label>\n\t\t<textarea class="form-control" id="profile-comment-content" name="comment[content]" rows="5"></textarea>\n\t</div>\n\t<div class="text-right">\n\t\t<button type="button" class="btn btn-default btn-sm">{{{ btn_label }}}</button>\n\t</div>\n</form>'}),define("text!skins/default/profile/action/comment.html",[],function(){return'<div class="comment" data-id="{{ post.id_post }}">\n\t<a href="/profiles/{{ post.author }}" class="thumb">\n\t\t<img width="60" height="60" onerror="this.src=\'{{ static_host }}/img/profile_default_small.jpg\';this.onerror=null" src="{{ post.thumb }}" class="no-rotate" />\n\t</a>\n\t<h4>\n\t\t<a href="/profiles/{{ post.author }}"{{# post.is_owner }} class="text-danger"{{/ post.is_owner }}>{{ post.author_display }}</a>\n\t\t- {{{ post.date }}}\n\t\t{{^ post.validated }}- <em class="text-warning">{{{ pending_validation }}}</em>{{/ post.validated }}\n\t</h4>\n\t<div class="content">\n\t\t{{{ post.text }}}\n\t</div>\n</div>'}),define("skins/default/profile/action/comment_form",["config/main","mustache","static/utils","lib/helpers/inline_loader","skins/default/profile/action/link","lib/i18n!front","text!skins/default/profile/action/comment_form.html","text!skins/default/profile/action/comment.html"],function(e,t,i,n,s,o,r,a){var l=function(l){this.node=$(t.render(r,{label:o.__("profile.comments.leave_comment"),btn_label:o.__("profile.comments.send")}));var d=this,c=new s(this.node.find("button"),"/profiles/"+e.data.user.username+"/comments/post",!1,!0,l);c.validate=function(){var e=$.trim($("#profile-comment-content").val()),t=!1;return 0===e.length?t=o.__("profile.comments.please_enter_comment"):e.length>1500?t=o.__("profile.comments.comment_too_long",{"%nb_chars%":1500}):(e.match(/\n/g)||[]).length>10&&(t=o.__("profile.comments.too_many_lines",{"%nb_lines%":10})),t?(window.alert(i.unescape(t)),$("#profile-comment-content").focus().css("border-color","#DE2600"),!1):($("#profile-comment-content").css("border-color",""),!0)},c.getPost=function(){return{text:$.trim($("#profile-comment-content").val())}},c.onSuccess=function(i){if(i.message){var s=i.result?"text-success":"text-danger";n.get(d.node,!0).setContent('<strong class="'+s+'">'+i.message+"</strong>").show()}$("#profile-comment-content").css("border-color",""),i.result&&d.node[0].reset(),$("#profile-comments").prepend(t.render(a,{post:i.post,pending_validation:o.__("misc.pending_validation"),static_host:e.domains["static"]}))}};return l.prototype={posted:null,getNode:function(){return this.node}},l}),define("skins/default/profile/listing/comments",["config/main","./infinite","../action/link","skins/default/profile/action/report","lib/i18n!front"],function(e,t,i,n,s){var o=function(t){t.each(function(){var t=$(this),o=t.find(".delete"),r=t.find(".report"),a=t.data("csrf");if(o.length>0){var l=new i(o,"/profiles/"+e.data.user.username+"/comments/"+t.data("id")+"/delete",s.__("misc.are_you_sure"),!1,a["delete"]);l.onSuccess=function(){t.remove()}}r.length>0&&new n("comment",r,$("#page"),t.data("id"),a.report)})},r=function(e,i){t.apply(this,["comments",e,i,!1,"load-more-wall-comments",s.__("profile.loading_next_comments"),"profile-comments"]);
};return r.prototype=new t,r.prototype.on_first_load=function(){o($("#profile-comments").children());var e=$("#profile-comments-form-login");if(e.length>0)return void require(["skins/default/form/login_create"],function(t){var i=$('<a class="text-danger">'+s.__("misc.click_here_login_create_account")+"</a>").appendTo(e.append(document.createTextNode(" ")));t.setup_links(i)});var t=$("#profile-comments-form");return t.length>0?void require(["skins/default/profile/action/comment_form"],function(e){var i=new e(t.data("csrf"));i.getNode().appendTo(t)}):void 0},r.prototype.on_next_load=function(e){o(e)},r}),define("text!skins/default/video/share.html",[],function(){return'<div class="addthis_toolbox addthis_default_style addthis_32x32_style">\n\t<a class="addthis_button_preferred_1"></a>\n\t<a class="addthis_button_preferred_2"></a>\n\t<a class="addthis_button_preferred_3"></a>\n\t<a class="addthis_button_preferred_4"></a>\n\t<a class="addthis_button_preferred_5"></a>\n\t<a class="addthis_button_preferred_6"></a>\n\t<a class="addthis_button_preferred_7"></a>\n\t<a class="addthis_button_preferred_8"></a>\n\t<a class="addthis_button_preferred_9"></a>\n\t<a class="addthis_button_preferred_10"></a>\n\t<a class="addthis_button_preferred_11"></a>\n\t<a class="addthis_button_compact"></a>\n\t<a class="addthis_counter addthis_bubble_style"></a>\n</div>'}),define("skins/default/profile",["config/main","./search/autocomplete"],function(e){"undefined"!=typeof e.data.user&&require(["lib/helpers/dom","lib/tab","skins/default/profile/tabs/aboutme","lib/i18n!front","lib/helpers/thumbs_rotator","skins/default/profile/title_actions"],function(t,i,n,s){var o={},r=$("#tabVideos");if(r.length>0){var a;o.tabVideos={},o.tabVideos.action=function(t){if(a)return void a.load(t);require(["skins/default/profile/listing/videos"],function(e){a=new e($("<div></div>").prependTo(r)),a.load(t)});var i=$("#privacy-edit-videos");i.length>0&&require(["skins/default/profile/action/popup_form"],function(t){var n=new t(i),o=[];o.push({opt_value:"ANYONE",opt_label:s.__("misc.everybody")}),o.push({opt_value:"FRIEND",opt_label:s.__("profile.allow.friends")}),o.push({opt_value:"NOBODY",opt_label:s.__("profile.allow.nobody")}),n.addSetting(s.__("profile.privacy.who_can_view_videos"),"profile[upload_access]",o,e.data.user.access.upload)})},o.tabVideos.subhashes=["videos-new","videos-best","videos-rating","videos-pornstar"]}var l=function(){},d=$("#tabActivity");if(d.length>0){var c;l=function(){c||require(["skins/default/profile/listing/infinite","skins/default/profile/images"],function(t,i){c=new t("activity",d,e.data.user.url+"/activity",!0,"load-more-activities",s.__("profile.loading_more_activities"),"profile-activities"),c.on_first_load=function(){i(d.find(".img-block .gif-tag"))},c.on_next_load=function(e){i(e.find(".img-block .gif-tag"))},c.load()})},o.tabActivity=l}o.tabAboutMe=function(){n(),$("#goto-activity").on("click",function(e){e.preventDefault(),$("#tab-activity").click()})};var h=$("#tabPhotos");if(h.length>0){var u=!1;o.tabPhotos=function(){if(!u){u=!0;var t=h.find(".img-block");0!==t.length&&require(["lib/helpers/viewer/manager","skins/default/profile/vote/total","skins/default/profile/action/link","skins/default/profile/images"],function(i,n,o){t.each(function(){var t=$(this),s=t.data("galid"),o=e.data.galleries[s];1===o.nb_pics&&t.on("click",function(r){r.preventDefault(),t.off("click");var a=i.getOrCreate(s,t,{close_button:!0,other_links:{".img-block":"p a"},insert_dom_selector:"#profile-galleries > h4",insert_dom_jqfunc:"after",title:o.title,static_host:e.domains["static"]});"string"==typeof o.vrating&&a.node.on("imageloaded",function(){var e=new n($("<div></div>").appendTo(a.node.find(".position").empty()),o.rating,o.vrating,o.total,o.visitor_vote);e.initPostData("/profiles/"+o.owner+"/galleries/"+s+"/vote/good","/profiles/"+o.owner+"/galleries/"+s+"/vote/bad",{csrf:o.csrf}),e.setPopupPosition("above","left")}),a.openImage(0)})});var r=$("#delete-verified-picture");if(r.length>0){r.on("click",function(e){e.stopPropagation()});var a=new o(r,"/profiles/"+e.data.user.username+"/unverify",s.__("profile.unverify.confirm"),!1,e.data.user.csrf.uunverify);a.onSuccess=function(){r.parents(".img-block").remove(),window.location.reload()}}})}}}var f=$("#tabFriends");if(f.length>0){var p=[];e.data.user.has_friends&&p.push("friends"),e.data.user.has_fans&&p.push("fans");var g;o.tabFriends={},o.tabFriends.action=function(t){if(g)return void(p.length>1&&g.load(t));p.length>1?require(["skins/default/profile/listing/friends"],function(e){g=new e(f),g.load(t)}):require(["skins/common/listing/loader"],function(t){g=new t(p[0],$("<div></div>").prependTo(f),e.data.user.url+"/"+p[0],!1,!0),g.load()});var i=$("#privacy-edit-friends");i.length>0&&require(["skins/default/profile/action/popup_form"],function(t){var n=new t(i),o=[];o.push({opt_value:"ALLOW",opt_label:s.__("misc.everybody")}),o.push({opt_value:"FRIEND_OF_FRIEND",opt_label:s.__("profile.allow.friends_of_friends")}),o.push({opt_value:"BLOCKED",opt_label:s.__("profile.allow.nobody")}),n.addSetting(s.__("profile.privacy.who_can_friend_request"),"profile[friend_request]",o,e.data.user.access.friend_requests),o=[],o.push({opt_value:"ANYONE",opt_label:s.__("misc.everybody")}),o.push({opt_value:"REGISTER",opt_label:s.__("profile.allow.only_registered")}),o.push({opt_value:"FRIEND",opt_label:s.__("profile.allow.friends")}),o.push({opt_value:"NOBODY",opt_label:s.__("profile.allow.nobody")}),n.addSetting(s.__("profile.privacy.who_can_view_friends"),"profile[friend_list_access]",o,e.data.user.access.friends)})},p.length>1&&(o.tabFriends.subhashes=["friends","fans"])}var _=$("#favs-container");if(_.length>0){var v;o.tabFavorites=function(){if(!v){require(["skins/common/listing/loader/paginated","skins/default/profile/vote/good_bad"],function(i,n){v=new i("favorites",_,e.data.user.url+"/favorites",!0);var s=!0;v.get_loader_containers=function(){return s?(s=!0,this.container.find(".favorites")):this.container},v.onLoaded=function(){var i=e.data.user.id_user;$(".fav-list-votes").each(function(){var e=$(this),t=e.data("vote"),s=e.data("id"),o=new n(e,t.vgood,t.vbad,t.rating,t.vrating,t.total,t.visitor_vote);o.initPostData("/favorite/vote/"+s+"/"+i+"/GOOD","/favorite/vote/"+s+"/"+i+"/BAD",{csrf:t.csrf})}),t.scrollToTop()},v.load()});var i=$("#profile-favs-add");i.length>0&&require(["static/utils","skins/default/profile/action/popup_form"],function(t,n){var o=new n(i,s.__("video.favs.add_new"),s.__("video.favs.create_list")),r=[];r.push({opt_value:"ANYONE",opt_label:s.__("profile.allow.public")}),r.push({opt_value:"REGISTER",opt_label:s.__("profile.allow.registered")}),r.push({opt_value:"FRIEND",opt_label:s.__("profile.allow.friends")}),r.push({opt_value:"NOBODY",opt_label:s.__("profile.allow.nobody")}),o.addSetting(s.__("video.favs.visibility"),"status",r,"ANYONE"),o.addInput(s.__("user.name"),"name"),o.setMessages(s.__("video.favs.fav_created"),s.__("video.favs.creating")),o.setRequestParams("/favorite/create",function(){var e=$("#profile-favs-add-name"),i=$.trim(e.val());return i.length<3?(window.alert(t.unescape(s.__("video.favs.min_length",{"%nb_chars%":"3"}))),e.focus().css("border-color","#DE2600"),!1):(e.css("border-color",""),!0)},e.data.user.csrf.favcreate)})}}}var m=$("#tabComments");if(m.length>0){var b;o.tabComments=function(){if(!b){require(["skins/default/profile/listing/comments"],function(t){b=new t($("<div></div>").prependTo(m),e.data.user.url+"/comments"),b.load()});var t=$("#privacy-edit-comments");t.length>0&&require(["skins/default/profile/action/popup_form"],function(i){var n=new i(t),o=[];o.push({opt_value:"REGISTER",opt_label:s.__("profile.allow.only_registered")}),o.push({opt_value:"FRIEND",opt_label:s.__("profile.allow.friends")}),o.push({opt_value:"NOBODY",opt_label:s.__("profile.allow.nobody")}),n.addSetting(s.__("profile.privacy.who_can_comment"),"profile[wall_access]",o,e.data.user.access.wall)})}}}var y=!1;o.tabShare=function(){y||require(["static/utils","text!skins/default/video/share.html"],function(e,t){y=!0,$("#tabShare").append(t),window.addthis_config=window.addthis_config||{},window.addthis_config.pubid="xa-501f7bd44d12cd79",e.loadScript("//s7.addthis.com/js/250/addthis_widget.js#async=1",{async:"async"},{load:function(){window.addthis.init()}})})},new i("#profile-tabs",o,!1,!0,"class")})}),define("skins/default/profile_gallery",["config/main","./search/autocomplete"],function(e){"undefined"!=typeof e.data.user&&require(["config/main","lib/tools","lib/helpers/viewer/manager","skins/default/profile/vote/good_bad","skins/default/profile/title_actions","skins/default/profile/images"],function(e,t,i,n){var s=e.data.gal,o=new n($("#gal-list-votes"),s.vgood,s.vbad,s.vrating,s.rating,s.total,s.visitor_vote);o.initPostData("/profiles/"+s.owner+"/galleries/"+s.id_gal+"/vote/good","/profiles/"+s.owner+"/galleries/"+s.id_gal+"/vote/bad",{csrf:s.csrf}),i.getOrCreate(s.id_gal,$("#tabPhotos .thumb-mozaique"),{title:s.title,static_host:e.domains["static"]});var r=t.getUrlHash();if(r.length>0&&r.match(/^galpic-\d+$/g)){var a=$("#"+r+" .thumb > a");1===a.length&&a.click()}})}),define("skins/default/form/region_select",["lib/helpers/inline_loader"],function(e){var t={},i=function(e){var t=[];for(var i in e)t.push({code:i,name:e[i]});return t.sort(function(e,t){return e.name>t.name?1:-1}),t},n=function(e,t){var i=$(e);if(this.region=$(t),0!==i.length&&0!==this.region.length){this.loader=null,this.error=null;var n=this;i.on("change",function(){n.on_change($.trim($(this).val()))}),i.val().length>0&&this.region.children().length<2&&i.trigger("change")}};return n.prototype={on_change:function(e){if(this.region.empty().append('<option value=""></option>'),!e)return void this.set_regions({});if("undefined"!=typeof t[e])return void this.set_regions(t[e]);this.show_loader();var n=this;$.getJSON("/account/getregions/",{country:e},function(s){if(!s.success)return void n.set_error(s.message);var o=i(s.regions);t[e]=o,n.set_regions(o)}).error(function(){n.set_error("An error occured!")}).complete(function(){n.hide_loader()})},show_loader:function(){return this.loader?void this.loader.show():void(this.loader=e.get().getNode().appendTo(this.region.parent().prev()))},hide_loader:function(){this.loader.hide()},set_regions:function(e){this.region.nextAll(".help-block.text-danger").remove();for(var t in e)this.region.append('<option value="'+e[t].code+'">'+e[t].name+"</option>");this.region.prop("disabled",0===e.length)},set_error:function(e){this.region.prop("disabled",!0),this.error||(this.error=$('<span class="help-block text-danger"></span>').insertAfter(this.region)),this.error.show().html(e)},hide_error:function(){this.error&&this.error.hide()}},n}),define("skins/default/form/range_select",[],function(){var e=function(e){if(this.min=$("#"+e+"_min"),this.max=$("#"+e+"_max"),0!==this.min.length&&0!==this.max.length){this.error=null;var t=this;this.min.on("change",function(){t.on_change()}),this.max.on("change",function(){t.on_change()}),this.min.trigger("change")}};return e.prototype={on_change:function(){this.hide_error();var e=parseInt(this.min.val()),t=parseInt(this.max.val());0!==e&&0!==t&&(e<=t||this.set_error("Right side must be greater than left side"))},set_error:function(e){this.error||(this.error=$('<span class="help-block text-danger"></span>').insertAfter(this.max)),this.error.show().html(e)},hide_error:function(){this.error&&this.error.hide()}},e}),define("skins/default/profiles",["./form/region_select","./form/range_select","./search/autocomplete","lib/helpers/thumbs_rotator"],function(e,t){new e("#country_select","#region_select"),new t("age_range-select"),$("#profile-search-filters-summary").find(".btn,.value").on("click",function(){$("#profile-search-form").toggleClass("expanded contracted")})}),define("skins/default/profiles_clicksort",["./profiles"],function(){}),define("skins/default/profiles_index",["./profiles"],function(){}),define("skins/default/form/unit_select",["lib/converter"],function(e){var t=function(e,t){this.options=$(e).children(),this.val_unit=t};return t.prototype={convert:function(t,i){var n=this;this.options.each(function(){var s=$(this),o=parseFloat(s.val());0!==o&&(t!==n.val_unit&&(o=e.convert(o,n.val_unit,t,0,i)),s.text(o+" "+t))})}},t}),define("skins/default/profiles_search",["config/main","./form/range_select","./form/unit_select","./profiles"],function(e,t,i){$("#profile-search-advanced").on("click",function(e){e.preventDefault(),$("#profile-search-form").removeClass("display-compact display-create-account display-create-profile").addClass("display-advanced"),$(this).hide()}),new t("height_range-select"),new t("width_range-select");var n=$("#switch-search-body-unit");if(n.length>0){var s=e.data.body_unit,o=new i("#height_range-select_min,#height_range-select_max","cm"),r=new i("#weight_range-select_min,#weight_range-select_max","kg");n.on("click",function(t){t.preventDefault();var i="EU"===s?"US":"EU";n.html(e.data.body_unit_switch[i]),$("#search-body-unit").val(i),o.convert("US"===i?"in":"cm",1),r.convert("US"===i?"lbs":"kg",0),s=i})}}),define("skins/default/profiles_videos",["./search/autocomplete","lib/helpers/thumbs_rotator"],function(){}),define("skins/default/tag",["lib/helpers/thumbs_rotator","./search/autocomplete"],function(){var e,t,i=$("#search-page-filters-block"),n=!1;e=i.find(".btn,.selected a").on("click",function(s){s.preventDefault(),i.toggleClass("expanded"),e.html(n?t:"Hide filters&#9650;"),n=!n}).filter(".btn"),t=e.html()}),define("skins/default/search",["./tag"],function(){var e=$("#search-associates");e.find(".show-more a").on("click",function(){e.toggleClass("mobile-expanded")})}),define("skins/default/tags",["lib/tools","./search/autocomplete"],function(e){var t,i=!1,n=$("#filter-tags-input"),s="";0!==n.val().length||"#gay"!==window.location.hash&&"#shemale"!==window.location.hash||n.val(window.location.hash.substr(1));var o=function(){i||(i=!0,t=$("#tags li").each(function(){$(this).data("tag",$.trim(e.translit($(this).find("b").text())))}))},r=function(){o();var i=$.trim(e.translit(n.val()));if(i!==s)return s=i,0===i.length?void t.removeClass("hidden"):void t.each(function(){$(this).toggleClass("hidden",$(this).data("tag").indexOf(i)===-1)})};n.on("keyup",r),n.val().length>0&&r()}),define("skins/common/video/comments/form",["config/main","mustache","lib/tools","lib/helpers/inline_loader","lib/helpers/overlay/box","lib/i18n!front"],function(e,t,i,n,s,o){var r=function(r,a,l){var d={upload_domain:e.domains.master,static_domain:e.domains["static"],has_profile:"undefined"!=typeof e.data.login_info.profile&&e.data.login_info.profile!==!1&&0!==e.data.login_info.profile.length,labels:o.__("video.comments.*"),csrf:e.data.commentscsrf};l&&!d.has_profile||(d.is_form=!0,d.has_profile&&(d.profile=e.data.login_info.profile,d.pu=e.data.login_info.profile_url,d.iu=e.data.login_info.profile_img,d.n=i.ucfirst(e.data.login_info.profile))),this.node=$(t.render(r,d,{comment:a}));var c,h=!1,u=this,f=this.node.children("form"),p=function(e){if(e.message){var t=e.result?"text-success":"text-danger";s.get(u.getNode(),!0).setContent('<strong class="'+t+'">'+e.message+"</strong>").show()}e.result&&"function"==typeof u.posted&&u.posted(),e.result&&f[0].reset()},g=function(){if(!h){c||(c=s.get(u.getNode(),!1,"hide").setContent(n.getSafe("after",o.__("video.comments.posting")).getHtml())),c.show();var t=f.serializeArray();t.push({name:"test",value:"ok"}),$.post("/video-post-comment/"+e.data.id_video+"/",t,p,"json").fail(function(){s.get(u.getNode(),!0).setContent('<strong class="text-danger">'+o.__("video.comments.post_failed")+"</strong>").show()}).always(function(){c.hide()})}};this.node.find("button").on("click",g)};return r.prototype={posted:null,getNode:function(){return this.node}},r}),define("skins/common/video/comments",["config/main","mustache","lib/helpers/dom","lib/helpers/pager","lib/helpers/overlay/box","lib/helpers/inline_loader","lib/i18n!front"],function(e,t,i,n,s,o,r){var a,l,d,c,h,u,f,p,g,_=!1,v=[],m=e.data.nb_comments,b=!1,y=function(){for(var e in v)v[e].node.remove(),v[e].pager&&v[e].pager.remove();v=[],b=!1},w=function(e){b!==!1&&(v[b].node.toggle(e),v[b].pager&&v[b].pager.toggle(e))},k=function(){return u||(u=s.get(l,!1,"hide").setContent(o.get("after",r.__("video.loading_comments")).getNode())),u},x=function(){f&&k().show()},T=function(e){e.preventDefault(),E(parseInt($(this).attr("href").substr(1)))},C=function(s){if(0===e.data.nb_comments&&0===v.length&&d.empty(),m!==s.nb_comments?y():w(!1),e.data.uploader)for(var o in s.comments)"string"==typeof s.comments[o].p&&s.comments[o].p.length>0&&(s.comments[o].is_uploader=s.comments[o].p===e.data.uploader);var r=$(t.render(p,s,{tpl:g})).appendTo(d);v[s.page]={node:r},s.pagination&&(v[s.page].pager=n.get(s.pagination).appendTo(d).on("click","a",T)),i.scrollToTop(a.offset().top-300),c.text(s.nb_comments),s.nb_comments>2&&h.show(),b=s.page,m=s.nb_comments,f=!1},E=function(t){("undefined"==typeof t||isNaN(t))&&(t=0),f||t===b||("undefined"!=typeof v[t]?(w(!1),b=t,w(!0),i.scrollToTop(a.offset().top-300)):(f=!0,window.setTimeout(x,500),$.post("/video-get-comments/"+e.data.id_video+"/"+t+"/",C,!1).fail(function(e,t,i){console.error("DEBUG failed loading comments: "+t+": "+i),s.get(l,!0).setContent('<strong class="text-danger">'+r.__("video.failed_loading_comments_retry")+"</strong>").show()}).complete(function(){f=!1,k().hide()})))};return function(t,n,s,o){if(!_)return _=!0,p=t,g=n,a=$("#tabComments"),l=$("#comments-container"),d=$("#comments"),c=$("#video-tabs .nb-video-comments"),h=$("#video-post-comment"),h.on("click",function(){i.scrollToTop(a.children(".tab-form").offset().top-300)}),e.data.nb_comments<=2&&h.hide(),e.data.nb_comments>0&&E(),!o||e.data.login_info.is_logged?void require(["skins/common/video/comments/form"],function(e){var t=new e(s,n,o);t.posted=function(){y(),E(0)},a.append(t.getNode())}):void o(a)}}),define("text!skins/default/video/comments/page.html",[],function(){return"<div>{{#comments}}{{> tpl}}{{/comments}}</div>\n"}),define("text!skins/default/video/comments/comment.html",[],function(){return'<div class="comment">\n\t<div class="profile-pic">\n\t\t{{# p }}<a href="{{{ pu }}}"><img src="{{{ iu }}}" onerror="this.src=\'{{{ static_domain }}}/img/profile_default_small.jpg\'" /></a>{{/ p }}\n\t\t{{^ p }}<div><img src="{{{ static_domain }}}/img/profile_default_small.jpg" /></div>{{/ p }}\n\t\t{{# is_form }}<button type="button" class="btn btn-default">{{{ labels.comment_action }}}</button>{{/ is_form }}\n\t</div>\n\t<div class="bg-title grey no-border">{{# p }}<a href="{{{ pu }}}"{{# is_uploader }} class="is-uploader"{{/ is_uploader }}>{{/ p }}{{ n }}{{# p }}</a>{{/ p }}{{# d }} - <span class="date">{{ d }}</span>{{/ d }}</div>\n\t<div class="comment-text">{{# is_form }}<textarea name="comment" rows="4" class="form-control" required></textarea>{{/ is_form }}{{^ is_form }}{{{ c }}}{{/ is_form }}</div>\n</div>'}),define("text!skins/default/video/comments/form.html",[],function(){return'<div class="tab-form">\n\t{{# has_profile }}\n\t<form id="video-comment-form">\n\t\t<input type="hidden" name="user" value="{{ profile }}" />\n\t\t<input type="hidden" name="csrf" value="{{ csrf }}" />\n\t\t{{> comment}}\n\t</form>\n\t{{/ has_profile }}\n\t{{^ has_profile }}\n\tTo comment videos, <a href="{{ upload_domain }}/account/create_profile"><b>please setup your profile</b></a>.\n\t{{/ has_profile }}\n</div>'}),define("skins/default/video/comments",["skins/common/video/comments","text!./comments/page.html","text!./comments/comment.html","text!./comments/form.html","lib/i18n!front"],function(e,t,i,n,s){return function(){e(t,i,n,function(e){require(["skins/default/form/login_create"],function(t){t.setup_links($('<h4 class="text-danger">'+s.__("video.must_be_logged_to_comment")+' <a class="text-danger">'+s.__("misc.click_here_login_create_account")+"</a></h4>").appendTo(e).children("a"))})})}}),define("skins/common/video/download",["config/main","lib/helpers/inline_loader","lib/i18n!front"],function(e,t,i){var n=function(){this.displayed=!1};return n.prototype={check:function(){this.displayed||(this.displayed=!0,this.contener=$("#tabDownload"),this.messages=i.__("video.download.*"),this.check_download())},on_not_logged:function(){console.error("download.on_not_logged not implemented")},on_checked:function(e){if(!e.LOGGED)return void this.on_not_logged();var t=$("<p>").addClass("text-center");if("string"==typeof e.ERROR)t.addClass("text-danger").html(e.ERROR);else if("string"!=typeof e.URL){var i=this;t.addClass("text-danger").html(this.messages.error_occured_retry.replace("%here%",'<a href="#"><strong>'+this.messages.here+"</strong></a>")).find("a").on("click",function(e){i.check_download(e)})}else{var n=this.messages.ready;e.URL_LOW?(n+=" "+this.messages.click_to_get.replace("%high_or_low_quality%",'<a href="'+e.URL+'" target="_blank"><strong>'+this.messages.high_qual+"</strong></a>"),n+=" "+this.messages.click_to_get.replace("%high_or_low_quality%",'<a href="'+e.URL_LOW+'" target="_blank"><strong>'+this.messages.low_qual+"</strong></a>")):n+=" "+this.messages.click_to_get.click_to_get_dl.replace("%here%",'<a href="'+e.URL+'"><strong>'+this.messages.here+"</strong></a>"),t.addClass("download-ready").html(n)}this.contener.empty().append(t)},check_download:function(i){"undefined"!=typeof i&&i.preventDefault(),this.contener.append($("<p>").addClass("text-danger text-center").append(t.getSafe("after",this.messages.checking).getNode()));var n=this;$.post("/video-download/"+e.data.id_video+"/",function(e){n.on_checked(e)},!0,"json").fail(function(){this.contener.empty().append($("<p>").addClass("text-danger text-center").html(this.messages.error_occured_retry.replace("%here%",'<a href="#">'+this.messages.here+"</a>"))).find("a").on("click",function(e){n.check_download(e)})})}},n}),define("skins/default/video/download",["skins/common/video/download","lib/i18n!front"],function(e,t){var i=new e;return i.on_not_logged=function(){var e=this;require(["skins/default/form/login_create"],function(i){i.setup_links($('<h4 class="text-center text-danger">'+t.__("video.must_have_account_to_download")+' <a class="text-danger">'+t.__("misc.click_here_login_create_account")+"</a></h4>").appendTo(e.contener.empty()).children("a"))})},function(){i.check()}}),define("skins/common/video/vote",["config/main","lib/helpers/inline_loader","lib/helpers/popup","lib/i18n!front"],function(e,t,i,n){var s,o=$("#video-views-votes,#video-votes"),r=o.find(".vote-actions a"),a=!1,l=null,d=null,c=function(e,t){return s?s.setButton(e).setContent(t):s=new i(e,t,{relative_to:o.parent(),position:{v:"below",h:"left"},trigger:!1}),s};r.on("click",function(i){if(i.preventDefault(),!a){a=!0;var s=$(this),h=s.html(),u=s.hasClass("vote-action-good"),f=u?e.data.vote_urls.good:e.data.vote_urls.bad;r.addClass("disabled"),s.html(t.getImg()),$.post(f,function(e){s.html(h);var t;if(e.result){o.find(".rating-bar .total").text(e.total),o.find(".rating-bar .pgs-bar div").css("width",e.rating+"%");var i=o.find(".rating-box"),a=i.children("span").not(".decimals"),d=e.rating.toFixed(2).split(".");1===d.length&&d.push("00"),i.html(d[0]+'<span class="mobile-hide">.'+d[1]+"</span>%").prepend(a),r.filter(".vote-action-good").children(".value").text(e.vgood),r.filter(".vote-action-bad").children(".value").text(e.vbad),"function"==typeof l&&(t=l(u)),t||(t=n.__("video.votes.thanks")),t="<strong>"+t+"</strong>"}else t='<strong class="text-danger">'+e.message+"</strong>";c(s,t).open()},"json").fail(function(){s.html(h),c(s,'<strong class="text-danger">'+n.__("error.err_please_reload")+"</strong>").open()}),e.data.login_info.is_logged||"function"!=typeof d||d(u)}});var h=function(e,t){l=e,d=t};return h}),define("text!skins/common/video/playlist.html",[],function(){return'<div id="video-playlist">\n\t<div id="playlist-header" class="hidden">\n\t\t<button class="btn btn-default pull-right next" title="{{{ labels.next }}}">&gt;</button>\n\t\t<button class="btn btn-default pull-right toggle" title="{{{ labels.hide }}}">&#9650;</button>\n\t\t<button class="btn btn-default pull-left prev" title="{{{ labels.prev }}}">&lt;</button>\n\t\t<div class="playlist-vote"></div>\n\t\t<h4></h4>\n\t</div>\n\t<div id="playlist-content">\n\t\t<div class="mozaique thumbs-5"></div>\n\t</div>\n</div>'}),define("skins/common/video/playlist",["config/main","mustache","static/utils","lib/tools","lib/helpers/inline_loader","lib/helpers/popup","lib/helpers/thumbs_rotator","text!./playlist.html","lib/i18n!front"],function(e,t,i,n,s,o,r,a,l){var d=n.parseUrl(window.location.href,"query",!0),c=0;if("undefined"!=typeof d.pl){var h=!1;if(0===d.pl.search(/^\d+$/)){if(c=parseInt(d.pl),c<0)return}else{if(0!==d.pl.search(/^-[\da-z]+$/))return;c=d.pl,h=!0}var u=window.location.pathname.split("/"),f=h?u[1].substr(5):parseInt(u[1].substr(5)),p="favorite";if("string"==typeof d.pltype){if("related"!==d.pltype)return;p=d.pltype}var g,_,v,m,b,y,w,k,x,T,C,E,S,N,O,I=l.__("playlist.*"),A=!1,M=!1,q=!1,D=0,R=null,P=!1,j=!1,L=!1,H=!1,W=0,z=!1,Y=!1,U=!1,X=!1,F=!0,V=function(e,t){var i;return i="related"===p?"/video"+c+"/related/playlist/"+e:"/favorite/"+c+"/playlist/"+e,t&&(i+="/"+t),i},B=function(e,t){var i="";t&&(i=' class="text-danger"'),H?H.setContent("<strong"+i+">"+e+"</strong>"):H=new o(y,"<strong"+i+">"+e+"</strong>",{trigger:!1,position:{v:"below",h:"right"},relative_to:$("#video-playlist")}),H.open()},G=function(e,t){var i="";t&&(i=' class="text-danger"'),j?j.setContent("<strong"+i+">"+e+"</strong>"):j=new o(w,"<strong"+i+">"+e+"</strong>",{trigger:!1,position:{v:"below",h:"left"},relative_to:$("#video-playlist")}),j.open()},J=function(e,t,i){"after"===e?B(t,i):G(t,i)},K=function(){H&&H.close(),j&&j.close()},Z=function(){var e=v.width();T=x.outerWidth(),C=Math.round(e/T),E=2,C<=2?E=0:C<=4&&(E=1)},Q=function(e,t){if(!O){var n;if("next"===e){if(n=R+C,n+2*C>=W&&se(),n>W-C){if(!L)return;if(n=W-C,n===R)return}}else if("prev"===e){if(n=R-C,n-2*C<=0&&oe(),n<0){if(!P)return;if(n=0,0===R)return}}else n=e;"string"==typeof e&&(q=!0),A=n===W-C&&X&&L,y.toggleClass("invisible",A),M=0===n&&X&&P,w.toggleClass("invisible",M),R=n,k.addClass("disabled").css("cursor","wait"),R+C>W-C&&!L&&z&&y.html(s.getImg()).prop("title",i.unescape(I.loading_next)),R-C<0&&!P&&Y&&w.html(s.getImg()).prop("title",i.unescape(I.loading_prev));var o=function(){(R+C<=W-C||L||!z)&&(A=R+C===W&&L,y.html("&gt;").toggleClass("disabled",A).css("cursor","").toggleClass("invisible",A)),(R-C>=0||P||!Y)&&(M=0===R&&P,w.html("&lt;").toggleClass("disabled",M).css("cursor","").toggleClass("invisible",M)),O=!1,U&&U()};t?(x.css("margin-left","-"+R*T+"px"),o()):(O=!0,x.animate({"margin-left":"-"+R*T+"px"},"false",o))}},ee=function(){return!q&&(Q(Math.max(0,Math.min(D-E,W-C)),!0),!0)},te=function(){m.html('<p class="text-center"><strong><a href="#" class="text-danger">'+I.failed_loading_retry+"</a></strong></p>").find("a").on("click",function(e){return e.preventDefault(),ie(),!1})},ie=function(){return g=$(t.render(a,{labels:I})),_=g.find("#playlist-header"),v=g.find("#playlist-content"),m=v.children(".mozaique"),b=_.children("button.toggle"),y=_.children("button.next"),w=_.children("button.prev"),k=y.add(w),m.html('<p class="text-center">'+s.getSafe("after",I.loading).getHtml()+"</p>"),$.post(V(f),function(t){if(t.result){"object"==typeof html5player&&"function"==typeof html5player.setPlaylist&&html5player.setPlaylist(t.title,t.url,t.videos,t.nb_videos,t.position);var s=t.title;"default"===t.title.toLowerCase()&&(s=I.playlist);var o='<span class="icon playlist" '+I.playlist+'></span> <a href="'+t.url+'">'+s+"</a>";t.user&&!t.is_owner&&(o+=" <small>"+l.__("misc.by_user",{"%user%":'<a href="/profiles/'+t.user+'">'+t.username+"</a>"})+"</small>"),o+=' <span class="badge">'+t.nb_videos_str+"</span>",_.removeClass("hidden").children("h4").html(o);var a=$(n.replaceThumbcast(t.html));m.html(a),r(a,!0);var d="xnxx"===e.sitename?I.playing_video_x.replace("%video_idx%",(t.position+1).toFixed(0)).replace("%nb_videos%",t.nb_videos.toFixed(0)):I.now_playing;return m.children(":eq("+t.posinlist+")").addClass("selected").find(".thumb-inside").append('<div class="thumb-overlay"><p>'+d+"</p></div>"),P=t.start_reached,L=t.end_reached,W=t.videos.length,x=m.children().first(),S=t.videos[0].id,N=t.videos[W-1].id,R=t.posinlist,D=R,Z(),ee(),b.on("click",function(){v.stop(!0).slideToggle("fast"),F=!F,b.html(F?"&#9650;":"&#9660").prop("title",i.unescape(F?I.hide:I.display)),w.toggleClass("invisible",!F||M),y.toggleClass("invisible",!F||A)}),y.on("click",function(){K(),Q("next")}),w.on("click",function(){K(),Q("prev")}),X=!0,void $(window).resize(function(){W>0&&(O&&(x.stop(!0,!0),O=!1),Z(),ee()||Q(R,!0))})}return t.message?void m.html('<p class="text-center"><strong>'+t.message+"</strong></p>"):void te()},"json").fail(te),g},ne=function(e,t,i,n){$.post(V(e,t),function(e){return e.result?(i(e),void n()):(n(),e.message?void J(t,e.message,!0):(J(t,I.failed_loading_vids,!0),void Q(R,!0)))},"json").fail(function(){n(),J(t,I.failed_loading_vids,!0)})},se=function(){if(!z&&!L)return z=!0,ne(N,"after",function(e){var t=$(n.replaceThumbcast(e.html));m.append(t),r(t,!0),e.end_reached&&(L=!0),W+=e.videos.length,N=e.videos[e.videos.length-1],Q(R,!0)},function(){z=!1})},oe=function(){if(!Y&&!P)return Y=!0,ne(S,"before",function(e){var t=function(){var t=$(n.replaceThumbcast(e.html));m.prepend(t),r(t,!0),e.start_reached&&(P=!0),W+=e.videos.length,x.css("margin-left",""),x=m.children().first(),S=e.videos[0],R+=e.videos.length,U=!1,Q(R,!0)};O?U=t:t()},function(){Y=!1})};return ie}}),define("text!skins/default/video/sponsor_link.html",[],function(){return'<div id="video-sponsor-links"><a class="mobile-show" id="show-channel-desc">+</a>{{{ more_at }}} <a href="{{{sponsor.u}}}" target="_blank"><strong>{{{sponsor.n}}}</strong></a> <span class="channel-desc">- {{{sponsor.d}}}</span></div>\n'}),define("text!skins/default/video/report.html",[],function(){return'<div class="tab-form">\n\t<form id="video-report-form" class="form-horizontal">\n\t\t<div class="row">\n\t\t\t<div class="col-sm-6">\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<label class="col-xs-2 control-label">{{{ labels.reason }}}</label>\n\t\t\t\t\t<div class="col-xs-10 text-center">\n\t\t\t\t\t\t{{# reasons }}\n\t\t\t\t\t\t<div class="radio-inline"><label><input type="radio" name="reason" value="{{ value }}"{{# checked }} checked{{/ checked }}> {{ label }}</label></div>\n\t\t\t\t\t\t{{/ reasons }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<label class="col-xs-2 control-label" for="video-report-form-email">{{{ labels.email }}}</label>\n\t\t\t\t\t<div class="col-xs-10">\n\t\t\t\t\t\t<input type="email" name="email" id="video-report-form-email" class="form-control" required placeholder="{{{ labels.leave_email }}}" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="col-sm-6">\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<div class="col-sm-12">\n\t\t\t\t\t\t<textarea class="form-control" name="message" rows="3" required placeholder="{{{ labels.give_details }}}"></textarea>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="form-group">\n\t\t\t<div class="col-xs-12">\n\t\t\t\t<button type="button" class="submit btn btn-default pull-right">{{{ labels.report }}}</button>\n\t\t\t\t<a href="http://info.xvideos.com/content/" target="_blank" class="btn btn-default btn-sm light-label wrap">{{{ labels.content_owners }}}</a>\n\t\t\t</div>\n\t\t</div>\n\t</form>\n</div>'}),define("skins/default/video/related_keywords",[],function(){var e="related_keywords",t=function(){};return t.prototype={storageAvailable:function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(i){return!1}},arsort:function(e){var t,i,n,s=[],o=0,r=[],a="undefined"!=typeof window?window:global;a.$locutus=a.$locutus||{};var l=a.$locutus;l.php=l.php||{},
l.php.locales=l.php.locales||{},n=function(e,t){return t-e};for(t in e)e.hasOwnProperty(t)&&s.push([t,e[t]]);for(s.sort(function(e,t){return n(e[1],t[1])}),i=0,o=s.length;i<o;i++)r.push(s[i][0]);return r},declareVideoView:function(t,i){if(!this.storageAvailable())return void console.log("Error, storage not available");if(!i)return void console.log("No video keywords");var n={};n.videos=[],n.keywords={};var s=localStorage.getItem(e);if(s){var o=JSON.parse(s);o&&o.videos&&o.keywords&&(n=o)}for(var r in n.videos)if(n.videos[r]===t)return void console.log("Video "+t+" already registered");n.videos.length>50&&n.videos.shift(),n.videos.push(t),localStorage.setItem(e,JSON.stringify(n)),console.log("Video "+t+" processed")},getHistory:function(){var t=localStorage.getItem(e);if(!t)return[];var i=JSON.parse(t);if(!i||!i.keywords)return[];var n=this.arsort(i.keywords),s={};return s.keywords=n.slice(0,15),s.videos=i.videos,s},resetRelated:function(){localStorage.removeItem(e)}},new t}),define("skins/common/video/tracking",["config/main"],function(e){var t=function(){if(this.allow_tracking=!1,this.declare_sent=!1,this.last_view=!1,this.storageAvailable()&&e.dyn.ref&&e.dyn.id){var t="last_view",i=localStorage.getItem(t);if(i){var n=JSON.parse(i);n&&n.id&&n.ref&&n.id!=e.dyn.id&&(this.last_view=n,this.allow_tracking=!0)}var s={};s.id=e.dyn.id,s.ref=e.dyn.ref,localStorage.setItem(t,JSON.stringify(s))}};return t.prototype={storageAvailable:function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(i){return!1}},declareLink:function(){if(console.log("Try to declare link"),!this.declare_sent&&this.last_view&&this.allow_tracking){this.declare_sent=!0;var t={};t.gentime=e.dyn.gentime,t.source_id=this.last_view.id,t.source_ref=this.last_view.ref,t.current_id=e.dyn.id,t.current_ref=e.dyn.ref,$.post("/video-hit",t)}}},new t}),define("skins/common/video/related",["config/main","lib/helpers/dom","lib/helpers/thumbs_rotator"],function(e,t,i){var n,s=$("#related-videos"),o=s.children(".show-more"),r=!1,a=s.children(".mozaique"),l=a.children(".thumb-block"),d=!1;0===o.length&&(o=s.children(".row").find(".show-more"));var c=function(e){var s=e===!0;if(s||d){d=!1,n=null;var o=!1,a=!1,c=$();if(!r){var h=t.getViewportWidth();o=h<=480?"after-8":h<=768?"after-9":h<=992?"after-8":"after-10"}l=l.filter(function(){var e=$(this),t=e.find(".thumb a"),i=t.data("src");if(!i)return!1;if(a)return!0;if(o&&e.hasClass(o))return a=!0,!0;var n=t.data("vid");return t.append('<img src="'+i+'" id="pic_'+n+'" style="display:none;" onload="this.style.display=\'\';" />'),c=c.add(e),!1}),c.length>0&&i(c,!0)}};c(!0),o.on("click",function(e){e.preventDefault(),o.off("click"),r=!0,c(!0),s.addClass("expanded")}),$(window).on("resize",function(){d=!0,n||(n=setTimeout(c,500))}),$(document).ready(function(){c(!0)})}),define("skins/default/video/subscribe",["config/main","static/utils","lib/helpers/inline_loader","lib/helpers/popup","skins/default/features_test/video_subs","lib/i18n!front"],function(e,t,i,n,s,o){var r=$("#video-subscribe");if(0!==r.length){var a,l=!0,d=null,c=function(h){if(h.result){var u,f,p,g=r.children(".label");if(!h.is_logged)return r.show(),s.isTracking()?(r.off("click"),s.hasSubscribed(e.data.uploader_id)?(g.html(o.__("subscriptions.unsubscribe")),void r.on("click",function(t){t.preventDefault(),s.unsubscribe(e.data.uploader_id),g.html(o.__("subscriptions.unsubscribed")),r.off("click"),$.post("/profiles/"+e.data.uploader+"/followers/unsubscribe")})):void r.on("click",function(t){t.preventDefault(),s.subscribe(e.data.uploader_id),g.html(o.__("subscriptions.subscribed")+' <a href="/my-subs/videos">'+o.__("subscriptions.view_activities")+"</a>"),r.off("click"),$.post("/profiles/"+e.data.uploader+"/followers/subscribe")})):void(e.data.login_info.profile?r.prop("href",e.domains.master+"/account/?redirect="+encodeURIComponent(window.location.href)):r.prop("href",e.domains.master+"/account/create_profile"));if(!h.is_owner){var _=h.csrf||"";h.is_follower?(g.html(o.__("subscriptions.unsubscribe")),u="/profiles/"+e.data.uploader+"/followers/unsubscribe",f=o.__("subscriptions.confirm_subscribed"),p=o.__("subscriptions.unsubscribed")):(u="/profiles/"+e.data.uploader+"/followers/subscribe",p=o.__("subscriptions.subscribed")+' <a href="/my-subs/videos">'+o.__("subscriptions.view_activities")+"</a>"),r.show().off("click").on("click",function(){f&&!window.confirm(t.unescape(f))||(a&&a.close(),g.html(i.getSafe("after",o.__("loading.loading")).getHtml()),$.post(u,{csrf:_},function(t){if(t.result)g.html(p),r.off("click");else if(9===t.code){if(l)return l=!1,d=h.is_follower,void $.post("/profiles/"+e.data.uploader+"/followers/check",c,"json");g.html(o.__("misc.reload_the_page")),a?a.setContent("<strong>"+t.message+"</strong>"):a=new n(r,"<strong>"+t.message+"</strong>",{position:{v:"below",h:"left"},trigger:!1,autoclose:!1,closebtn:!0,popup_class:"video-subscribe-popup"}),a.open()}else g.html(t.message||o.__("misc.error"))}).fail(function(){g.html(o.__("misc.error"))}))}),null!==d&&(d===h.is_follower?r.click():(g.html(p),r.off("click")))}}};return e.data.login_info.is_logged&&e.data.login_info.profile?void $.post("/profiles/"+e.data.uploader+"/followers/check",c,"json"):void c({result:!0,is_logged:!1})}}),define("skins/common/video/report",["config/main","mustache","lib/helpers/inline_loader","lib/helpers/overlay/box","lib/i18n!front"],function(e,t,i,n,s){var o=function(o){this.messages=s.__("report_form.*");var r=[{value:"nevermind",label:this.messages.nevermind,checked:!0},{value:"spam",label:this.messages.spam,checked:!1},{value:"notporn",label:this.messages.not_porn,checked:!1},{value:"underage",label:this.messages.underage,checked:!1},{value:"other",label:this.messages.other,checked:!1}];this.node=$(t.render(o,{reasons:r,labels:this.messages}));var a,l=this,d=this.node.children("form"),c=function(e){if(e.validation_error)n.get(l.getNode(),!0).setContent('<strong class="text-danger">'+e.message+"</strong>").show();else{var t=e.result?"text-success":"text-danger";l.getNode().replaceWith('<p class="text-center"><strong class="'+t+'">'+e.message+"</strong></p>")}},h=function(){a||(a=n.get(l.getNode(),!1,"hide").setContent(i.get("after",l.messages.sending).getHtml())),a.show();var t=d.serializeArray();for(var s in t)if("reason"===t[s].name){if("nevermind"===t[s].value)return void c({result:!0,message:l.messages.thanks});break}$.post(window.location.protocol+"//"+e.data.report_domain+"/video-report/"+e.data.id_video+"/0",t,c,"json").fail(function(){n.get(l.getNode(),!0).setContent('<strong class="text-danger">'+l.messages.sending_failed+"</strong>").show()}).always(function(){a.hide()})};this.node.find("button").on("click",h)};return o.prototype={getNode:function(){return this.node}},o}),define("skins/default/video",["config/main","./search/autocomplete"],function(e){null!==e.data.id_video&&require(["mustache","static/utils","lib/tab","skins/default/video/comments","skins/default/video/download","skins/default/video/favorites","skins/common/video/vote","skins/common/video/playlist","skins/default/features_test/videos_i_like","text!skins/default/video/sponsor_link.html","text!skins/default/video/share.html","text!skins/default/video/report.html","lib/i18n!front","skins/default/video/related_keywords","skins/common/video/tracking","skins/common/video/related","skins/default/video/subscribe","lib/helpers/thumbs_rotator"],function(t,i,n,s,o,r,a,l,d,c,h,u,f,p){if(e.data.sponsors&&e.data.sponsors.length>0&&!e.data.hide_sponsors){var g=Math.random()*e.data.sponsors.length,_=e.data.sponsors[Math.floor(g)];$(t.render(c,{more_at:f.__("video.sponsors.more_at"),sponsor:_})).insertBefore($("#main > h2").first()),$("#show-channel-desc").on("click",function(e){e.preventDefault(),$(this).parent().addClass("expanded")})}var v=$("#show-all-tags"),m=v.next().children("a:last-child");m.length>0&&m.position().left+m.outerWidth(!0)>=v.position().left-10?v.on("click",function(e){e.preventDefault(),$(this).parent().addClass("expanded")}):v.remove(),a(function(t){return e.data.login_info.is_logged||d.isTracking()?f.__("video.votes.thanks_link",{"%start_link%":'<a href="/videos-i-like">',"%end_link%":"</a>"}):f.__("video.votes.thanks")},function(t){t?d.voteGood(e.data.id_video):d.voteBad(e.data.id_video)}),"function"==typeof l&&l().insertAfter("#video-tabs");var b={};b.tabComments=s,b.tabDownload=o,b.tabFavs=r;var y=!1;b.tabShare=function(){y||(y=!0,$("#tabShare").append(h),window.addthis_config=window.addthis_config||{},window.addthis_config.pubid="xa-501f7bd44d12cd79",i.loadScript("//s7.addthis.com/js/250/addthis_widget.js#async=1",{async:"async"},{load:function(){window.addthis.init()}}))};var w=!1;b.tabReport=function(){require(["skins/common/video/report"],function(e){w||(w=!0,$("#tabReport").append(new e(u).getNode()))})},new n("#video-tabs",b,!0),p.declareVideoView(e.data.id_video,e.data.related_keywords)})}),define("skins/form/validator/base",["static/utils"],function(e){var t={},i=function(e,t){"object"==typeof t&&(this.parent=e,this.options=t.options,this.messages=t.messages)};return i.prototype={errorChanged:null,refresh:null,focus:null,getRegexp:function(e){if(t[e])return t[e];if("/"!==e.substr(0,1))return t[e]=new RegExp(e,"g"),t[e];var i=e.lastIndexOf("/");if(i<=0)return t[e]=new RegExp(e,"g"),t[e];var n=e.substr(i+1).toLowerCase().replace(/[^gimuy]/g,"");return 0===n.length&&(n="g"),t[e]=new RegExp(e.substring(1,i),n),t[e]},getMessage:function(t,i,n){var s=i;if(this.messages[t]&&(s=e.unescape(this.messages[t])),n)for(var o in n)n.hasOwnProperty(o)&&(s=s.replace(o,n[o]));return s},strimwidth:function(t,i){return"string"!=typeof t&&(t=t.toString()),t.length+3>i?e.escape(t.substr(0,i-3))+"...":e.escape(t)}},i}),define("skins/form/validator/agreement",["lib/tools","./base","lib/helpers/popup"],function(e,t,i){var n=[],s=function(e,i){t.apply(this,[e,i]),this.id=i.elt_id,this.checkbox=$("#"+this.id),this.checkbox_err,this.popup,this.popup_timer;var n=this;this.checkbox.on("change click",function(){n.validate()}),this.validate()};s.prototype=new t,s.prototype.refresh=function(){this.positionError()},s.prototype.focus=function(){e.scrollTo(this.checkbox,100),this.showError()},s.prototype.isValid=function(){return this.checkbox.is(":checked")},s.prototype.validate=function(){return this.checkbox.is(":checked")?(this.hideError(),void(this.errorChanged&&this.errorChanged(!1,this))):(this.showError(),void(this.errorChanged&&this.errorChanged(!0,this)))},s.prototype.showTooltip=function(e){this.popup?e&&this.popup.setContent(e):this.popup=new i(this.checkbox_err,e,{relative_to:this.checkbox.parent(),trigger:!1,autoclose:!1,popup_class:"form-popup-error",position:{v:"below",h:"left"},offset:{below:0,above:0,left:-3,right:0}}),this.popup.open(),this.startTimer(!0)},s.prototype.showError=function(){this.checkbox_err?this.checkbox_err.show():(this.checkbox.parent().css("position","relative"),this.checkbox_err=$('<div class="checkbox-error-box"></div>').insertAfter(this.checkbox),n.push(this)),this.positionError(),this.showTooltip("<span>"+this.getMessage("invalid","Required")+"</span>")},s.prototype.hideError=function(){this.checkbox_err&&this.checkbox_err.hide(),this.popup&&this.popup.close()},s.prototype.positionError=function(){if(this.checkbox_err){var e=this.checkbox.position();this.checkbox_err.css({width:this.checkbox.outerWidth(),height:this.checkbox.outerHeight(),top:e.top+"px",left:e.left+"px"})}},s.prototype.startTimer=function(e){if(this.popup_timer){if(!e)return;window.clearTimeout(this.popup_timer)}var t=this;this.popup_timer=window.setTimeout(function(){t.popup.close()},3e3)},s.prototype.stopTimer=function(){this.popup_timer&&(window.clearTimeout(this.popup_timer),this.popup_timer=null)};var o,r=function(){o&&(o=null);for(var e in n)n[e].positionError()};return $(window).on("resize",function(){o||(o=window.setTimeout(r,250))}),s}),define("skins/form/validator/compare",["static/utils","./base"],function(e,t){var i=function(i,n){t.apply(this,[i,n]);var s=i.getRoot();if(this.linput=$("#"+s.form.prop("id")+"_"+n.options.left_field.replace(/\|/g,"_")),this.validator=this.linput.data("validator"),this.validator){this.rinput=$("#"+s.form.prop("id")+"_"+n.options.right_field.replace(/\|/g,"_")),this.validation_timer;var o=this,r=this.validator.doValidate;this.validator.doValidate=function(t){if(!r.apply(this,[t]))return!1;var i=$.trim(o.rinput.val());return i.length<2||("=="!==o.options.operator||t===i||(this.setError(o.getMessage("equal","%left_field% and %right_field% must match",{"%left_field%":'"'+e.escape(n.options.left_field.replace(/\|/g," "))+'"',"%right_field%":'"'+e.escape(n.options.right_field.replace(/\|/g," "))+'"'})),!1))},this.rinput.on("focus",function(){o.validator.focused=!0,o.validator.showError()}),this.rinput.on("blur",function(){o.validation_timer&&(window.clearTimeout(o.validation_timer),o.validation_timer=null),o.validator.validate(),o.validator.focused=!1,o.validator.startTimer(!0)}),this.rinput.on("keyup",function(){o.validator.hideError(!0),o.validation_timer&&window.clearTimeout(o.validation_timer),o.validation_timer=window.setTimeout(function(){o.validator.validate()},1e3)})}};return i.prototype=new t,i.prototype.isValid=function(){return!0},i.prototype.focus=function(){this.validator.focus&&this.validator.focus()},i}),define("skins/form/validator/xhr",[],function(){var e=function(e,t,i,n){this.cache={},this.url=e,this.param=t,this.min_chars=i||3,this.intervall=n||1e3,this.last_check=0,this.last_checked,this.timer,this.xhr};return e.prototype={checkStart:null,checkEnd:null,checkError:null,check:function(e){if(e.length<this.min_chars)return void this.checkEnd(!0);if("undefined"!=typeof this.cache[e])return void this.checkEnd(this.cache[e]);if(this.last_checked!==e){this.checkStart();var t=(new Date).getTime(),i=this;if(t-this.last_check<=this.intervall){if(this.timer)return;return void(this.timer=window.setTimeout(function(){i.timer=null,i.check(i.last_checked)},this.intervall-(t-this.last_check)))}this.last_checked=e,this.last_check=t,this.xhr&&this.xhr.abort();var n={};n[this.param]=e,this.xhr=$.getJSON(this.url,n,function(t){t.result?i.cache[e]=!0:i.cache[e]=t.message,i.checkEnd(i.cache[e])}).fail(function(){i.checkError()})}}},e}),define("skins/form/validator/input_base",["lib/tools","static/utils","lib/converter","lib/helpers/popup","./base","./xhr"],function(e,t,i,n,s,o){var r={},a=[],l=function(e,t){if("object"==typeof t){s.apply(this,[e,t]),this.id=t.elt_id,this.input=this.getInput(),this.type=t.elt_type,this.input_type=t.input_type,this.focused=this.input.is(":focus"),this.has_error=!1,this.icon,this.popup,this.popup_timer;var i=this;this.input.on("focus",function(){i.focused=!0,i.showError()}),this.input.on("blur",function(){i.focused=!1,i.startTimer(!0)}),this.input.data("validator",this)}};l.prototype=new s,l.prototype.doValidate=null,l.prototype.validate=function(){return!(this.doValidate&&!this.doValidate(this.getValue()))&&(this.setSuccess(),!0)},l.prototype.refresh=function(){this.positionIcon()},l.prototype.focus=function(){e.scrollTo(this.input,100),this.showError()},l.prototype.isValid=function(){return!(this.has_error||this.options.required&&this.isEmpty())},l.prototype.getInput=function(){return $("#"+this.id)},l.prototype.getValue=function(){return $.trim(this.input.val())},l.prototype.isEmpty=function(){return 0===this.getValue().length},l.prototype.showIcon=function(e,t){this.icon?this.icon.removeClass().show():(this.icon=$("<i></i>").css("position","absolute").insertAfter(this.input),this.icon.parent().css("position","relative"),a.push(this)),this.icon.addClass("fa fa-"+e+" text-"+t),this.positionIcon();var i=this;this.icon.on("mouseover",function(){i.showError()})},l.prototype.hidewIcon=function(e,t){this.icon&&this.icon.hide()},l.prototype.positionIcon=function(){if(this.icon){var e=this.icon.outerHeight(),t=this.input.position(),n=this.input.outerHeight();this.icon.css({top:Math.round(t.top+n-e-2)+"px",left:Math.round(t.left+this.input.innerWidth()-this.icon.outerWidth()-2-i.trimPx(this.input.css("borderLeftWidth")))+"px"})}},l.prototype.showTooltip=function(e){this.popup?(this.popup.open(),e&&this.popup.setContent(e)):(this.popup=new n(this.icon,e,{relative_to:this.input.parent(),trigger:!1,autoclose:!1,popup_class:"form-popup-error",offset:{below:0,above:0,left:0,right:-4}}),this.input.is(":focus")&&this.popup.open()),this.startTimer(!0)},l.prototype.setLoading=function(){this.has_error=!1,this.errorChanged&&this.errorChanged(!1,this),this.showIcon("spinner fa-pulse","primary")},l.prototype.setSuccess=function(){this.has_error=!1,this.errorChanged&&this.errorChanged(!1,this),this.hidewIcon(),this.popup&&this.popup.close()},l.prototype.setError=function(e){this.has_error=!0,this.errorChanged&&this.errorChanged(!0,this),this.showIcon("times","danger"),this.showTooltip("<span>"+e+"</span>")},l.prototype.showError=function(){return!!this.has_error&&void this.showTooltip()},l.prototype.hideError=function(e){return!!(e||this.has_error&&!this.focused)&&void(this.popup&&this.popup.close())},l.prototype.startTimer=function(e){if(this.popup_timer){if(!e)return;window.clearTimeout(this.popup_timer)}var t=this;this.popup_timer=window.setTimeout(function(){t.hideError()},3e3)},l.prototype.stopTimer=function(){this.popup_timer&&(window.clearTimeout(this.popup_timer),this.popup_timer=null)},l.prototype.setupXhr=function(e,t,i,n,s){var a=this;r[e]=new o(t,i,n,s),r[e].checkStart=function(){a.setLoading()},r[e].checkError=function(){a.setSuccess()},r[e].checkEnd=function(e){e===!0?a.setSuccess():a.setError(e)}},l.prototype.checkXhr=function(e,t){r[e].check(t)};var d,c=function(){d&&(d=null);for(var e in a)a[e].positionIcon()};return $(window).on("resize",function(){d||(d=window.setTimeout(c,250))}),l}),define("skins/form/validator/date",["./input_base"],function(e){var t=function(t,i){if("object"==typeof i){e.apply(this,[t,i]);var n=this;this.input.on("blur keyup",function(){n.validate()}),this.getValue().length>0&&this.validate()}};return t.prototype=new e,t.prototype.getInput=function(){return $("#"+this.id+" input[type=text]")},t.prototype.doValidate=function(e){return!this.options.required||0!==e.length||(this.setError(this.getMessage("required","Required")),!1)},t}),define("skins/form/validator/integer",["./input_base"],function(e){var t=function(t,i){if("object"==typeof i){e.apply(this,[t,i]);var n=this;this.input.on("blur keyup input",function(){n.validate()}),this.validate()}};return t.prototype=new e,t.prototype.doValidate=function(e){return 0===e.length?!this.options.required||(this.setError(this.getMessage("required","Required")),!1):e.match(/^\d+$/g)?(e=parseInt(e),null!==this.options.min&&e<this.options.min?(this.setError(this.getMessage("min","Must be greater than %min%",{"%value%":e.toString(),"%min%":this.options.min})),!1):!(this.options.max>0&&e>this.options.max)||(this.setError(this.getMessage("max","Must be less than %max%",{"%value%":e.toString(),"%max%":this.options.max})),!1)):(this.setError(this.getMessage("invalid","Invalid",{"%value%":this.strimwidth(e,20)})),!1)},t}),define("skins/form/validator/string",["./input_base"],function(e){var t=function(t,i){if("object"==typeof i){e.apply(this,[t,i]);var n=this;this.input.on("blur keyup input",function(){n.validate()}),this.validate()}};return t.prototype=new e,t.prototype.doValidate=function(e){return this.options.required&&0===e.length?(this.setError(this.getMessage("required","Required")),!1):this.options.min_length>0&&e.length<this.options.min_length?(this.setError(this.getMessage("min_length","Too short (%nb_chars% min)",{"%value%":'"'+this.strimwidth(e,20)+'"',"%nb_chars%":this.options.min_length})),!1):!(this.options.max_length>0&&e.length>this.options.max_length)||(this.setError(this.getMessage("max_length","Too long (%nb_chars% max)",{"%value%":'"'+this.strimwidth(e,20)+'"',"%nb_chars%":this.options.max_length})),!1)},t}),define("skins/form/validator/password",["./string"],function(e){var t=function(e,t){if(0===e.length)return 0;for(var i=e.split(""),n={Excess:0,Lower:0,Upper:0,Numbers:0,Symbols:0},s={Excess:4,Lower:2,Upper:4,Numbers:5,Symbols:10,Combo:0,FlatLower:0,FlatNumber:0},o=0;o<i.length;o++)i[o].match(/[A-Z]/g)?n.Upper++:i[o].match(/[a-z]/g)?n.Lower++:i[o].match(/[0-9]/g)?n.Numbers++:i[o].match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,.\/]/)&&n.Symbols++;return n.Excess=i.length-t,n.Lower&&n.Upper&&n.Numbers&&n.Symbols?s.Combo=25:(n.Upper&&n.Numbers||n.Upper&&n.Symbols||n.Numbers&&n.Symbols)&&(s.Combo=15),e.match(/^[\sa-z]+$/)&&(s.FlatLower=-15),e.match(/^[\s0-9]+$/)&&(s.FlatNumber=-35),n.Excess*s.Excess+n.Lower*s.Lower+n.Upper*s.Upper+n.Numbers*s.Numbers+n.Symbols*s.Symbols+s.Combo+s.FlatLower+s.FlatNumber},i=function(t,i){if(i.options.check_strength){var n=$('<div class="progress progress-pwd-check"><div class="progress-bar progress-bar-danger" style="width:15%"></div></div>');this.progress=n.children()}e.apply(this,[t,i]),i.options.check_strength&&n.insertAfter(this.input.addClass("input-pwd-check"))};return i.prototype=new e,i.prototype.doValidate=function(i){if(this.options.check_strength){var n=t(i,this.options.min_length);this.progress.width(Math.max(0,Math.min(100,n))+"%").removeClass().addClass("progress-bar"),n>=90?this.progress.addClass("progress-bar-success"):n<25?this.progress.addClass("progress-bar-danger"):n<50?this.progress.addClass("progress-bar-warning"):n<75&&this.progress.addClass("progress-bar-info")}return e.prototype.doValidate.apply(this,[i])},i}),define("skins/form/validator/profile_name",["config/main","static/utils","./string"],function(e,t,i){var n=function(t,n){this.setupXhr("profile_name",e.domains.master+"/account/checkprofilename","profile"),i.apply(this,[parent,n])};return n.prototype=new i,n.prototype.doValidate=function(e){return!!i.prototype.doValidate.apply(this,[e])&&(e.match(this.getRegexp(this.options.regex))?(this.checkXhr("profile_name",e),!1):(this.setError(this.getMessage("name_invalid","Invalid profile name",{"%name%":t.escape(e)})),!1))},n}),define("skins/form/validator/email",["static/utils","./string"],function(e,t){var i=function(e,i){t.apply(this,[e,i])};return i.prototype=new t,i.prototype.doValidate=function(i){return!!t.prototype.doValidate.apply(this,[i])&&(!!i.match(this.getRegexp(this.options.regex))||(this.setError(this.getMessage("invalid","Invalid email address",{"%email%":e.escape(i)})),!1))},i}),define("skins/form/validator/user_email",["config/main","static/utils","./email"],function(e,t,i){var n=function(t,n){this.setupXhr("user_email",e.domains.master+"/account/checkemail","email"),i.apply(this,[parent,n])};return n.prototype=new i,n.prototype.doValidate=function(e){return!!i.prototype.doValidate.apply(this,[e])&&(this.checkXhr("user_email",e),!1)},n});